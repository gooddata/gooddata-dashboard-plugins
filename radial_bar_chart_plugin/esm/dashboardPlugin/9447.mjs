(self.webpackChunkradial_bar_chart_plugin=self.webpackChunkradial_bar_chart_plugin||[]).push([[9447],{69447:(e,t,i)=>{i.r(t),i.d(t,{CorePivotTable:()=>mo,PivotTable:()=>Co,getPivotTableDimensions:()=>Do,isAbsoluteColumnWidth:()=>E,isAllMeasureColumnWidthItem:()=>L,isAttributeColumnLocator:()=>k,isAttributeColumnWidthItem:()=>z,isMeasureColumnLocator:()=>S,isMeasureColumnWidthItem:()=>G,isMixedValuesColumnWidthItem:()=>F,isSliceMeasureColumnWidthItem:()=>W,isTotalColumnLocator:()=>H,isWeakMeasureColumnWidthItem:()=>P,newAttributeColumnLocator:()=>_,newTotalColumnLocator:()=>O,newWidthForAllColumnsForMeasure:()=>U,newWidthForAllMeasureColumns:()=>Z,newWidthForAttributeColumn:()=>B,newWidthForSelectedColumns:()=>j,pivotTableMenuForCapabilities:()=>bo,setNewWidthForSelectedColumns:()=>V});var o=i(55348),n=i(8297),s=i(47591),r=i(53244),a=i(2525),l=i(86122),u=i(51256),d=i(50975),c=i(94184),h=i(68652),m=i(50576),g=i(14572),p=i(65846),f=i(25972);function C({error:e,errorMap:t,ErrorComponent:i}){if(!i)return null;const n=t[Object.prototype.hasOwnProperty.call(t,e)?e:a.ErrorCodes.UNKNOWN_ERROR];return(0,o.jsx)(i,{code:e,...n})}function b({LoadingComponent:e,theme:t}){const i=t?.table?.loadingIconColor??t?.palette?.complementary?.c6??void 0;return(0,o.jsx)("div",{className:"s-loading gd-table-loading",children:e?(0,o.jsx)(e,{color:i}):null})}const D={locale:"en-US",drillableItems:[],afterRender:()=>{},pushData:()=>{},onExportReady:()=>{},onLoadingChanged:()=>{},onError:()=>{},onDataView:()=>{},onDrill:()=>!0,ErrorComponent:a.ErrorComponent,LoadingComponent:a.LoadingComponent,pageSize:100,config:{},onColumnResized:()=>{}};var w=i(8856),v=i(79697),T=i(47855),x=i(50439),I=i(24930),R=Math.ceil,y=Math.max;var A,M;function S(e){return!(0,v.Z)(e)&&void 0!==e.measureLocatorItem}function k(e){return!(0,v.Z)(e)&&void 0!==e.attributeLocatorItem}function H(e){return!(0,v.Z)(e)&&void 0!==e.totalLocatorItem}function E(e){return Number(e.value)===e.value}function z(e){return!(0,v.Z)(e)&&void 0!==e.attributeColumnWidthItem}function G(e){return!(0,v.Z)(e)&&void 0!==e.measureColumnWidthItem?.locators}function W(e){return!(0,v.Z)(e)&&void 0!==e.sliceMeasureColumnWidthItem?.locators}function F(e){return!(0,v.Z)(e)&&void 0!==e.mixedValuesColumnWidthItem?.locators}function L(e){return!(0,v.Z)(e)&&void 0!==e.measureColumnWidthItem&&void 0===e.measureColumnWidthItem.locators&&void 0===e.measureColumnWidthItem.locator}function P(e){return!(0,v.Z)(e)&&void 0!==e.measureColumnWidthItem?.locator}function N(e){return{measureLocatorItem:{measureIdentifier:(0,r.measureLocalId)(e)}}}function O(e,t){return{totalLocatorItem:{attributeIdentifier:(0,r.attributeLocalId)(e),totalFunction:t}}}function B(e,t,i){const o=void 0===i?{}:{allowGrowToFit:i};return{attributeColumnWidthItem:{attributeIdentifier:(0,r.attributeLocalId)(e),width:{value:t,...o}}}}function Z(e,t){return{measureColumnWidthItem:{width:{value:e,...void 0===t?{}:{allowGrowToFit:t}}}}}function U(e,t,i){return{measureColumnWidthItem:{width:{value:t,...void 0===i?{}:{allowGrowToFit:i}},locator:N(e)}}}function j(e,t,i,o){return V(e,t,i,o)}function V(e,t,i,o){let n=[];return Array.isArray(e)?n=e.map(N):e&&n.push(N(e)),{measureColumnWidthItem:{width:{value:i,...void 0!==o&&"auto"!==i?{allowGrowToFit:o}:{}},locators:[...t,...n]}}}function _(e,t){return{attributeLocatorItem:{attributeIdentifier:(0,r.attributeLocalId)(e),element:t}}}!function(e){e.AUTOSIZE_COLUMNS="autosizeColumns",e.FIT_GROW="growToFit",e.UI_RESIZED="uiColumnResized"}(A||(A={})),function(e){e[e.CLICK=1]="CLICK",e[e.DOUBLE_CLICK=2]="DOUBLE_CLICK"}(M||(M={}));const $="ROW_ATTRIBUTE_COLUMN",K="COLUMN_ATTRIBUTE_COLUMN",q="MEASURE_COLUMN",X="ROW_MEASURE_COLUMN",J="MIXED_HEADERS_COLUMN",Q="MIXED_VALUES_COLUMN",Y="rowTotal",ee="rowSubtotal",te="COLUMN_TOTAL",ie="COLUMN_SUBTOTAL",oe=" â€º ",ne=["sum","max","min","avg","med","nat"],se=1e3,re="s-value",ae="s-header-cell-label",le='700 12px / 26px gdcustomfont, avenir, "Helvetica Neue", arial, sans-serif',ue='700 12px / 26px gdcustomfont, avenir, "Helvetica Neue", arial, sans-serif',de="root";function ce(e){return"sliceCol"===e?.type}function he(e){return"sliceMeasureCol"===e?.type}function me(e){return"mixedHeadersCol"===e?.type}function ge(e){return"mixedValuesCol"===e?.type}function pe(e){return"seriesCol"==e?.type}function fe(e){return"scopeCol"===e?.type}function Ce(e){return fe(e)&&0===e.children.length}function be(e){return"rootCol"===e?.type}function De(e){return"string"==typeof e?e:(t=e,void 0!==t?.colId?e.colId:function(e){return void 0!==e?.getColDef}(e)?De(e.getColDef()):e.groupId);var t}function we(e,t){return Math.floor(e/t)}function ve(e){return!!e.getColDef}function Te(e){return ve(e)?e.getColDef().type===q:e.type===q}function xe(e){const t=e.getColDef().type;return t===q||t===te||t===ie}function Ie(e){return e.map(De)}function Re(e){return e===Y||e===ee}function ye(e){const{type:t}=e;return t===te}function Ae(e){const{type:t}=e;return t===ie}function Me(e){const t=he(e)||ge(e)?e.seriesDescriptor[0].measureDescriptor.measureHeaderItem.localIdentifier:void 0;return pe(e)?e.seriesDescriptor.measureDescriptor.measureHeaderItem.localIdentifier:t}var Se=i(49578);function ke(e,t){return(0,s.kG)(e&&t),{attributeLocatorItem:{attributeIdentifier:e.attributeHeader.localIdentifier,element:t.attributeHeaderItem.uri}}}function He(e,t){return(0,s.kG)(e&&t),{totalLocatorItem:{attributeIdentifier:e.attributeHeader.localIdentifier,totalFunction:t.totalHeaderItem.name}}}function Ee(e){return{measureLocatorItem:{measureIdentifier:e.measureHeaderItem.localIdentifier}}}function ze(e){if(fe(e)){const t=[],{descriptorsToHere:i,headersToHere:o,measureDescriptors:n}=e,s=(0,Se.Z)(i,o);return s.push([e.attributeDescriptor,e.header]),s.forEach((([e,i])=>(0,r.isResultTotalHeader)(i)?t.push(He(e,i)):t.push(ke(e,i)))),n&&n.forEach((e=>t.push(Ee(e)))),t}{const t=[];return e.seriesDescriptor.attributeDescriptors&&e.seriesDescriptor.attributeHeaders&&(0,Se.Z)(e.seriesDescriptor.attributeDescriptors,e.seriesDescriptor.attributeHeaders).forEach((([e,i])=>{(0,r.isResultTotalHeader)(i)?t.push(He(e,i)):t.push(ke(e,i))})),t.push(Ee(e.seriesDescriptor.measureDescriptor)),t}}function Ge(e){const t=[];return e.seriesDescriptor&&e.seriesDescriptor.filter(((e,t,i)=>i.findIndex((t=>t.measureDescriptor===e.measureDescriptor))===t)).forEach((e=>{t.push(Ee(e.measureDescriptor))})),t}const We=function(e,t){var i;if("function"!=typeof t)throw new TypeError("Expected a function");return e=(0,I.Z)(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=void 0),i}}(2,(function(){const e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",document.body.appendChild(e);const t=e.offsetWidth;e.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",e.appendChild(i);const o=i.offsetWidth;return e.parentNode?.removeChild(e),t-o}));async function Fe(e){return new Promise((t=>{setTimeout(t,e)}))}function Le(e,t,i){const{buckets:o,sortBy:n}=e,s=(0,r.bucketsFind)(o,a.BucketNames.ATTRIBUTE);return s?(0,r.sanitizeBucketTotals)(s,t??n,i??(0,r.bucketTotals)(s)):[]}function Pe(e){const{buckets:t}=e,i=(0,r.bucketsFind)(t,a.BucketNames.COLUMNS);return i?(0,r.bucketTotals)(i):[]}const Ne=e=>e.length>0,Oe=e=>e.length>0,Be=e=>{const t=z(e)||G(e),i=W(e)||F(e);return t||i},Ze=e=>e.data().series().toArray().map((e=>e.descriptor)).filter(((e,t,i)=>i.findIndex((t=>t.measureDescriptor===e.measureDescriptor))===t)),Ue=60,je=2e3,Ve=500,_e=12;function $e(e){return"auto"===e.value}class Ke{tableDescriptor;manuallyResizedColumns;allMeasureColumnWidth;weakMeasuresColumnWidths;constructor(e,t={},i=null,o={}){this.tableDescriptor=e,this.manuallyResizedColumns=t,this.allMeasureColumnWidth=i,this.weakMeasuresColumnWidths=o}getManuallyResizedColumn2=e=>{if(this.manuallyResizedColumns[e.id])return this.convertItem(this.manuallyResizedColumns[e.id]);const t=this.getMatchedWeakMeasuresColumnWidth(e);return t?this.getWeakMeasureColumMapItem(t):pe(e)&&this.isAllMeasureColumWidthUsed()?this.getAllMeasureColumMapItem():void 0};getManuallyResizedColumn=e=>{const t=De(e),i=this.tableDescriptor.getCol(t);return this.getManuallyResizedColumn2(i)};isColumnManuallyResized=e=>!!this.getManuallyResizedColumn(e);addToManuallyResizedColumn=(e,t=!1)=>{this.manuallyResizedColumns[De(e)]={width:{value:e.getActualWidth(),...Je(t)}},e.getColDef().suppressSizeToFit=!t};addAllMeasureColumn=(e,t)=>{this.allMeasureColumnWidth=e,t.forEach((e=>{if(Te(e)){const t=De(e);this.manuallyResizedColumns[t]&&(this.manuallyResizedColumns=(0,n.Z)(this.manuallyResizedColumns,t)),e.getColDef().suppressSizeToFit=!0}})),this.weakMeasuresColumnWidths={}};addWeekMeasureColumn=e=>{const t=e.getActualWidth(),i=Me(this.tableDescriptor.getCol(e));if(i){this.weakMeasuresColumnWidths[i]={measureColumnWidthItem:{width:{value:t},locator:{measureLocatorItem:{measureIdentifier:i}}}};const e=e=>e.measureIdentifier===i;this.manuallyResizedColumns=(0,w.Z)(this.manuallyResizedColumns,e)}};removeAllMeasureColumns=()=>{this.allMeasureColumnWidth=null,this.manuallyResizedColumns=(0,w.Z)(this.manuallyResizedColumns,(e=>$e(e.width))),this.weakMeasuresColumnWidths={}};removeWeakMeasureColumn=e=>{const t=this.tableDescriptor.getCol(De(e)),i=this.getMatchedWeakMeasuresColumnWidth(t);if(i){this.weakMeasuresColumnWidths=(0,n.Z)(this.weakMeasuresColumnWidths,i.measureColumnWidthItem.locator.measureLocatorItem.measureIdentifier);const e=e=>$e(e.width)&&this.isMatchingWeakWidth(e,i)&&!this.isAllMeasureColumWidthUsed();this.manuallyResizedColumns=(0,w.Z)(this.manuallyResizedColumns,e)}};removeFromManuallyResizedColumn=e=>{const t=this.tableDescriptor.getCol(De(e));this.manuallyResizedColumns[t.id]&&(this.manuallyResizedColumns=(0,n.Z)(this.manuallyResizedColumns,t.id),this.isAllMeasureColumWidthUsed()&&Te(e)||(e.getColDef().suppressSizeToFit=!1)),pe(t)&&(this.isAllMeasureColumWidthUsed()||this.getMatchedWeakMeasuresColumnWidth(t))&&(this.manuallyResizedColumns[t.id]=this.getAutoSizeItem(e),e.getColDef().suppressSizeToFit=!1)};getColumnWidthsFromMap=()=>{const e=(t=this.manuallyResizedColumns,i=this.tableDescriptor,Object.keys(t).map((e=>{const{width:o}=t[e],n=function(e,t){if(ce(e)){const i=e.attributeDescriptor.attributeHeader.localIdentifier;if(E(t))return{attributeColumnWidthItem:{width:t,attributeIdentifier:i}};throw new s.ej(`width value for attributeColumnWidthItem has to be number ${e.id}`)}if(fe(e)||pe(e))return{measureColumnWidthItem:{width:t,locators:ze(e)}};if(he(e))return{sliceMeasureColumnWidthItem:{width:t,locators:Ge(e)}};if(ge(e))return{mixedValuesColumnWidthItem:{width:t,locators:Ge(e)}};throw new s.ej(`could not find header matching ${e.id}`)}(i.getCol(e),o);return(0,s.kG)(n,`unable to find size item by filed ${e}`),n})));var t,i;this.isAllMeasureColumWidthUsed()&&e.push(this.getAllMeasureColumnWidth());const o=function(e){return Object.keys(e).map((t=>e[t]))}(this.weakMeasuresColumnWidths);return e.concat(o)};updateColumnWidths=e=>{const t=this.filterAllMeasureColumnWidthItem(e);if(t&&L(t)){const e=qe(t.measureColumnWidthItem.width);this.allMeasureColumnWidth=E(e)?e.value:null}else this.allMeasureColumnWidth=null;this.weakMeasuresColumnWidths=this.filterWeakColumnWidthItems(e);const i=this.filterStrongColumnWidthItems(e),o=function(e,t,i=qe){if(!t)return{};const o={};return t.forEach((t=>{if(z(t)){const[n,r]=function(e,t){const i=e.matchAttributeWidthItem(t);return(0,s.kG)(i,`Could not find column descriptor for width item for attribute "${t.attributeColumnWidthItem.attributeIdentifier}"`),[i.id,t.attributeColumnWidthItem.width]}(e,t);o[n]={width:i(r)}}if(G(t)){const n=function(e,t){const i=e.matchMeasureWidthItem(t);if(i)return[i,t.measureColumnWidthItem.width]}(e,t);if(!n)return;const[s,r]=n;o[s.id]={width:i(r),measureIdentifier:Me(s)}}if(W(t)||F(t)){const n=function(e,t){const i=W(t)?e.matchSliceMeasureWidthItem(t):e.matchMixedValuesWidthItem(t);if(!i)return;return[i,W(t)?t.sliceMeasureColumnWidthItem.width:t.mixedValuesColumnWidthItem.width]}(e,t);if(!n)return;const[s,r]=n;o[s.id]={width:i(r),measureIdentifier:Me(s)}}})),o}(this.tableDescriptor,i);this.manuallyResizedColumns=o};getMatchingColumnsByMeasure=(e,t)=>{const i=Me(this.tableDescriptor.getCol(e));return i?t.filter((e=>{const t=Me(this.tableDescriptor.getCol(e));return i===t})):[]};getMatchedWeakMeasuresColumnWidth=e=>{if(!pe(e))return;const t=e.seriesDescriptor.measureDescriptor.measureHeaderItem.localIdentifier;return t?this.weakMeasuresColumnWidths[t]:void 0};filterAllMeasureColumnWidthItem(e){if(e)return e.filter(L)[0]}filterStrongColumnWidthItems(e){return e?e.filter(Be):[]}filterWeakColumnWidthItems=e=>e?e.filter(P).reduce(((e,t)=>{const i=qe(t.measureColumnWidthItem.width);return E(i)&&(e[t.measureColumnWidthItem.locator.measureLocatorItem.measureIdentifier]={measureColumnWidthItem:{...t.measureColumnWidthItem,width:{...t.measureColumnWidthItem.width,value:i.value}}}),e}),{}):{};convertItem(e){if(E(e.width)){const{width:t}=e;return{width:t.value,...Je(t.allowGrowToFit)}}}getWeakMeasureColumMapItem(e){return{width:e.measureColumnWidthItem.width.value}}isAllMeasureColumWidthUsed=()=>null!==this.allMeasureColumnWidth;getAutoSizeItem=e=>{const t=Me(this.tableDescriptor.getCol(e)),i={width:{value:"auto"}};return t&&(i.measureIdentifier=t),i};getAllMeasureColumMapItem=()=>({width:this.allMeasureColumnWidth});getAllMeasureColumnWidth=()=>({measureColumnWidthItem:{width:{value:this.allMeasureColumnWidth}}});isMatchingWeakWidth(e,t){return e.measureIdentifier===t.measureColumnWidthItem.locator.measureLocatorItem.measureIdentifier}}function qe(e){return E(e)?{...e,value:Math.min(Math.max(e.value,Ue),je)}:e}function Xe(e,t){return Boolean(t&&e[t])}function Je(e){return e?{allowGrowToFit:e}:{}}function Qe(e,t,i,o,n){if(!t)return;e.font=n;const s=i?e.measureText(t).width+_e:e.measureText(t).width;return void 0===o||s>o?s:void 0}const Ye=(e,t)=>{const i=t.tableDescriptor.isTransposed();return pe(e)||i&&fe(e)||ge(e)};function et(e,t,i,o,n,s){const{context:r,gridApi:a}=e,l=e.tableDescriptor.getCol(i),u=i.getColDef();if(l&&r){const d=t[l.id];let c;const h=u.valueFormatter;h&&Ye(l,e)&&"function"==typeof h&&(c=h({data:t,value:d,column:i,colDef:u,api:a,node:null,context:void 0}));const m=c||d,g=l.id?o.get(l.id):void 0;let p;if(e.cache){const t=e.groupingProvider?.isRepeatedValue(l.id,s);t||(p=function(e,t,i,o,n){const s=n?`${n}:${t}`:t,r=o.get(s);let a;return void 0===r?(e.font=n,a=e.measureText(t).width,o.set(s,a)):a=r,void 0===i||a>i?a:void 0}(r,m,g,e.cache,n))}else p=Qe(r,m,!1,g,n);p&&o.set(l.id,p)}}function tt(e,t){const i=e?Math.ceil(e+t):0;return Math.min(Math.max(Ue,i),Ve)}const it=(e,t)=>"viewport"===e.columnAutoresizeOption&&e.clientWidth&&t>e.clientWidth;function ot(e,t,i){const o=e.getElementsByClassName(t)[0];if(!o)return i;const{font:n,fontWeight:s,fontSize:r,fontFamily:a}=window.getComputedStyle(o);return(0,v.Z)(n)?`${s} ${r} ${a}`:n}function nt(e,t){return ye(e)?t.totalColumnFont:Ae(e)?t.subtotalColumnFont:t.headerFont}function st(e,t,i,o){const n=fe(o)||ge(o);return ye(e)||n&&o.isTotal?i.totalColumnFont:Ae(e)||n&&o.isSubtotal?i.subtotalColumnFont:Re(t.type)?i.subtotalFont:i.rowFont}function rt(e,t,i,o,n,s,r,a){const{containerRef:l,columnAutoresizeOption:u,clientWidth:d}=n;if(e&&t&&i&&o&&l){const o=(i.getAllGridColumns()??[]).filter((e=>e.isPrimary())),{headerFont:n,rowFont:c,subtotalFont:h,totalFont:m,subtotalColumnFont:g,totalColumnFont:p}=function(e){return{headerFont:ot(e,ae,'12px / 28px gdcustomfont, avenir, "Helvetica Neue", arial, sans-serif'),rowFont:ot(e,re,'12px / 26px gdcustomfont, avenir, "Helvetica Neue", arial, sans-serif'),subtotalFont:ot(e,"gd-table-row-subtotal",le),totalFont:ot(e,"gd-row-total",ue),subtotalColumnFont:ot(e,"gd-column-subtotal",le),totalColumnFont:ot(e,"gd-column-total",ue)}}(l),f=document.createElement("canvas").getContext("2d"),C=function(e){const t=e.getDisplayedRowCount(),i=[];for(let o=0;o<t;o++){const t=e.getDisplayedRowAtIndex(o)?.data;t&&i.push(t)}return i}(t),b=function(e){const t=e.getPinnedBottomRowCount(),i=[];for(let o=0;o<t;o++){const t=e?.getPinnedBottomRow(o)?.data;t&&i.push(t)}return i}(t),D={};return function(e,t){const{context:i,tableDescriptor:o}=e,n=new Map;if(i){let s=0;for(let r=0;r<e.columns.length;r++){const a=e.columns[r],l=a.getColDef(),u=De(l),d=o.getCol(u),c=u?n.get(u):void 0;if(it(e,s))break;if(e.measureHeaders){const t=nt(l,e),o=Qe(i,l.headerName,!!l.sort,c,t);u&&o&&n.set(u,o)}if(e.rowData.forEach(((t,i)=>{const o=st(l,t,e,d);et(e,t,a,n,o,i)})),e.totalData.forEach(((t,i)=>{et(e,t,a,n,e.totalFont,i)})),"viewport"===e.columnAutoresizeOption){const i=u?n.get(u):void 0,o=t.getManuallyResizedColumn(a);s+=o?o.width:tt(i,e.padding)}}}return function(e,t,i){return e.reduce(((e,o)=>{const n=o.getColDef(),s=De(n);if(s){const o=t.get(s);o&&e.push({...n,width:tt(o,i)})}return e}),[])}(e.columns,n,e.padding)}({tableDescriptor:e,context:f,columns:o,rowData:C,totalData:b,measureHeaders:r.measureHeaders,headerFont:n,subtotalFont:h,totalFont:m,subtotalColumnFont:g,totalColumnFont:p,rowFont:c,padding:r.padding,separators:r.separators,cache:new Map,columnAutoresizeOption:u,clientWidth:d,groupingProvider:a,gridApi:t,columnApi:i},s).forEach((e=>{De(e)&&void 0!==e.width&&(D[De(e)]={width:e.width})})),D}return{}}const at=e=>"viewport"===e||"autoresizeAll"===e,lt=e=>e.config?.columnSizing?.defaultWidth??"unset",ut=e=>{const t=lt(e);return at(t)},dt=e=>!0===e.config?.columnSizing?.growToFit,ct=e=>e.config?.columnSizing?.columnWidths;class ht{context;constructor(e){this.context=e}getColumnTotals=()=>this.context.state.columnTotals;getRowTotals=()=>this.context.state.rowTotals;getExecutionDefinition=()=>this.context.props.execution.definition;getGroupRows=()=>{return e=this.context.props,e.config?.groupRows??!0;var e};getMeasureGroupDimension=()=>{return e=this.context.props,e.config?.measureGroupDimension??"columns";var e};getColumnHeadersPosition=()=>{return e=this.context.props,e.config?.columnHeadersPosition??"top";var e};getMenuConfig=()=>{return e=this.context.props,e.config?.menu??{};var e};getDefaultWidth=()=>200;isColumnAutoresizeEnabled=()=>ut(this.context.props);isGrowToFitEnabled=(e=this.context.props)=>dt(e);getColumnWidths=(e=this.context.props)=>ct(e);hasColumnWidths=()=>{return e=this.context.props,!!ct(e);var e};getDefaultWidthFromProps=e=>lt(e);shouldAutoResizeColumns=()=>(e=>{const t=ut(e),i=dt(e);return t||i})(this.context.props)}class mt{context;constructor(e){this.context=e}onGridReady=e=>{const{internal:t,updateDesiredHeight:i,getGroupRows:o}=this.context;(0,s.kG)(t.table),t.table.finishInitialization(e.api,e.api),i(),o()&&t.table.initializeStickyRow(),t.table.setTooltipFields(),t.table.isEmpty()&&this.context.onFirstDataRendered()};onModelUpdated=e=>{const{internal:t,updateStickyRow:i,getLastSortedColId:o,setLastSortedColId:n}=this.context;if(i(),t.table?.isPivotTableReady()){const t=o();t&&e.api&&(e.api.setFocusedHeader(t),n(null))}};onGridColumnsChanged=()=>{this.context.updateStickyRow()}}class gt{context;constructor(e){this.context=e}onFirstDataRendered=async e=>{const{internal:t}=this.context;(0,s.kG)(t.table),t.firstDataRendered&&console.error("onFirstDataRendered called multiple times"),t.firstDataRendered=!0,t.startWatching(this.context.startWatchingTableRendered,500),this.context.isColumnAutoresizeEnabled()?await this.context.autoresizeColumns():this.context.isGrowToFitEnabled()&&this.context.growToFit(),this.context.updateStickyRow()}}class pt{context;constructor(e){this.context=e}onBodyScroll=e=>{const t={top:Math.max(e.top,0),left:e.left};this.context.updateStickyRowContent(t)};onContainerMouseDown=e=>{const{internal:t}=this.context;t.isMetaOrCtrlKeyPressed=e.metaKey||e.ctrlKey,t.isAltKeyPressed=e.altKey}}class ft{context;constructor(e){this.context=e}onGridSizeChanged=e=>{const{internal:t}=this.context;t.firstDataRendered&&t.table&&(t.table.isResizing()||t.checkAndUpdateLastSize(e.clientWidth,e.clientHeight)&&this.context.autoresizeColumns(!0))};onGridColumnResized=async e=>{const{internal:t,updateDesiredHeight:i,getResizingConfig:o}=this.context;(0,s.kG)(t.table),e.finished&&(i(),function(e){return e?.source===A.UI_RESIZED&&!!e.columns}(e)&&t.table.onManualColumnResize(o(),e.columns))};onPinnedRowDataChanged=async e=>{e?.api.getPinnedBottomRowCount()>0&&await this.context.autoresizeColumns(!0)};getDebounceTimeout(){return 300}}class Ct{context;constructor(e){this.context=e}onSortChanged=e=>{const{internal:t,getExecutionDefinition:i,pushDataGuard:o,setState:n}=this.context;if(!t.table)return void console.warn("changing sorts without prior execution cannot work");const s=t.table.createSortItems(e.api.getAllGridColumns()),r=Le(i(),s);console.debug("onSortChanged",s),o({properties:{sortItems:s,totals:r,bucketType:a.BucketNames.ATTRIBUTE}}),n({columnTotals:r},(()=>{t.table?.refreshData()}))}}var bt=i(8961),Dt=i(94207),wt=i(67326);function vt(e,t){const{type:i,measureIdentifiers:o,attributeIdentifier:n,include:s}=t,r=o.map((e=>({type:i,measureIdentifier:e,attributeIdentifier:n}))),a=s?function(e,t){const i=t.filter((t=>!e.some((e=>(0,m.Z)(e,t)))));return[...e,...i]}(e,r):function(e,t){return e.filter((e=>!t.find((t=>(0,m.Z)(t,e)))))}(e,r);return(0,wt.Z)(a,(e=>ne.findIndex((t=>t===e.type))))}function Tt(e){return e?e.map(r.attributeDescriptorLocalId):[]}const xt={getTotalsForAttributeHeader:function(e,t,i=!1){return ne.reduce(((o,n)=>{const s=function(e,t){const i=e.filter((e=>e.type===t));return(0,Dt.Z)(i.map((e=>e.measureIdentifier)))}(e,n);if(i||(r=s,a=t,(0,bt.Z)(r,a).length===a.length)){const t=function(e,t,i){const o=i.map((i=>{const o=function(e,t,i){return e.filter((e=>e.measureIdentifier===i&&e.type===t))}(e,t,i);return o.map((e=>e.attributeIdentifier))}));return(0,bt.Z)(...o)}(e,n,s);t.length&&o.push({type:n,attributes:t})}var r,a;return o}),[])},getTotalsForMeasureHeader:function(e,t){return e.reduce(((e,i)=>{if(i.measureIdentifier===t){const t=e.find((e=>e.type===i.type));void 0===t?e.push({type:i.type,attributes:[i.attributeIdentifier]}):t.attributes.push(i.attributeIdentifier)}return e}),[])},isTotalEnabledForAttribute:function(e,t,i,o,n){const s=o.some((t=>{const o=t.attributes.some((t=>e.includes(t)));return t.type===i&&o})),r=n.some((e=>{const o=e.attributes.some((e=>t.includes(e)));return e.type===i&&o}));return s||r},isTotalEnabledForSubMenuAttribute:function(e,t,i){return i.some((i=>i.type===t&&i.attributes.includes(e)))},getUpdatedColumnOrRowTotals:vt};class It{context;constructor(e){this.context=e}onMenuAggregationClick=e=>{const{internal:t,getExecutionDefinition:i,getColumnTotals:o,getRowTotals:n,pushDataGuard:s,setState:r}=this.context,l=t.table?.getSortItems(),{isColumn:u}=e;if(u){const n=Le(i(),l,vt(o(),e));s({properties:{totals:n,bucketType:a.BucketNames.ATTRIBUTE}}),r({columnTotals:n},(()=>{t.table?.refreshData()}))}else{const i=vt(n(),e);r({rowTotals:i},(()=>{t.table?.refreshData()})),s({properties:{totals:i,bucketType:a.BucketNames.COLUMNS}})}}}class Rt{context;constructor(e){this.context=e}onPageLoaded=(e,t)=>{const{internal:i,props:o,updateStickyRow:n,updateDesiredHeight:s}=this.context;o.onDataView?.(e),i.table&&(t&&o.onExportReady?.(i.table.createExportFunction(o.exportTitle)),n(),s())};onExecutionTransformed=e=>{const{internal:t,setState:i}=this.context;t.table&&(t.table.clearStickyRow(),(0,m.Z)(this.context.props.execution.definition.buckets[2],e.definition.buckets[2])||(i({tempExecution:e}),this.context.reinitialize?.(e)))};onLoadingChanged=e=>{const{props:t,setState:i}=this.context,{onLoadingChanged:o}=t;o&&(o(e),i({isLoading:e.isLoading}))};onError=(e,t=this.context.props.execution)=>{const{props:i,setState:o}=this.context,{onExportReady:n}=i;i.execution.fingerprint()===t.fingerprint()&&(o({error:e.getMessage(),readyToRender:!0}),this.onLoadingChanged({isLoading:!1}),n((0,a.createExportErrorFunction)(e)),i.onError?.(e))}}class yt{abortController;config;constructor(e){this.config=e,this.config.enableExecutionCancelling&&(this.abortController=new AbortController)}refresh(e){this.config.enableExecutionCancelling&&(!e.isLoading&&e.readyToRender||this.abortController?.abort(),this.abortController=new AbortController)}getCurrentController(){return this.config.enableExecutionCancelling?this.abortController:void 0}updateConfig(e){const t=this.config.enableExecutionCancelling;this.config=e,!t&&e.enableExecutionCancelling?this.abortController=new AbortController:t&&!e.enableExecutionCancelling&&(this.abortController=void 0)}isEnabled(){return Boolean(this.config.enableExecutionCancelling)}destroy(){this.abortController&&(this.abortController.abort(),this.abortController=void 0)}}var At=i(18608);function Mt(e,t,i){const o=At.X.convertValue(e);return At.X.formatValue(o,t,i)}function St(e,t,i){const{formattedValue:o}=Mt(e,t,i);return""===o?"â€“":o}function kt(e,t,i,o){const{formattedValue:n,colors:s}=Mt(e,t,i),r=s.color,a=s.backgroundColor,l={textAlign:"right"};return""===n?{...l,color:"var(--gd-table-nullValueColor, var(--gd-palette-complementary-6, #94a1ad))",fontWeight:"bold"}:o?{...l,...r&&{color:r},...a&&{backgroundColor:a}}:{...l}}function Ht(e){const t=[];return e.seriesDescriptor.attributeDescriptors&&e.seriesDescriptor.attributeDescriptors.forEach(((i,o)=>{const n=e.seriesDescriptor.attributeHeaders[o];t.push(n),t.push(i)})),t.push(e.seriesDescriptor.measureDescriptor),t}function Et(e,t,i){const o=t?function(e){const t=[];return e.descriptorsToHere.forEach(((i,o)=>{t.push(e.headersToHere[o]),t.push(i)})),t.push(e.header),t.push(e.attributeDescriptor),t}(e):[];return i?.measureDescriptor&&o.push(i.measureDescriptor),o}function zt(e,t){const i=[];if(t.measureDescriptor&&i.push(t.measureDescriptor),t.columnAttributeDescriptor){const o=t.headerItemMap[e.id];i.push(o),i.push(t.columnAttributeDescriptor)}return i}function Gt(e,t){const i=[];if(!t.headerItemMap)return[];const o=t.headerItemMap[e.id];return o?((0,s.kG)((0,r.isResultAttributeHeader)(o),`bad header for row data ${e.id}`),i.push(o),i.push(e.attributeDescriptor),i):[]}function Wt(e,t,i,o,n,r){if(0===o.length||"mixedHeadersCol"===e.type)return!1;const l=function(e,t,i,o){if(pe(e))return Ht(e);if(fe(e))return Et(e,"top"===i&&!o,t);if(ce(e))return(0,s.kG)(t),Gt(e,t);if(ge(e))return(0,s.kG)(t),zt(e,t);throw new s.ej(`unable to obtain drill headers for column of type ${e.type}`)}(e,t,n,r);return l.some((e=>(0,a.isSomeHeaderPredicateMatched)(o,e,i)))}function Ft(e,t,i){return o=>{const{rowIndex:n,data:l}=o,u=l,d=!o.value,h="top"===o.node.rowPinned;if((0,v.Z)(u))return c(i,h&&d?"gd-hidden-sticky-column":null);const m=e.getDrillDataContext(),g=o.colDef,p=e.tableDescriptor.getCol(g);(0,s.kG)(!be(p));const f=t.config?.columnHeadersPosition??"top",C=e.tableDescriptor.isTransposed(),b=(0,a.convertDrillableItemsToPredicates)(t.drillableItems),D=u.type===Y,w=u.type===ee,{isColumnTotal:T,isColumnSubtotal:x}=function(e,t,i,o,n){return"left"===n&&o?Object.keys(i.headerItemMap).length>0?{isColumnTotal:ge(t)&&(0,r.isResultTotalHeader)(i.headerItemMap[t.id])&&!0===t.isTotal,isColumnSubtotal:ge(t)&&(0,r.isResultTotalHeader)(i.headerItemMap[t.id])&&!0===t.isSubtotal}:{isColumnTotal:ge(t)&&!0===t.isTotal,isColumnSubtotal:ge(t)&&!0===t.isSubtotal}:o?{isColumnTotal:fe(t)&&!0===t.isTotal,isColumnSubtotal:fe(t)&&!0===t.isSubtotal}:{isColumnTotal:e.type===te,isColumnSubtotal:e.type===ie}}(g,p,u,C,f),I=g.type===X;let R=!1;const y=!d||g.type===q;!(D||w||T||x)&&!I&&y&&(R=Wt(p,u,m,b,f,C));const A=e.tableDescriptor.getAbsoluteLeafColIndex(p),M=pe(p)?p.fullIndexPathToHere.at(-1):void 0,S=!o.node.isRowPinned()&&e.getGroupingProvider().isRepeatedValue(p.id,n),k=!S&&e.getGroupingProvider().isGroupBoundary(n),H=u?.subtotalStyle,E=!!u?.measureDescriptor,z=H&&x,G=D&&x,W=D&&T,F=w&&T,L=!w||S||(0,v.Z)(o.value)?null:o.value?.toLowerCase?.();return c(i,void 0===M?null:`gd-column-measure-${M}`,function(e,t,i){return c({"gd-cell-drillable":i},"gd-cell",`s-cell-${e}-${t}`,"s-table-cell")}(n,A,R),`gd-column-index-${A}`,D?"gd-row-total":null,T?"gd-column-total":null,x?"gd-column-subtotal":null,L?`gd-table-row-subtotal-${L}`:null,H?`gd-table-row-subtotal gd-table-row-subtotal-${H}`:null,S?"gd-cell-hide s-gd-cell-hide":null,k?"gd-table-row-separator s-gd-table-row-separator":null,h&&d?"gd-hidden-sticky-column":null,z?"gd-table-row-subtotal-column-subtotal s-table-row-subtotal-column-subtotal":null,G?"gd-table-row-total-column-subtotal s-table-row-total-column-subtotal":null,W?"gd-table-row-total-column-total s-table-row-total-column-total":null,F?"gd-table-row-subtotal-column-total s-table-row-subtotal-column-total":null,E?"gd-table-row-metric-cell":null,C?"gd-transpose":null)}}function Lt(e,t){const i=[];return t.headers.sliceCols.forEach((t=>{const o=e.headerItemMap[t.id];(0,s.kG)(o);const n=(0,a.getMappingHeaderUri)(o)??null,r=function(e){return e?.startsWith("/gdc")?function(e){const[,t,,i=null]=e.match(/obj\/([^/]*)(\/elements\?id=)?(.*)$/);return[t,i]}(e)[1]:e}(n);switch(r){case"":i.push(Pt("","",""));break;case null:i.push(Pt(null,null,null));break;default:(0,a.hasMappingHeaderFormattedName)(o)?i.push(Pt(r,n,(0,a.getMappingHeaderName)(o)||e[t.id])):i.push(Pt(r,n,e[t.id]))}})),t.headers.leafDataCols.forEach((t=>{i.push(e[t.id])})),i}function Pt(e,t,i){return{id:e,uri:t,name:i}}function Nt(e,t,i){const o=[],n=t.getCol(e.colDef),r=e.data;return(0,s.kG)(ce(n)||pe(n)||t.isTransposed()&&fe(n)||t.isTransposed()&&ge(n)),pe(n)&&o.push(...Ht(n)),t.isTransposed()&&(fe(n)?o.push(...Et(n,!0,r)):ge(n)&&(o.push(...zt(n,r)),r.measureDescriptor?i.forEach((e=>o.push(...zt(n,e)))):i.forEach((e=>o.unshift(...zt(n,e)))))),t.getSliceColsUpToIncludingCol(n).forEach((e=>o.push(...Gt(e,r)))),(0,a.getDrillIntersection)(o)}function Ot(e,t){return i=>{(0,s.kG)(e.tableDescriptor);const o=i.data;if((0,s.kG)(o),Re(o.type))return!1;const{colDef:n,data:r,rowIndex:l}=i,u=e.tableDescriptor.getCol(n);if(he(u)||me(u))return!1;(0,s.kG)(ce(u)||pe(u)||e.tableDescriptor.isTransposed()&&fe(u)||e.tableDescriptor.isTransposed()&&ge(u));const{onDrill:d}=t,c=e.getDrillDataContext(),h=(0,a.convertDrillableItemsToPredicates)(t.drillableItems),m=e.tableDescriptor.isTransposed(),g=t.config?.columnHeadersPosition??"top",p=e.getRowNodes().slice(0,l);if(!Wt(u,i.data,c,h,g,m))return!1;const f={type:a.VisualizationTypes.TABLE,element:"cell",columnIndex:e.tableDescriptor.getAbsoluteLeafColIndex(u),rowIndex:l,row:Lt(r,e.tableDescriptor),intersection:Nt(i,e.tableDescriptor,p)},C={dataView:c.dataView,drillContext:f};if(d?.(C)){const e=new CustomEvent("drill",{detail:C,bubbles:!0});return i.event?.target?.dispatchEvent(e),!0}return!1}}var Bt=i(65165);function Zt(e,t){return i=>{if(!(i.event&&i.event instanceof KeyboardEvent))return;if(!(0,Bt.isEnterKey)(i.event)&&!(0,Bt.isSpaceKey)(i.event))return;if((0,s.kG)(e.tableDescriptor),!i.data)return;const{colDef:o,data:n,rowIndex:r}=i,l=e.tableDescriptor.getCol(o);if(!l)return;if(he(l)||me(l))return;(0,s.kG)(ce(l)||pe(l)||e.tableDescriptor.isTransposed()&&fe(l)||e.tableDescriptor.isTransposed()&&ge(l));const u=e.getDrillDataContext(),d=(0,a.convertDrillableItemsToPredicates)(t.drillableItems??[]),c=e.tableDescriptor.isTransposed();if(!Wt(l,n,u,d,t.config?.columnHeadersPosition??"top",c))return;const{onDrill:h}=t,m=e.getRowNodes().slice(0,r),g={type:a.VisualizationTypes.TABLE,element:"cell",columnIndex:e.tableDescriptor.getAbsoluteLeafColIndex(l),rowIndex:r,row:Lt(n,e.tableDescriptor),intersection:Nt(i,e.tableDescriptor,m)},p={dataView:u.dataView,drillContext:g};"function"==typeof h&&h(p)}}function Ut(e,t,i){return t=>{const{tableDescriptor:o}=e,n=t.colDef,s=De(n);if(!s)return c(i);if(s===de){const e=!o.sliceColCount()&&!o.sliceMeasureColCount()&&!o.hasHeadersOnLeft();return c(i,"gd-column-group-header","s-table-column-group-header-descriptor",e?"gd-column-group-header--first":null)}{const e=o.getCol(s),t=e.fullIndexPathToHere,a=t?t[t.length-1]:void 0,l=o.isFirstCol(s)||!o.hasScopingCols(),u=function(e,t){return t.isTransposed()?fe(e)&&(0,r.isResultTotalHeader)(e.header)&&0===e.headersToHere.length&&e.children?.length>0:fe(e)&&(0,r.isResultTotalHeader)(e.header)}(e,o)||function(e,t){return me(t)&&""===e.children?.[0]?.headerName}(n,e),d=fe(e)&&(0,r.isResultTotalHeader)(e.header)&&0===e.headersToHere.length,h=function(e,t,i){return i.isTransposed()?fe(t)&&!0===t.isTotal:e.type===te}(n,e,o),m=function(e,t,i){return i.isTransposed()?fe(t)&&!0===t.isSubtotal:e.type===ie}(n,e,o),g=pe(e)?o.getAbsoluteLeafColIndex(e):void 0,p=fe(e)&&o.isTransposed()&&n.type===K,f=he(e);return c(i,"gd-column-group-header",void 0===a?null:`gd-column-group-header-${a}`,void 0===a?null:`s-table-measure-column-header-group-cell-${a}`,void 0===a||ce(e)?null:`s-table-measure-column-header-cell-${a}`,void 0===g?null:`s-table-measure-column-header-index-${g}`,l?"gd-column-group-header--first":null,u?"gd-column-group-header--subtotal":null,d?"gd-column-group-header-total--first s-column-group-header-total--first":null,n.headerName||u||o.isTransposed()?null:"gd-column-group-header--empty",h?"gd-column-total":null,m?"gd-column-subtotal":null,p?"gd-transpose-header":null,f?"gd-row-slice-measure-header":null)}}}const jt=(e,t,i,o)=>{if(0===i)return o?e.formatMessage({id:"visualizations.menu.aggregations.all-rows"}):e.formatMessage({id:"visualizations.menu.aggregations.all-columns"});const n=((e,t)=>(0,r.attributeDescriptorName)(e[t-1]))(t,i);return e.formatMessage({id:"visualizations.menu.aggregations.within-attribute"},{attributeName:n})},Vt=e=>`s-aggregation-item-${e.replace(/\./g,"-")}`;function _t({attributeDescriptors:e,measureLocalIdentifiers:t,intl:i,totalType:n,totals:s,isColumn:a,icon:l,headerText:u,onAggregationSelect:d}){const h=e.map(((l,u)=>{const h=(0,r.attributeDescriptorLocalId)(e[u]),m=xt.isTotalEnabledForSubMenuAttribute(h,n,s),g=jt(i,e,u,a);return(0,o.jsx)(Bt.Item,{checked:m,children:(0,o.jsx)("div",{onClick:()=>d({type:n,measureIdentifiers:t,include:!m,attributeIdentifier:h,isColumn:a}),className:c("gd-aggregation-menu-item-inner","s-menu-aggregation-inner",Vt(h),{"s-menu-aggregation-inner-selected":m,"s-menu-aggregation-inner-column":!a,"s-menu-aggregation-inner-row":a}),children:g})},h)}));return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(Bt.Header,{children:[l,(0,o.jsx)("span",{children:u})]}),h]})}function $t(){const e=(0,f.Fg)(),t=Bt.Icon.Columns;return(0,o.jsx)("div",{className:"gd-aggregation-submenu-header-icon",children:(0,o.jsx)(t,{width:12,height:11,colorPalette:{normalColumn:e?.palette?.complementary?.c7,totalColumn:e?.palette?.complementary?.c4}})})}const{Rows:Kt}=Bt.Icon;function qt(){const e=(0,f.Fg)();return(0,o.jsx)("div",{className:"gd-aggregation-submenu-header-icon",children:(0,o.jsx)(Kt,{width:12,height:11,colorPalette:{normalRow:e?.palette?.complementary?.c7,totalRow:e?.palette?.complementary?.c4}})})}const Xt=-36;function Jt({intl:e,totalType:t,toggler:i,isMenuOpened:n=!1,rowAttributeDescriptors:s,columnAttributeDescriptors:r,measureLocalIdentifiers:a,columnTotals:l,rowTotals:u,showColumnsSubMenu:d,onAggregationSelect:h}){const m=n?{opened:!0}:{},g=Ne(s)&&Oe(r)&&d;return(0,o.jsx)(Bt.SubMenu,{toggler:i,offset:Xt,...m,children:(0,o.jsx)(Bt.ItemsWrapper,{children:(0,o.jsxs)("div",{className:"gd-aggregation-submenu s-table-header-submenu-content",children:[Ne(s)?(0,o.jsx)(_t,{intl:e,attributeDescriptors:s,measureLocalIdentifiers:a,totalType:t,totals:l,isColumn:!0,icon:(0,o.jsx)(qt,{}),headerText:e.formatMessage({id:"visualizations.menu.aggregations.rows"}),onAggregationSelect:h}):null,(0,o.jsx)("div",{className:c("s-table-header-submenu-rows-separator",{"gd-aggregation-submenu-rows-separator":g})}),Oe(r)&&d?(0,o.jsx)(_t,{intl:e,attributeDescriptors:r,measureLocalIdentifiers:a,totalType:t,totals:u,isColumn:!1,icon:(0,o.jsx)($t,{}),headerText:e.formatMessage({id:"visualizations.menu.aggregations.columns"}),onAggregationSelect:h}):null]})})})}var Qt=i(73657);const Yt=200,ei=0;function ti(){const e=(0,f.Fg)(),t=Bt.Icon.BurgerMenu;return(0,o.jsx)("div",{className:"menu-icon",children:(0,o.jsx)(t,{color:e?.palette?.complementary?.c8})})}function ii({intl:e,colId:t,getTableDescriptor:i,isMenuOpened:n,onMenuOpenedChange:s,showColumnsSubMenu:a,isMenuButtonVisible:u,getColumnTotals:d,getRowTotals:h,getExecutionDefinition:m,onAggregationSelect:g,showSubmenu:p,availableTotalTypes:f}){const C=(0,l.useCallback)(((e,t,i)=>{const o=h?.()??[];return t?xt.getTotalsForAttributeHeader(o,e,i):xt.getTotalsForMeasureHeader(o,e[0])}),[h]),b=(0,l.useCallback)((()=>c("s-table-header-menu","gd-pivot-table-header-menu",{"gd-pivot-table-header-menu--show":u,"gd-pivot-table-header-menu--hide":!u,"gd-pivot-table-header-menu--open":n})),[u,n]),D=(0,l.useCallback)(((t,i,n=!1,s,r)=>{const a=(0,o.jsx)(Bt.Item,{checked:i,subMenu:n,disabled:s,children:(0,o.jsx)("div",{className:"gd-aggregation-menu-item-inner s-menu-aggregation-inner",children:e.formatMessage(Qt.s[t])})});return s?(0,o.jsxs)(Bt.BubbleHoverTrigger,{showDelay:Yt,hideDelay:ei,children:[a,(0,o.jsx)(Bt.Bubble,{className:"bubble-primary",alignPoints:[{align:"bc tc"}],children:r})]}):a}),[e]),w=(0,l.useCallback)((e=>c("gd-aggregation-menu-item","s-menu-aggregation",`s-menu-aggregation-${e}`)),[]),v=(0,l.useCallback)((()=>m().filters.some((e=>(0,r.isMeasureValueFilter)(e)&&!!(0,r.measureValueFilterCondition)(e)))),[m]),T=(0,l.useCallback)((()=>m().filters.some(r.isRankingFilter)),[m]),x=(0,l.useCallback)(((t,i,n,s,r,a)=>{const l=v(),u=T(),d=Tt(s),c=Tt(r);return f.map((h=>{const m=xt.isTotalEnabledForAttribute(d,c,h,t,i),f=w(h),C="nat"===h&&(l||u),b=l?Qt.s["disabled.mvf"]:Qt.s["disabled.ranking"],v=C?e.formatMessage(b):void 0,T=!C&&p,x=D(h,m,T,C,v);return(0,o.jsx)("div",{className:f,children:T?(0,o.jsx)(Jt,{intl:e,totalType:h,rowAttributeDescriptors:s,columnAttributeDescriptors:r,columnTotals:t,rowTotals:i,measureLocalIdentifiers:n,onAggregationSelect:g,toggler:x,showColumnsSubMenu:a}):x},h)}))}),[f,w,e,v,T,g,D,p]);if(!t)return null;const I=i(),R=I.canTableHaveColumnTotals()&&a;if(!I.canTableHaveRowTotals()&&!R)return null;const y=I.getCol(t);if(ce(y)||be(y))return null;const A=(pe(y)?[y.seriesDescriptor.measureDescriptor]:I.getMeasures()).map((e=>e.measureHeaderItem.localIdentifier)),M=fe(y)||he(y),S=((e,t,i)=>{const o=d?.()??[];return t?xt.getTotalsForAttributeHeader(o,e,i):xt.getTotalsForMeasureHeader(o,e[0])})(A,M,he(y)),k=C(A,M,he(y)),H=I.getSlicingAttributes(),E=I.getScopingAttributes();return(0,o.jsx)(Bt.Menu,{toggler:(0,o.jsx)(ti,{}),togglerWrapperClassName:b(),opened:n,onOpenedChange:s,openAction:"click",closeOnScroll:!0,children:(0,o.jsx)(Bt.ItemsWrapper,{children:(0,o.jsxs)("div",{className:"s-table-header-menu-content",children:[(0,o.jsx)(Bt.Header,{children:e.formatMessage({id:"visualizations.menu.aggregations"})}),x(S,k,A,H,E,a)]})})})}const oi="left",ni="right";function si({sortDirection:e=null,textAlign:t=oi,menuPosition:i=oi,menu:n=null,enableSorting:s=!1,onMenuAggregationClick:r=(()=>null),onSortClick:a=(()=>null),displayText:u,className:d,defaultSortDirection:h,intl:m,colId:g,getTableDescriptor:p,getExecutionDefinition:f,getColumnTotals:C,getRowTotals:b,isFocused:D}){const[w,v]=(0,l.useState)(!1),[T,x]=(0,l.useState)(!1),[I,R]=(0,l.useState)(null),y=(0,l.useCallback)((()=>{R(e)}),[e]),A=(0,l.useRef)(e);(0,l.useEffect)((()=>{A.current!==e&&(A.current=e,y())}),[e,y]);const M=(0,l.useCallback)((()=>{if(s){let t;t=null===e?h??null:"asc"===e?"desc":"desc"===e?"asc":null,R(t)}}),[s,e,h,R]),S=(0,l.useCallback)((()=>{y()}),[y]);(0,l.useEffect)((()=>{D?M():S()}),[D,M,S]);const k=(0,l.useCallback)((({opened:e,source:t})=>{v(e),"OUTSIDE_CLICK"!==t&&"SCROLL"!==t||x(!1)}),[]),H=(0,l.useCallback)((()=>{x(!1),v(!1)}),[]),E=(0,l.useCallback)((e=>{H(),r&&r(e)}),[H,r]),z=(0,l.useCallback)((()=>n?.aggregations?(0,o.jsx)(ii,{intl:m,colId:g,isMenuOpened:w,isMenuButtonVisible:T,showSubmenu:n.aggregations??!1,showColumnsSubMenu:n.aggregationsSubMenuForRows??!1,availableTotalTypes:n.aggregationTypes??ne,getTableDescriptor:p,getExecutionDefinition:f,getColumnTotals:C,getRowTotals:b,onMenuOpenedChange:k,onAggregationSelect:E}):null),[g,C,f,b,p,k,m,T,w,n?.aggregationTypes,n?.aggregations,n?.aggregationsSubMenuForRows,E]),G=(0,l.useCallback)((()=>{s&&a()}),[s,a]),W=(0,l.useCallback)((()=>{const e=c("s-sort-direction-arrow",`s-sorted-${I}`,{"gd-pivot-table-header-arrow-up":"asc"===I,"gd-pivot-table-header-arrow-down":"desc"===I});return I&&s&&(0,o.jsx)("span",{className:"gd-pivot-table-header-next-sort",children:(0,o.jsx)("span",{className:e})})}),[I,s]),F=(0,l.useCallback)((()=>{const e=c(ae,"gd-pivot-table-header-label",{"gd-pivot-table-header-label--right":"right"===t,"gd-pivot-table-header-label--center":"center"===t,"gd-pivot-table-header-label--clickable":s});return(0,o.jsxs)("div",{className:e,onClick:G,onMouseEnter:M,onMouseLeave:S,children:[(0,o.jsx)("span",{children:u||""}),W()]})}),[u,s,M,S,G,W,t]),L=(0,l.useCallback)((()=>{w||x(!1)}),[w]),P=(0,l.useCallback)((()=>{w||x(!0)}),[w]),N=(0,l.useCallback)((()=>{P()}),[P]),O=(0,l.useCallback)((()=>{L()}),[L]);return(0,o.jsxs)("div",{className:c("gd-pivot-table-header",{"gd-pivot-table-header--open":T},d),onMouseEnter:N,onMouseLeave:O,children:["left"===i&&z(),F(),"right"===i&&z()]})}function ri({getTableDescriptor:e,getExecutionDefinition:t,getColumnTotals:i,getRowTotals:n,displayName:s,column:r,intl:a}){const u=(0,l.useCallback)((()=>e().getCol(r)),[r,e])(),d=ce(u)||Ce(u)?oi:ni;return(0,o.jsx)(si,{className:"gd-pivot-table-column-total-header s-pivot-table-column-total-header",textAlign:d,displayText:s,enableSorting:!1,colId:r.getColDef().field,getTableDescriptor:e,getExecutionDefinition:t,getColumnTotals:i,getRowTotals:n,intl:a})}function ai(e){return(0,o.jsx)("div",{className:c("gd-pivot-table-header s-pivot-table-column-header s-pivot-table-mixed-values-column-header"),children:(0,o.jsx)("div",{className:c(ae,"gd-pivot-table-header-label")})})}function li(e){return t=>{const i=void 0!==t.node.id||"bottom"===t.node.rowPinned,n=(0,f.Fg)(),s=t.colDef&&e?.getCol(t.colDef),r=s&&!be(s)&&0===e.getAbsoluteLeafColIndex(s);if(!i&&r){const e=n?.table?.loadingIconColor??n?.palette?.complementary?.c6??void 0;return(0,o.jsx)(a.LoadingComponent,{color:e,width:36,imageHeight:8,height:26,speed:2})}const l=Re(t.data?.type),u=l&&function(e){const t=e.data;if(!t?.calculatedForColumns||!e.colDef)return!1;const i=De(e.colDef);return t.calculatedForColumns.some((e=>e===i))}(t),d=!l||u||t.value?t.formatValue(t.value):"";if(function(e){return(e.colDef?.type===X||e.colDef?.type===J)&&e.data?.measureDescriptor}(t)){const e=t.colDef?.headerComponent,n=t.data?.measureDescriptor?.measureHeaderItem,s=(h=t.colDef?.headerComponentParams,(m=n)?{...h,onMenuAggregationClick:e=>h.onMenuAggregationClick({...e,measureIdentifiers:[m.localIdentifier]})}:h),r=l?{menu:null}:{},a=()=>s.getRowTotals().filter((e=>e.measureIdentifier===n?.localIdentifier)),u=()=>s.getColumnTotals().filter((e=>e.measureIdentifier===n?.localIdentifier)),g=c("gd-row-measure-name",{"s-loading-done":i});return(0,o.jsx)(e,{...s,className:g,column:t.column,displayName:d,getRowTotals:a,getColumnTotals:u,...r})}var h,m;const g=c("top"===t.node.rowPinned?"gd-sticky-header-value":re,{"s-loading-done":i});return(0,o.jsx)("span",{className:g,title:d||"",children:d||""})}}function ui(e,t){const i=li(e.tableDescriptor);return{suppressSpanHeaderHeight:!0,cellClass:Ft(e,t,"gd-row-attribute-column"),headerClass:Ut(e,0,"gd-row-attribute-column-header"),colSpan:e=>e.data?.colSpan&&ne.find((t=>t===e.data[e.data.colSpan.headerKey]))?e.data.colSpan.count:1,valueFormatter:e=>void 0===e.value?null:e.value,cellRenderer:i}}function di(e,t){const i=li(e.tableDescriptor);return{suppressSpanHeaderHeight:!0,cellClass:Ft(e,t,"gd-row-measure-column"),headerClass:Ut(e,0,"gd-row-measure-header"),colSpan:e=>1,valueFormatter:e=>void 0===e.value?null:e.value,cellRenderer:i,sortable:!1}}function ci(e,t){if(e.data?.measureDescriptor){const i=e.data?.measureDescriptor;return void 0===e.value?null:St(e.value,i.measureHeaderItem.format,t)}return void 0===e.value?null:e.value}function hi(e,t){const i=t.config?.separators,o=li(e.tableDescriptor);return{suppressSpanHeaderHeight:!0,cellClass:Ft(e,t,"gd-column-attribute-column"),headerClass:Ut(e,0,"gd-column-attribute-column-header"),valueFormatter:e=>ci(e,i),cellStyle:e=>{if(e.data?.measureDescriptor){const t=e.data?.measureDescriptor;return void 0===e.value?null:kt(e.value,t.measureHeaderItem.format,i,!0)}return null},cellRenderer:o}}function mi(e,t){const i=li(e.tableDescriptor);return{suppressSpanHeaderHeight:!0,cellClass:Ft(e,t,"gd-mixed-headers-column"),headerClass:Ut(e,0,"gd-mixed-headers-column-header"),colSpan:e=>e.data?.colSpan&&ne.find((t=>t===e.data[e.data.colSpan.headerKey]))?e.data.colSpan.count:1,valueFormatter:e=>void 0===e.value?null:e.value,cellRenderer:i}}const gi="ag-numeric-cell";function pi(e,t){const i=li(e.tableDescriptor),o=t.config?.separators;return{suppressSpanHeaderHeight:!0,cellClass:Ft(e,t,c(gi,"gd-measure-column")),headerClass:Ut(e,0,c("ag-numeric-header","gd-measure-column-header")),valueFormatter:t=>{const i=e.tableDescriptor.getCol(t.colDef);return(0,s.kG)(pe(i)),void 0===t.value?null:St(t.value,i.seriesDescriptor.measureFormat(),o)},cellStyle:t=>{const i=e.tableDescriptor.getCol(t.colDef);return(0,s.kG)(pe(i)),void 0===t.value?null:kt(t.value,i.seriesDescriptor.measureFormat(),o,!0)},cellRenderer:i}}function fi(e,t){const i=li(e.tableDescriptor),o=t.config?.separators;return{headerComponent:ri,suppressSpanHeaderHeight:!0,cellClass:Ft(e,t,c(gi,"gd-total-column")),headerClass:Ut(e,0,"gd-total-column-header"),valueFormatter:t=>{const i=e.tableDescriptor.getCol(t.colDef);return(0,s.kG)(pe(i)),void 0===t.value?null:St(t.value,i.seriesDescriptor.measureFormat(),o)},cellStyle:t=>{const i=e.tableDescriptor.getCol(t.colDef);return(0,s.kG)(pe(i)),void 0===t.value?null:kt(t.value,i.seriesDescriptor.measureFormat(),o,!0)},cellRenderer:i}}function Ci(e,t){const i=li(e.tableDescriptor),o=t.config?.separators;return{headerComponent:ai,suppressSpanHeaderHeight:!0,cellClass:Ft(e,t,c("gd-mixed-values-column")),headerClass:Ut(e,0,"gd-mixed-values-column-header"),valueFormatter:e=>ci(e,o),cellStyle:e=>{if(e.data?.measureDescriptor){const t=e.data?.measureDescriptor;return void 0===e.value?null:kt(e.value,t.measureHeaderItem.format,o,!0)}return{textAlign:"left"}},cellRenderer:i}}function bi({menu:e,columnGroup:t,intl:i,getTableDescriptor:n,displayName:s,onMenuAggregationClick:r,getExecutionDefinition:a,getColumnTotals:l,getRowTotals:u}){const d=t.getColGroupDef(),c=De(d),h=t.getParent(),m=n().isTransposed(),g=!!h&&!!d.headerName&&!m;return(0,o.jsx)(si,{className:"s-pivot-table-column-group-header",displayText:s,enableSorting:!1,menuPosition:oi,textAlign:oi,menu:g?e?.():void 0,onMenuAggregationClick:r,colId:c,getTableDescriptor:n,getExecutionDefinition:a,getColumnTotals:l,getRowTotals:u,intl:i})}const Di=function(e){const{className:t,column:i,api:n,getTableDescriptor:s,displayName:r,enableSorting:a,menu:u,progressSort:d,eGridHeader:h,setLastSortedColId:m}=e,[g,p]=(0,l.useState)(i.getSort());(0,l.useEffect)((()=>{const e=e=>{const t=i.getSort();p(t)};return i.addEventListener("sortChanged",e),()=>{i.removeEventListener("sortChanged",e)}}),[i]);const f=(0,l.useCallback)((()=>{d(!1),n.refreshHeader()}),[n,d]),C=e.getTableDescriptor().getCol(e.column),b=ce(C)||Ce(C)||he(C)||ge(C)||me(C)?oi:ni,D=!Ce(C)&&!he(C)&&!ge(C)&&!me(C)&&a,w=!s().isTransposed()||he(C)&&r||me(C),[v,T]=(0,l.useState)(!1);return(0,l.useEffect)((()=>{if(!n)return;const e=e=>{const t=e.column.isColumn?e.column.getColId():e.column.getGroupId(),o=i.getColId();T(t===o)};return n.addEventListener("headerFocused",e),()=>{n.removeEventListener("headerFocused",e)}}),[n,i]),(0,l.useEffect)((()=>{if(!h)return;const e=e=>{(0,Bt.isEnterKey)(e)&&D&&m&&m(i.getColId()),(0,Bt.isSpaceKey)(e)&&(e.preventDefault(),D&&m&&(m(i.getColId()),f()))},t=()=>{T(!1)};return h.addEventListener("keydown",e),w||h.addEventListener("blur",t),()=>{h.removeEventListener("keydown",e),w||h.removeEventListener("blur",t)}}),[h,i,D,m,w,f]),(0,o.jsx)(si,{className:c("s-pivot-table-column-header",t),textAlign:b,displayText:r,enableSorting:D,sortDirection:g,defaultSortDirection:i.getColDef().sortingOrder?.[0]??void 0,onSortClick:f,onMenuAggregationClick:e.onMenuAggregationClick,menu:w?u?.():void 0,colId:i.getColDef().field,getTableDescriptor:s,getExecutionDefinition:e.getExecutionDefinition,getColumnTotals:e.getColumnTotals,getRowTotals:e.getRowTotals,intl:e.intl,isFocused:v})};class wi{init(){}getGui(){return document.createElement("span")}}class vi{context;static HEIGHT_CHANGE_TOLERANCE=2;constructor(e){this.context=e}getScrollBarPadding=()=>{const{internal:e,getContainerRef:t}=this.context;if(!e.table?.isFullyInitialized())return 0;const i=t();return i&&function(e){const{scrollWidth:t,clientWidth:i}=e.getElementsByClassName("ag-body-horizontal-scroll-viewport")[0];return t>i}(i)?We():0};calculateDesiredHeight=()=>{const{internal:e,props:t}=this.context,{maxHeight:i}=t.config;if(!i)return;const o=(e.table?.getTotalBodyHeight()??0)+this.getScrollBarPadding();return Math.min(o,i)};updateDesiredHeight=()=>{const{internal:e,state:t,setState:i}=this.context;if(!e.table)return;const o=this.calculateDesiredHeight();(void 0===t.desiredHeight||void 0!==o&&Math.abs(t.desiredHeight-o)>vi.HEIGHT_CHANGE_TOLERANCE)&&i({desiredHeight:o})}}class Ti{context;constructor(e){this.context=e}isStickyRowAvailable=()=>{const{internal:e,getGroupRows:t}=this.context;return(0,s.kG)(e.table),Boolean(t()&&e.table.stickyRowExists())};updateStickyRow=()=>{const{internal:e}=this.context;if(e.table&&this.isStickyRowAvailable()){const t={...e.lastScrollPosition};e.lastScrollPosition={top:0,left:0},this.updateStickyRowContent(t)}};updateStickyRowContent=e=>{const{internal:t}=this.context;(0,s.kG)(t.table),this.isStickyRowAvailable()&&(t.table.updateStickyRowPosition(),t.table.updateStickyRowContent({scrollPosition:e,lastScrollPosition:t.lastScrollPosition})),t.lastScrollPosition={...e}}}var xi=i(20434);function Ii(e,t,i){const o="rows"===t&&"left"===i?1:0;return{measures:e.meta().measureDescriptors().map((t=>({measure:t,attributes:e.meta().attributeDescriptors()}))),attributes:e.meta().attributeDescriptorsForDim(o).map(((e,t,i)=>({attribute:e,intersectionAttributes:(0,a.getIntersectionAttributes)(e,i)})))}}var Ri=i(69203);function yi(e,t,i){const o=e.getDisplayedRowAtIndex?.(i)?.beans?.rowRenderer;if(!o)return null;const n=o.getAllCellCtrls().filter((e=>e.rowNode.rowIndex===i)),s=n?.find((e=>e.column.colId===t));return s?.eGui??null}function Ai(e){const t=e.getPinnedTopRow(0);if(!t)return null;const i=t.beans?.ctrlsSvc?.getGridBodyCtrl?.()?.eGridBody,o=i?.querySelector(`[row-id=${t.id}]`);return o?.parentElement?.parentElement?.parentElement??null}const Mi={getHeaderHeight:function(e){const t=e.getDisplayedRowAtIndex?.(0)?.beans?.ctrlsSvc?.get("gridHeaderCtrl");return t?t?.eGui?.clientHeight??0:e.getSizesForCurrentTheme().headerHeight},getCellElement:yi,addCellClass:function(e,t,i,o){const n=yi(e,t,i);null!==n&&n.classList.add(o)},removeCellClass:function(e,t,i,o){const n=yi(e,t,i);null!==n&&n.classList.remove(o)},getPinnedTopRowElement:Ai,addPinnedTopRowClass:function(e,t){const i=Ai(e);i&&i.classList.add(t)},removePinnedTopRowClass:function(e,t){const i=Ai(e);i&&i.classList.remove(t)},setPinnedTopRowStyles:function(e,t){const i=Ai(e);if(i)for(const[e,o]of Object.entries(t))i.style[e]=o}};function Si(e,t,i){ki(e,t,i,(()=>!0))}function ki(e,t,i,o){t.forEach((t=>{const n=e.getColumn(t);n&&o(n)&&(n.maxWidth=i,n.getColDef().maxWidth=i)}))}var Hi=i(36360);function Ei(e,t){return e.findIndex((e=>(0,r.isResultTotalHeader)(e[t])))}function zi(e,t,i,o,n,l){const u=e[o][t],d={field:i.id,rowHeaderDataItem:u,isSubtotal:!1};if((0,r.isResultAttributeHeader)(u))return{...d,value:(0,Hi.U)((0,a.getMappingHeaderFormattedName)(u),(0,a.emptyHeaderTitleFromIntl)(l))};if((0,r.isResultMeasureHeader)(u)){const e=n.getMeasures()[u.measureHeaderItem.order];return{...d,value:(0,Hi.U)(e.measureHeaderItem.name,(0,a.emptyHeaderTitleFromIntl)(l))}}if((0,r.isResultTotalHeader)(u)){const i=u.totalHeaderItem.name,n=u.totalHeaderItem.measureIndex;if(void 0!==n){const t=function(e){return e.find((e=>(0,r.isResultMeasureHeader)(e[0])))?.filter(r.isMeasureDescriptor)}(e),i=function(e,t){return e?.find((e=>e.measureHeaderItem.order===t))?.measureHeaderItem.name??null}(t,n);return{...d,isSubtotal:!0,value:i}}return{...d,isSubtotal:!0,value:Ei(e,t)===o?l.formatMessage(Qt.s[i]):null}}(0,s.kG)(!1,"row header is not of type IResultAttributeHeaderItem or IResultTotalHeaderItem")}function Gi(e,t,i){const o=e.meta().allHeaders(),n=e.definition.dimensions,l=function(e){const t=e.rawData().twoDimData(),i=(e.meta().allHeaders()[0][0]||[]).length;return t.length>0?t:Array(i).fill([null])}(e);if(t.headers.mixedHeadersCols.length>0&&t.isTransposed()){const n=e.rawData().columnTotals(),s=l,u=[];return n&&n.forEach(((e,t)=>{s[t].push(...n[t])})),o[1].forEach(((n,s)=>{const l=t.headers.mixedHeadersCols[0],d=e.data().slices().descriptors.filter(r.isAttributeDescriptor),c=d[s].attributeHeader.formOf.name,h={[l.id]:c,columnAttributeDescriptor:d[s],headerItemMap:{}};t.headers.mixedValuesCols.forEach(((e,t)=>{const l=n[t],u=(0,Hi.U)((0,a.getMappingHeaderFormattedName)(l),(0,a.emptyHeaderTitleFromIntl)(i));if((0,r.isResultAttributeHeader)(l))h[e.id]=u,h.headerItemMap[e.id]=l;else if((0,r.isResultTotalHeader)(l)){let n=i?.formatMessage(Qt.s[u]);if(s>0){const e=o[1][s-1]?.[t];(0,r.isTotalDescriptor)(e)&&(0,a.getMappingHeaderFormattedName)(e)===(0,a.getMappingHeaderFormattedName)(l)&&(n="")}h[e.id]=n,h.headerItemMap[e.id]=l}})),u.push(h)})),o[0][0].filter(r.isResultMeasureHeader).forEach(((e,i)=>{const o=t.headers.mixedHeadersCols[0],n=e.measureHeaderItem,r={[o.id]:n.name,measureDescriptor:t.getMeasures()[n.order],headerItemMap:{}};t.headers.mixedValuesCols.forEach(((e,t)=>{r[e.id]=s[i][t]})),u.push(r)})),{rowData:u,rowTotals:[]}}{const u=e.rawData().columnTotals(),d=function(e){if(!e?.totals)return[];let t=!1;return[null,...e.itemIdentifiers.slice(1).map((i=>e.totals?.some((e=>e.attributeIdentifier===i))?(t=!t,t?"even":"odd"):null))]}(n?.[0]),c=l.map(((n,s)=>{const a=e.rawData().hasColumnTotals()?[...n,...u[s]]:n;return function(e,t,i,o,n,s){const a={headerItemMap:{}};return e.headers.sliceCols.forEach(((t,r)=>{const{isSubtotal:l,field:u,value:d,rowHeaderDataItem:c}=zi(o,i,t,r,e,s);l&&(a.type=ee,a.subtotalStyle||(a.subtotalStyle=n[r]??void 0)),a[u]=d,a.headerItemMap[u]=c})),e.headers.sliceMeasureCols.forEach((t=>{const{field:n,value:l,rowHeaderDataItem:u}=zi(o,i,t,t.index,e,s);if(a[n]=l,a.headerItemMap[n]=u,(0,r.isResultMeasureHeader)(u))a.measureDescriptor=e.getMeasures()[u.measureHeaderItem.order];else if((0,r.isResultTotalHeader)(u)){const t=u.totalHeaderItem.measureIndex;void 0!==t&&(a.measureDescriptor=e.getMeasures()[t])}})),e.headers.mixedValuesCols.forEach(((e,i)=>{a[e.id]=t[i]})),e.hasDataLeafCols()?(t.forEach(((t,i)=>{const o=e.headers.leafDataCols[i]?.id;a[o]=t})),a):a}(t,a,s,o[0],d,i)})),h=function(e,t,i){if(!t.rawData().hasRowTotals())return null;const o=t.rawData().rowTotals();(0,s.kG)(o&&o.length>0);const n=o,l=t.definition.dimensions[0].totals;if(!l)return null;const u=function(e,t){const i=e.getGrandTotalCol(),o=function(e){const t=(0,r.bucketsFind)(e.buckets,a.BucketNames.ATTRIBUTE),i=t?.items?.[0];return(0,r.isAttribute)(i)?(0,r.attributeLocalId)(i):""}(t.definition),n=t.definition.dimensions[0].totals,s=n?.filter((e=>e.attributeIdentifier===o))??[];return e.isTransposed()?s.map((e=>({totalHeaderItem:{name:e.type,measureIdentifier:e.measureIdentifier}}))):i.effectiveTotals}(e,t),d=e.getGrandTotalCol(),c=d.attributeDescriptor,h=e.zippedLeaves,m=t.rawData().totalOfTotals();return n.map(((t,o)=>{const n=u[o],s=n?.totalHeaderItem.name,r={},a=[],g=l.filter((e=>s===e.type&&e.attributeIdentifier===c.attributeHeader.localIdentifier)).map((e=>e.measureIdentifier));(m?[...t,...m[0][o]]:t).forEach(((t,i)=>{const o=h[i],n=o?o[0]:e.headers.mixedValuesCols[i];r[n.id]=t,(!pe(n)||g.indexOf(n.seriesDescriptor.measureDescriptor.measureHeaderItem.localIdentifier)>-1)&&a.push(n.id)}));let p={};if(e.isTransposed()){const t=e.headers.sliceMeasureCols[0],i=n?.totalHeaderItem?.measureIdentifier,o=function(e,t){return e.getMeasures().find((e=>e.measureHeaderItem.localIdentifier===t))}(e,i);p={[t.id]:o?.measureHeaderItem?.name,measureDescriptor:o}}return{colSpan:{count:e.sliceColCount()-e.sliceMeasureColCount(),headerKey:d.id},...r,[d.id]:i.formatMessage({id:`visualizations.totals.dropdown.title.${s}`}),...p,calculatedForColumns:a,type:Y}}))}(t,e,i);return{rowData:c,rowTotals:h}}}var Wi=i(90783);class Fi{reset(){}isGroupBoundary(e){return!1}isColumnWithGrouping(e){return!1}processPage(e,t,i){}isRepeatedValue(e,t){return!1}}class Li{itemUris={};itemRepetitions={};repetitionsCounts=[];maxRepetitions=0;constructor(){this.reset()}reset(){this.itemUris={},this.itemRepetitions={},this.repetitionsCounts=[],this.maxRepetitions=0}isRepeatedValue(e,t){return!!this.itemRepetitions[e]&&!0===this.itemRepetitions[e][t]}isGroupBoundary(e){return!!this.repetitionsCounts&&(void 0===this.repetitionsCounts[e]||this.repetitionsCounts[e]<this.maxRepetitions)}isColumnWithGrouping(e){return Object.keys(this.itemRepetitions).indexOf(e)<this.maxRepetitions}processPage(e,t,i){i.forEach((i=>{this.itemUris[i]||(this.itemUris[i]=[]),e.forEach(((e,o)=>{const n=e.headerItemMap[i];if((0,r.isResultAttributeHeader)(n)){const e=n.attributeHeaderItem.uri;this.itemUris[i][o+t]=e}}))})),this.update()}update(){this.repetitionsCounts=null,this.maxRepetitions=0;let e=null;Object.keys(this.itemUris).forEach((t=>{const i=this.itemUris[t].length;this.itemRepetitions[t]=Array(i).fill(!1),null===this.repetitionsCounts&&(this.repetitionsCounts=Array(i).fill(0)),this.updateAttributeColumn(this.itemUris[t],this.itemRepetitions[t],null===e?null:this.itemRepetitions[e]),e=t})),this.maxRepetitions=(0,Wi.Z)(this.repetitionsCounts)??0}updateAttributeColumn(e,t,i){let o=null;e.forEach(((e,n)=>{let s=o===e;null!==i&&(s=s&&i[n]),s&&(t[n]=!0,this.repetitionsCounts[n]+=1),o=e}))}}class Pi{static createProvider(e){return e?new Li:new Fi}}var Ni=i(69884);function Oi(e,t){let i;for(const o of e){if(be(o))i=Oi(o.children,t);else if(fe(o)){const e=o.attributeDescriptor.attributeHeader.localIdentifier,n=t.find((t=>k(t)?t.attributeLocatorItem.attributeIdentifier===e:H(t)?t.totalLocatorItem.attributeIdentifier===e:void 0));if((0,v.Z)(n))return;const s=k(n)&&n.attributeLocatorItem.element===o.header?.attributeHeaderItem?.uri,a=H(n)&&(0,r.isResultTotalHeader)(o.header)&&n.totalLocatorItem.totalFunction===o.header?.totalHeaderItem?.name;if(s||a)if(o.measureDescriptors){const e=t.filter(S);if(o.measureDescriptors?.length!==e.length||!S(e[0]))return;i=o}else if(1===t.length)i=o;else{const e=t.filter((e=>e!==n));i=Oi(o.children,e)}}else if(pe(o)){if(t.length>1||!S(t[0]))return;Me(o)===t[0].measureLocatorItem.measureIdentifier&&(i=o)}if(i)return i}}function Bi(e,t){let i;for(const o of e){if(o.seriesDescriptor?.length!==t.length||!S(t[0]))return;if(Me(o)===t[0].measureLocatorItem.measureIdentifier&&(i=o),i)return i}}var Zi=i(96446);function Ui(e,t){return(0,r.isMeasureSort)(t)&&(0,r.sortMeasureLocators)(t).every((t=>(0,r.isAttributeLocator)(t)?function(e,t){const{attributeDescriptors:i,attributeHeaders:o}=e.seriesDescriptor,{attributeIdentifier:n,element:r}=t.attributeLocatorItem;if(!i||!o)return!1;const a=i.findIndex((e=>e.attributeHeader.localIdentifier===n));return-1!==a&&((0,s.kG)(o[a]),o[a]?.attributeHeaderItem?.uri===r)}(e,t):(0,r.isMeasureLocator)(t)?function(e,t){const{measureDescriptor:i}=e.seriesDescriptor,{measureIdentifier:o}=t.measureLocatorItem;return i.measureHeaderItem.localIdentifier===o}(e,t):void 0))}const ji="left";function Vi({displayText:e,className:t,textAlign:i=ji}){const n=c(ae,"gd-pivot-table-header-label",{"gd-pivot-table-header-label--right":"right"===i,"gd-pivot-table-header-label--center":"center"===i});return(0,o.jsx)("div",{className:c("gd-pivot-table-header",t),children:(0,o.jsx)("div",{className:n,children:(0,o.jsx)("span",{children:e||""})})})}function _i(e){return(0,o.jsx)(Vi,{className:"gd-pivot-table-column-total-group-header s-pivot-table-column-total-group-header",textAlign:ji,displayText:e.displayName})}function $i(e,t){const i=e.findIndex((e=>t(e))),o=e[i];return o?{sort:(0,r.sortDirection)(o),sortIndex:i}:{}}const Ki=["desc","asc"],qi=["asc","desc"];function Xi(e,t,i){const o=Ji(e.children,t,i),n=(0,Hi.U)((0,a.getMappingHeaderFormattedName)(e.header),t.emptyHeaderTitle);if(0===o.length){const o=(0,r.isResultTotalHeader)(e.header)?function(e,t,i){return e.headersToHere.some((e=>(0,r.isResultTotalHeader)(e)))?"":t?.formatMessage(Qt.s[i])}(e,i,n):n,s={type:K,colId:e.id,field:e.id,headerName:o,headerTooltip:o};return t.allColDefs.push(s),t.leafColDefs.push(s),s}{let s;if((0,r.isResultTotalHeader)(e.header)){const t=e.isTotal,a=e.headersToHere.some((e=>(0,r.isResultTotalHeader)(e)))?"":i.formatMessage(Qt.s[n]);s={type:t?te:ie,colId:e.id,headerName:a,headerTooltip:a,children:o,headerGroupComponent:_i}}else s={groupId:e.id,headerName:n,headerTooltip:n,children:o};return t.allColDefs.push(s),s}}function Ji(e,t,i){const o=[];for(const n of e)switch(n.type){case"rootCol":{const e=n.groupingAttributes.map((e=>e.attributeHeader.formOf.name)).join(oe),s={groupId:de,children:Ji(n.children,t,i),headerName:e,headerTooltip:e};o.push(s),t.allColDefs.push(s);break}case"scopeCol":o.push(Xi(n,t,i));break;case"seriesCol":{const e=$i(t.initialSorts,(e=>Ui(n,e))),i=n.seriesDescriptor.measureTitle(),s=n.seriesDescriptor.isTotal,r=n.seriesDescriptor.isSubtotal,a={type:s?te:r?ie:q,colId:n.id,field:n.id,headerName:i,headerTooltip:i,...e,sortingOrder:"asc"===e.sort?qi:Ki};o.push(a),t.leafColDefs.push(a),t.allColDefs.push(a);break}}return o}function Qi(e,t,i,o,n,s){const a={initialSorts:t,rootColDefs:[],allColDefs:[],leafColDefs:[],rowColDefs:[],emptyHeaderTitle:i};!function(e,t,i){for(const t of e){const e=$i(i.initialSorts,(e=>{return i=t,o=e,(0,r.isAttributeSort)(o)&&i.attributeDescriptor.attributeHeader.localIdentifier===o.attributeSortItem.attributeIdentifier;var i,o})),o=t.attributeDescriptor.attributeHeader.formOf.name,n={type:$,colId:t.id,field:t.id,headerName:o,headerTooltip:o,...e,sortingOrder:"desc"===e.sort?Ki:qi};i.rowColDefs.push(n),i.allColDefs.push(n)}for(const e of t){const t={type:X,colId:e.id,field:e.id,headerName:"",headerTooltip:void 0};i.rowColDefs.push(t),i.allColDefs.push(t)}}(e.sliceCols,e.sliceMeasureCols,a),function(e,t,i){const o=Ji(e.rootDataCols,t,i);t.rootColDefs.push(...o)}(e,a,s),"left"===n?.columnHeadersPosition&&function(e,t,i){for(const o of e)if(i){const e={type:J,colId:o.id,field:o.id,headerName:"",headerTooltip:void 0};t.rowColDefs.push(e),t.allColDefs.push(e)}}(e.mixedHeadersCols,a,o),function(e,t){for(const i of e){const e={type:Q,colId:i.id,field:i.id,headerName:"",headerTooltip:void 0};t.rowColDefs.push(e),t.allColDefs.push(e)}}(e.mixedValuesCols,a);const l={};return a.allColDefs.forEach((e=>l[De(e)]=e)),{sliceColDefs:a.rowColDefs,rootDataColDefs:a.rootColDefs,leafDataColDefs:a.leafColDefs,idToColDef:l}}function Yi(e,t,i){(0,s.kG)(t.length>0);const o=void 0===i?t.length:i,n=function(e){return{type:"rootCol",id:"root",fullIndexPathToHere:[0],children:[],groupingAttributes:e}}(t),l=(0,Zi.Z)(o).map((e=>({pkToGroup:{},groups:[]}))),u=[...e,n];let d=0;for(const t of e){const{attributeHeaders:e,attributeDescriptors:i}=pe(c=t)?((0,s.kG)(c.seriesDescriptor.attributeHeaders),(0,s.kG)(c.seriesDescriptor.attributeDescriptors),{attributeHeaders:c.seriesDescriptor.attributeHeaders,attributeDescriptors:c.seriesDescriptor.attributeDescriptors}):{attributeHeaders:c.headersToHere,attributeDescriptors:c.descriptorsToHere};(0,s.kG)(void 0!==e),(0,s.kG)(void 0!==i);let h=n,m="";for(let t=0;t<o;t++){const o=e[t];m+=(0,r.isResultTotalHeader)(o)?o?.totalHeaderItem?.type:o?.attributeHeaderItem?.uri;const n=l[t];let s=n.pkToGroup[m];const{isTotal:c,isSubtotal:g}=(0,a.getTotalInfo)(e);if(!s){const o=h?[...h.fullIndexPathToHere,h.children.length]:[n.groups.length];s={type:"scopeCol",id:"g_"+d++,attributeDescriptor:i[t],header:e[t],descriptorsToHere:i.slice(0,t),headersToHere:e.slice(0,t),children:[],fullIndexPathToHere:o,isTotal:c,isSubtotal:g},n.pkToGroup[m]=s,n.groups.push(s),u.push(s),h&&h.children.push(s)}h=s}(0,s.kG)(void 0!==h),t.fullIndexPathToHere=[...h.fullIndexPathToHere,h.children.length],h.children.push(t)}var c;return{groupingAttributes:t,rootColumns:[n],allColumns:u,leafColumns:e}}function eo(e,t){const i=e.meta().attributeDescriptorsForDim(1),o=e.meta().attributeHeadersForDim(1),n=o[0]?.length??0,r=i.length;if(0===r)return{groupingAttributes:[],leafColumns:[],rootColumns:[],allColumns:[]};(0,s.kG)(i.length===o.length);const l=[],u=Ze(e);for(let e=0;e<n;e++){const n=o.map((t=>t[e])),{isTotal:s,isSubtotal:d}=(0,a.getTotalInfo)(n);l.push({type:"scopeCol",id:`cg_${e}`,children:[],fullIndexPathToHere:[e],header:o[r-1][e],headersToHere:o.slice(0,r-1).map((t=>t[e])),attributeDescriptor:i[r-1],descriptorsToHere:i.slice(0,r-1),isTotal:s,isSubtotal:d,...t?{measureDescriptors:u.map((e=>e.measureDescriptor))}:{}})}return Yi(l,i,r-1)}function to(e,t){return{type:"sliceCol",id:`r_${t}`,index:t,attributeDescriptor:e,fullIndexPathToHere:[t],effectiveTotals:e.attributeHeader.totalItems??[]}}function io(e){return e.definition.dimensions.findIndex((e=>e.itemIdentifiers.includes(r.MeasureGroupIdentifier)))}function oo(e,t,i){const o={};if("left"===i?.columnHeadersPosition&&t){const t=[{type:"mixedHeadersCol",id:"amh_0",index:0,fullIndexPathToHere:[0]}],i=function(e){return e.data().slices().toArray().map(((e,t)=>{const i=e.descriptor.headers,{isTotal:o,isSubtotal:n}=(0,a.getTotalInfo)(i);return{type:"mixedValuesCol",id:`amv_${t}`,index:t,fullIndexPathToHere:[t],isTotal:o,isSubtotal:n}}))}(e);t.forEach((e=>o[e.id]=e)),i.forEach((e=>o[e.id]=e));const n=e.data().slices().descriptors??[];return{sliceCols:[],sliceMeasureCols:[],rootDataCols:[],leafDataCols:[],mixedHeadersCols:t,mixedValuesCols:i,idToDescriptor:o,scopingAttributes:n.filter(r.isAttributeDescriptor)}}{const n=function(e){return 0===io(e)?e.meta().attributeDescriptorsForDim(0).map(to):e.data().slices().descriptors.filter(r.isAttributeDescriptor).map(to)}(e),s=function(e,t){if(0!==io(e))return[];const i=t.length;return[{type:"sliceMeasureCol",id:`r_${i}`,index:i,fullIndexPathToHere:[i],seriesDescriptor:Ze(e)}]}(e,n);let a=[];"left"===i?.columnHeadersPosition&&(a=[{type:"mixedHeadersCol",id:"amh_0",index:0,fullIndexPathToHere:[0]}]);const{rootColumns:l,leafColumns:u,allColumns:d,groupingAttributes:c}=function(e,t){return 0===e.meta().measureDescriptors().length&&2===e.meta().dimensions().length?eo(e):0===io(e)?eo(e,t):function(e){const t=e.data().series().toArray().map(((e,t)=>({type:"seriesCol",id:`c_${t}`,index:t,seriesId:e.id,seriesDescriptor:e.descriptor,children:[],fullIndexPathToHere:[t]}))),i=e.data().series().scopingAttributes??[];return 0===i.length?{groupingAttributes:[],leafColumns:t,rootColumns:t,allColumns:t}:Yi(t,i)}(e)}(e,t);n.forEach((e=>o[e.id]=e)),s.forEach((e=>o[e.id]=e));const h=s.length>0&&0===c.length?function(e){return[{type:"mixedValuesCol",id:"amv_0",index:0,fullIndexPathToHere:[0],seriesDescriptor:Ze(e)}]}(e):[];return h.forEach((e=>o[e.id]=e)),a.forEach((e=>o[e.id]=e)),d.forEach((e=>o[e.id]=e)),{sliceCols:n,sliceMeasureCols:s,rootDataCols:l,leafDataCols:u,mixedHeadersCols:a,mixedValuesCols:h,idToDescriptor:o,scopingAttributes:c}}}class no{dv;headers;colDefs;zippedSliceCols=[];zippedLeaves=[];_seriesColsCount;constructor(e,t,i){this.dv=e,this.headers=t,this.colDefs=i,this._initializeZippedLeaves(),this._initializeZippedSliceCols(),this._seriesColsCount=t.leafDataCols.filter(pe).length}static _getMeasureGroupDimensionIndex(e){return e.definition.dimensions.findIndex((e=>e.itemIdentifiers.includes(r.MeasureGroupIdentifier)))}static for(e,t,i,o){const n=no.isTransposed(e),{headers:r,colDefs:a}=function(e,t,i,o,n){const s=oo(e,i,o);return{headers:s,colDefs:Qi(s,e.meta().effectiveSortItems(),t,i,o,n)}}(e,t,n,i,o);return(0,s.kG)(r.leafDataCols.length===a.leafDataColDefs.length),new no(e,r,a)}static isTransposed(e){return 0===no._getMeasureGroupDimensionIndex(e)}_initializeZippedLeaves(){this.headers.leafDataCols.forEach(((e,t)=>{this.zippedLeaves.push([e,this.colDefs.leafDataColDefs[t]])}))}_zipOneCol(e){const t=this.colDefs.sliceColDefs.find((t=>t.colId===e.id));if(void 0===t)throw Error(`No definition for column ${e.id}`);return[e,t]}_initializeZippedSliceCols(){this.headers.sliceCols.forEach((e=>{this.zippedSliceCols.push(this._zipOneCol(e))})),this.headers.sliceMeasureCols.forEach((e=>{this.zippedSliceCols.push(this._zipOneCol(e))})),this.headers.mixedValuesCols.forEach((e=>{this.zippedSliceCols.push(this._zipOneCol(e))}))}getCol(e){(0,s.kG)(e,"id of column or Column, ColDef or ColGroupDef must be provided");const t=De(e),i=this.headers.idToDescriptor[t];return(0,s.kG)(i,`no column with id ${t}`),i}getColDef(e){(0,s.kG)(e,"id of column or Column, ColDef or ColGroupDef must be provided");const t=De(e),i=this.colDefs.idToColDef[t];return(0,s.kG)(i,`no column with id ${t}`),i}getScopingAttributes(){return this.headers.scopingAttributes}getSlicingAttributes(){return this.headers.sliceCols.map((e=>e.attributeDescriptor))}sliceColCount(){return this.headers.sliceCols.length}sliceMeasureColCount(){return this.headers.sliceMeasureCols.length}isTransposed(){return no.isTransposed(this.dv)}mixedHeadersColsCount(){return this.headers.mixedHeadersCols.length}scopingColCount(){return this.headers.scopingAttributes.length}getMeasures(){return this.dv.meta().measureDescriptors()}seriesColsCount(){return this._seriesColsCount}isFirstCol(e){(0,s.kG)(e,"id of column or Column, ColDef or ColGroupDef must be provided");const t=De(e);return this.headers.sliceCols.length>0?this.headers.sliceCols[0].id===t:0===this.headers.sliceCols.length&&this.headers.sliceMeasureCols.length>0?this.headers.sliceMeasureCols[0].id===t:this.headers.mixedHeadersCols.length>0?this.headers.mixedHeadersCols[0].id===t:this.isFirstDataCol(t)}isFirstDataCol(e){(0,s.kG)(e,"id of column or Column, ColDef or ColGroupDef must be provided");const t=this.getCol(e);switch(t.type){case"seriesCol":case"scopeCol":return t.fullIndexPathToHere.every((e=>0===e));case"rootCol":return!0;default:return!1}}hasScopingCols(){const e=this.headers.rootDataCols[0];return e&&(fe(e)||be(e))}hasDataLeafCols(){return this.headers.leafDataCols.length>0}hasHeadersOnLeft(){return this.headers.mixedHeadersCols.length>0}getAbsoluteLeafColIndex(e){return ce(e)||he(e)||me(e)?e.index:fe(e)?((0,s.kG)(Ce(e)),this.sliceColCount()+this.sliceMeasureColCount()+this.headers.leafDataCols.findIndex((t=>t.id===e.id))):this.sliceColCount()+this.sliceMeasureColCount()+this.mixedHeadersColsCount()+e.index}matchAttributeWidthItem(e){const t=(i=e.attributeColumnWidthItem.attributeIdentifier,e=>i===e.attributeHeader.localIdentifier);var i;return this.headers.sliceCols.find((e=>t(e.attributeDescriptor)))}matchMeasureWidthItem(e){return Oi(this.headers.rootDataCols,e.measureColumnWidthItem.locators)}matchSliceMeasureWidthItem(e){return Bi(this.headers.sliceMeasureCols,e.sliceMeasureColumnWidthItem.locators)}matchMixedValuesWidthItem(e){return Bi(this.headers.mixedValuesCols,e.mixedValuesColumnWidthItem.locators)}canTableHaveRowTotals(){return this.sliceColCount()>0&&(this.seriesColsCount()>0||this.sliceMeasureColCount()>0)}canTableHaveColumnTotals(){return this.scopingColCount()>0&&(this.seriesColsCount()>0||this.sliceMeasureColCount()>0||this.mixedHeadersColsCount()>0)}getGrandTotalCol(){const e=this.headers.sliceCols[0];return(0,s.kG)(e),e}getSliceColsUpToIncludingCol(e){const t=this.headers.sliceCols;if(!ce(e))return t;const i=t.findIndex((t=>t.id===e.id));return(0,s.kG)(i>-1),t.slice(0,i+1)}createSortItems(e,t=[]){if(0===e.length)return[];const i=function(e){return ve(e[0])?function(e){return e.filter((e=>void 0!==e.getSort()&&null!==e.getSort())).map((e=>({colId:e.getColId(),sort:e.getSort()})))}(e):e.filter((e=>void 0!==e.sort&&null!==e.sort)).map((e=>({colId:e.colId,sort:e.sort})))}(e);return i.map((e=>{const{colId:i,sort:o}=e;return function(e,t,i=[]){if(ce(e)){const o=e.attributeDescriptor.attributeHeader.localIdentifier,n=i.find((e=>(0,r.isAttributeSort)(e)&&e.attributeSortItem.attributeIdentifier===o));return(0,r.isAttributeAreaSort)(n)?(0,r.newAttributeAreaSort)(o,t):(0,r.newAttributeSort)(o,t)}if(pe(e)){const i=[];return e.seriesDescriptor.attributeDescriptors&&e.seriesDescriptor.attributeHeaders&&(0,Se.Z)(e.seriesDescriptor.attributeDescriptors,e.seriesDescriptor.attributeHeaders).forEach((([e,t])=>i.push(function(e,t){return(0,s.kG)(e&&t),{attributeLocatorItem:{attributeIdentifier:e.attributeHeader.localIdentifier,element:t.attributeHeaderItem.uri}}}(e,t)))),i.push({measureLocatorItem:{measureIdentifier:e.seriesDescriptor.measureDescriptor.measureHeaderItem.localIdentifier}}),{measureSortItem:{direction:t,locators:i}}}throw new s.ej(`cannot get sort item for the column type ${e.type}`)}(this.getCol(i),o,t)}))}updateEffectiveTotals(e){const t=(0,Ni.Z)(e.meta().attributeDescriptors(),(e=>e.attributeHeader.localIdentifier));this.headers.sliceCols.forEach((e=>function(e,t){const i=e.attributeDescriptor.attributeHeader.localIdentifier,o=t[i];(0,s.kG)(o,`attempting to refresh attribute descriptors for different table. attribute with local id ${i} not found`),e.effectiveTotals=o.attributeHeader.totalItems??[]}(e,t)))}}class so{config;initialDv;gridApiProvider;intl;getCurrentAbortController;rowCount;destroyed=!1;currentResult;currentSorts;grouping;constructor(e,t,i,o,n){this.config=e,this.initialDv=t,this.gridApiProvider=i,this.intl=o,this.getCurrentAbortController=n,this.currentResult=t.result(),this.currentSorts=t.meta().effectiveSortItems();const s=function(e){const{sortBy:t}=e.definition;if(!t?.length)return!0;if(t.length>1)return!1;const i=t[0];if(!(0,r.isAttributeSort)(i))return!1;const o=e.def().bucket(a.BucketNames.ATTRIBUTE);if(!o)return!1;const n=(0,r.bucketAttribute)(o);return!!n&&i.attributeSortItem.attributeIdentifier===(0,r.attributeLocalId)(n)}(t);this.grouping=this.createGroupingProvider(s)}createGroupingProvider=e=>{const t=this.config.getGroupRows()&&e;return Pi.createProvider(t)};resetGroupingProvider=(e=[])=>{const t=(i=this.config.tableDescriptor,!(o=e).length||!(o.length>1)&&i.isFirstCol(o[0].colId));var i,o;this.grouping=this.createGroupingProvider(t)};onDestroy=()=>{};processData=(e,t)=>{if(!e)return;const{successCallback:i}=t,o=Gi(e,this.config.tableDescriptor,this.intl),{rowData:n,rowTotals:s}=o,{offset:r,count:a,totalCount:l}=e.dataView,u=this.config.tableDescriptor.headers.sliceCols.map((e=>e.id));this.grouping.processPage(n,r[0],u);const d="left"===this.config.getColumnHeadersPosition()?n.length:l[0],c=0===this.config.tableDescriptor.getMeasures().length&&0===u.length,h=0===r[0]&&0===a[0]||c?0:d;this.config.onPageLoaded(e),i(n,h),this.gridApiProvider()?.refreshCells({force:!0,suppressFlash:!0}),function(e,t){const i=t??[],o=e?.getPinnedBottomRowCount()??0;if(o!==(t?.length??0))return!0;for(let t=0;t<o;t++)if(!(0,m.Z)(e?.getPinnedBottomRow(t)?.data,i[t]))return!0;return!1}(this.gridApiProvider(),s)&&this.gridApiProvider()?.updateGridOptions({pinnedBottomRowData:s})};transformResult=(e,t,i,o)=>{const{sortModel:n}=e,s=this.currentResult,l=s.definition;this.gridApiProvider()?.refreshHeader(),this.resetGroupingProvider(n);const u=this.getCurrentAbortController();let d=(u?s.withSignal(u.signal):s).transform().withSorting(...t??[]).withDimensions((0,r.dimensionSetTotals)(l.dimensions[0],i),(0,r.dimensionSetTotals)(l.dimensions[1],o));const c=(0,r.bucketsFind)(l.buckets,a.BucketNames.COLUMNS),h=(0,r.bucketsFind)(l.buckets,a.BucketNames.ATTRIBUTE);(o.length>0||o&&void 0!==c?.totals)&&(d=h?d.withBuckets(l.buckets[0],(0,r.bucketSetTotals)(l.buckets[1],i),(0,r.bucketSetTotals)(l.buckets[2],o)):d.withBuckets(l.buckets[0],(0,r.bucketSetTotals)(l.buckets[1],o))),this.config.onExecutionTransformed(d),this.driveExecutionAndUpdateDatasource(d,e)};driveExecutionAndUpdateDatasource=(e,t)=>{const{startRow:i,endRow:o,failCallback:n}=t;let s=e;const r=this.getCurrentAbortController();r&&(s=e.withSignal(r.signal)),s.execute().then((e=>{this.currentResult=e,e.readWindow([i,0],[o-i,se]).then((e=>{const i=this.config.dataViewTransform(e),o=a.DataViewFacade.for(i);this.gridApiProvider()?.setRowCount(i.totalCount[0]),this.currentSorts=o.meta().effectiveSortItems();const n=(0,a.emptyHeaderTitleFromIntl)(this.intl);this.config.tableDescriptor=no.for(o,n,{columnHeadersPosition:this.config.tableDescriptor.hasHeadersOnLeft()?"left":"top"},this.intl),this.processData(o,t)})).catch((e=>{this.config.onTransformedExecutionFailed(),console.error("Error while doing execution to obtain data view",e),n()}))})).catch((e=>{this.config.onTransformedExecutionFailed(),console.error("Error while doing execution to obtain transformed results",e),n()}))};destroy=()=>{this.destroyed||(this.destroyed=!0,this.onDestroy())};getRows=e=>{const{startRow:t,endRow:i,failCallback:o,sortModel:n}=e;if(function(e,t){const i=t?function(e){return e.getDisplayedRowCount()-1}(t):null;return null!==i&&e>i}(t,this.gridApiProvider()))return void o();const s=this.currentResult,l=s.definition,u=this.config.tableDescriptor.createSortItems(n??[],s.definition.sortBy),d=(0,r.defTotals)(l,0),c=this.config.getColumnTotals(),h=(0,r.defTotals)(l,1),g=this.config.getRowTotals();(0,m.Z)(this.currentSorts,u)&&(0,m.Z)(d,c)&&(0,m.Z)(h,g)?t||s.definition!==this.initialDv.definition?s.readWindow([t,0],[i-t,se]).then((t=>{const i=this.config.dataViewTransform(t);this.processData(a.DataViewFacade.for(i),e)})).catch((e=>{console.error("Error while doing execution to obtain data view",e),o()})):this.processData(this.initialDv,e):setTimeout((()=>{this.transformResult(e,u,c,g)}),100)};getGroupingProvider=()=>this.grouping}class ro{getCurrentAbortController;intl;tableDescriptor;resizedColumnsStore;originalExecution;config;transformedExecution;currentResult;visibleData;currentFingerprint;autoResizedColumns;growToFittedColumns;resizing;numberOfColumnResizedCalls;agGridDataSource;gridApi;columnApi;destroyed=!1;onPageLoadedCallback;onExecutionTransformedCallback;constructor(e,t,i,o,n){this.getCurrentAbortController=n,this.intl=o.intl,this.currentResult=e,this.visibleData=a.DataViewFacade.for(t),this.currentFingerprint=(0,r.defFingerprint)(this.currentResult.definition),this.tableDescriptor=no.for(this.visibleData,(0,a.emptyHeaderTitleFromIntl)(o.intl),o.config,o.intl),this.autoResizedColumns={},this.growToFittedColumns={},this.resizing=!1,this.resizedColumnsStore=new Ke(this.tableDescriptor),this.numberOfColumnResizedCalls=0,this.agGridDataSource=this.createDataSource(i),this.onExecutionTransformedCallback=i.onExecutionTransformed,this.updateColumnWidths(i.getResizingConfig()),this.originalExecution=o.execution,this.config=o.config}finishInitialization=(e,t)=>{(0,s.kG)(void 0===this.gridApi),(0,s.kG)(this.agGridDataSource),this.gridApi=e,this.columnApi=t,this.gridApi.updateGridOptions({datasource:this.agGridDataSource})};refreshData=()=>{const e=this.gridApiGuard();e&&e.updateGridOptions({datasource:this.agGridDataSource})};destroy=()=>{this.gridApi=void 0,this.columnApi=void 0,this.destroyed=!0};isFullyInitialized=()=>void 0!==this.gridApi;isTransforming=()=>void 0!==this.transformedExecution;clearFittedColumns=()=>{this.growToFittedColumns={}};gridApiGuard=()=>{if(!this.destroyed)return this.gridApi;console.debug("Attempting to obtain gridApi for a destructed table.")};updateColumnWidths=e=>{this.resizedColumnsStore.updateColumnWidths(e.widths),function(e,t,i,o,n,s={}){const r=e.zippedSliceCols,a=e.zippedLeaves,l=[];l.push(...r),l.push(...a),l.forEach((([e,r])=>{const a=e.id,l=t.getManuallyResizedColumn2(e),u=i[a];if(r.maxWidth=je,l)r.width=l.width,r.suppressSizeToFit=!l.allowGrowToFit;else if(r.suppressSizeToFit=!1,r.width=u?u.width:o,n){const e=s[a];e&&(r.width=e.width,e.width>je&&(r.maxWidth=void 0))}}))}(this.tableDescriptor,this.resizedColumnsStore,this.autoResizedColumns,e.defaultWidth,e.growToFit,this.growToFittedColumns)};createDataSource=e=>{return this.onPageLoadedCallback=e.onPageLoaded,t={tableDescriptor:this.tableDescriptor,getGroupRows:e.getGroupRows,getColumnTotals:e.getColumnTotals,getRowTotals:e.getRowTotals,getColumnHeadersPosition:e.getColumnHeadersPosition,onPageLoaded:this.onPageLoaded,onExecutionTransformed:this.onExecutionTransformed,onTransformedExecutionFailed:this.onTransformedExecutionFailed,dataViewTransform:Ri.Z},i=this.visibleData,o=this.gridApiGuard,n=this.intl,s=this.getCurrentAbortController,new so(t,i,o,n,s);var t,i,o,n,s};onExecutionTransformed=e=>{console.debug("onExecutionTransformed",e.definition),this.transformedExecution=e,this.onExecutionTransformedCallback?.(e)};onTransformedExecutionFailed=()=>{this.transformedExecution=void 0};onPageLoaded=e=>{const t=this.currentResult;this.transformedExecution=void 0,this.currentResult=e.result(),this.visibleData=e,this.currentFingerprint=(0,r.defFingerprint)(this.currentResult.definition),this.onPageLoadedCallback?.(e,!t?.equals(this.currentResult))};createExportFunction=e=>(0,a.createExportFunction)(this.currentResult,e);getAvailableDrillTargets=()=>Ii(this.visibleData,this.config?.measureGroupDimension,this.config?.columnHeadersPosition);refreshHeader=()=>{const e=this.gridApiGuard();e&&e.refreshHeader()};growToFit=e=>{if(!this.gridApiGuard())return;(0,s.kG)(this.columnApi);const t=this.columnApi.getAllGridColumns();if((0,s.kG)(t),this.resetColumnsWidthToDefault(e,t),this.clearFittedColumns(),t.map((e=>e.getActualWidth())).reduce(((e,t)=>e+t),0)<e.clientWidth){const i=Ie(t);Si(this.columnApi,i,void 0),this.sizeColumnsToFitWithoutColumnReset(e),ki(this.columnApi,i,je,(e=>e.getActualWidth()<=je)),this.setFittedColumns()}};setFittedColumns=()=>{(0,s.kG)(this.columnApi);const e=this.columnApi.getAllGridColumns();(0,s.kG)(e),e.forEach((e=>{const t=De(e);this.growToFittedColumns[t]={width:e.getActualWidth()}}))};resetColumnsWidthToDefault=(e,t)=>{(0,s.kG)(this.columnApi),function(e,t,i,o,n){const s=t.reduce(((e,t)=>{const s=De(t);if(i.isColumnManuallyResized(t)){const o=i.getManuallyResizedColumn(t);o&&e.push({key:t,newWidth:o.width})}else Xe(o,s)?e.push({key:t,newWidth:o[s].width}):e.push({key:t,newWidth:n});return e}),[]);e.setColumnWidths(s)}(this.columnApi,t,this.resizedColumnsStore,this.autoResizedColumns,e.defaultWidth)};applyColumnSizes=e=>{if((0,s.kG)(this.columnApi),this.resizedColumnsStore.updateColumnWidths(e.widths),function(e,t){if(!t)return;const i=t.getAllGridColumns();i?.forEach((t=>{const i=e.getManuallyResizedColumn(t);t.getColDef().suppressSizeToFit=!!i&&!i.allowGrowToFit}))}(this.resizedColumnsStore,this.columnApi),e.growToFit)this.growToFit(e);else{const t=this.columnApi.getAllGridColumns();(0,s.kG)(t),this.resetColumnsWidthToDefault(e,t)}};autoresizeColumns=async(e,t=!1)=>{if(!this.gridApiGuard())return!1;if((0,s.kG)(this.columnApi),this.resizing&&!t)return!1;const i=()=>this.resizing;if(this.isPivotTableReady()&&(!i()||i()&&t)){if(this.resizing=!0,await this.autoresizeAllColumns(e),e.growToFit)this.growToFit(e);else if(at(e.columnAutoresizeOption)&&this.shouldPerformAutoresize()){const t=this.columnApi.getAllGridColumns();(0,s.kG)(t),this.resetColumnsWidthToDefault(e,t)}return this.resizing=!1,!0}return!1};autoresizeAllColumns=async e=>{if(this.gridApiGuard()){if((0,s.kG)(this.columnApi),!this.shouldPerformAutoresize()||!at(e.columnAutoresizeOption))return Promise.resolve();await Fe(300),this.updateAutoResizedColumns(e),await async function(e,t){if(e){const i=function(e,t,i){t=(i?(0,x.Z)(e,t,i):void 0===t)?1:y((0,I.Z)(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var n=0,s=0,r=Array(R(o/t));n<o;)r[s++]=(0,T.Z)(e,n,n+=t);return r}(e.getAllGridColumns().filter((e=>e.isPrimary())),50);for(const o of i)await new Promise((i=>{setTimeout((()=>{const n=o.reduce(((e,i)=>{const o=De(i.getColDef()),n=t[o];return o&&n?.width&&e.push({key:o,newWidth:n.width}),e}),[]);e.setColumnWidths(n),i()}))}))}}(this.columnApi,this.autoResizedColumns)}};updateAutoResizedColumns=e=>{const t=this.gridApiGuard();t&&((0,s.kG)(this.columnApi),(0,s.kG)(e.containerRef),this.autoResizedColumns=rt(this.tableDescriptor,t,this.columnApi,this.currentResult,e,this.resizedColumnsStore,{measureHeaders:!0,padding:25,separators:e.separators},this.getGroupingProvider()))};getRowNodes=()=>{const e=this.gridApiGuard();if(!e)return[];const t=[];return e.forEachNode((e=>t.push(e.data))),t};isPivotTableReady=()=>{if(!this.gridApi||this.destroyed)return!1;const e=this.gridApi;return(()=>{const t=e.getCacheBlockState();return t&&Object.keys(t).every((e=>"loaded"===t[e].pageStatus||"failed"===t[e].pageStatus))})()&&((()=>Boolean(this.visibleData.rawData().isEmpty()&&this.visibleData.meta().hasNoHeadersInDim(0)))()||e.getRenderedNodes().length>0)};shouldPerformAutoresize=()=>{const e=this.gridApiGuard();if(!e)return!1;const t=e.getHorizontalPixelRange(),i=e.getVerticalPixelRange();return 0===t.left&&0===i.top};isColumnAutoResized=e=>Xe(this.autoResizedColumns,e);resetResizedColumn=async e=>{if(!this.tableDescriptor)return;const t=De(e);this.resizedColumnsStore.isColumnManuallyResized(e)&&this.resizedColumnsStore.removeFromManuallyResizedColumn(e),e.getColDef().suppressSizeToFit=!1,this.isColumnAutoResized(t)?this.columnApi?.setColumnWidths([{key:e,newWidth:this.autoResizedColumns[t].width}]):(this.autoresizeColumnsByColumnId(this.columnApi,Ie([e])),this.resizedColumnsStore.addToManuallyResizedColumn(e,!0))};autoresizeColumnsByColumnId=(e,t)=>{Si(e,t,Ve),e.autoSizeColumns(t),Si(e,t,je)};onColumnsManualReset=async(e,t)=>{if(!this.gridApiGuard())return;(0,s.kG)(this.columnApi);let i=t;this.isAllMeasureOrAnyColumnTotalResizeOperation(e,t)&&(this.resizedColumnsStore.removeAllMeasureColumns(),i=this.getAllMeasureOrAnyTotalColumns()),this.isWeakMeasureResizeOperation(e,t)&&(i=this.resizedColumnsStore.getMatchingColumnsByMeasure(t[0],this.getAllMeasureColumns()),this.resizedColumnsStore.removeWeakMeasureColumn(t[0]));for(const e of i)await this.resetResizedColumn(e);this.afterOnResizeColumns(e)};getAllMeasureOrAnyTotalColumns=()=>{(0,s.kG)(this.columnApi);const e=this.columnApi.getAllGridColumns();return(0,s.kG)(e),e.filter((e=>xe(e)))};getAllMeasureColumns=()=>{(0,s.kG)(this.columnApi);const e=this.columnApi.getAllGridColumns();return(0,s.kG)(e),e.filter((e=>Te(e)))};isAllMeasureOrAnyColumnTotalResizeOperation(e,t){return e.isMetaOrCtrlKeyPressed&&1===t.length&&xe(t[0])}isWeakMeasureResizeOperation(e,t){return e.isAltKeyPressed&&1===t.length&&Te(t[0])}sizeColumnsToFitWithoutColumnReset(e){(0,s.kG)(this.columnApi);const t=this.columnApi,i=e.clientWidth,o=this.columnApi?.getAllDisplayedColumns();if(i<=0||!o.length)return;let n=[];const r=[];o.forEach((function(e){!0===e.getColDef().suppressSizeToFit?r.push(e):n.push(e)}));let a=!1;function l(e){n=n.filter((t=>t!=e)),r.push(e)}const u=[];for(;!a;){a=!0;const e=i-this.getWidthOfColsInList(r);if(e<=0)n.forEach((function(e){const t=e.getMinWidth();u.push({key:e,newWidth:t})}));else{const t=e/this.getWidthOfColsInList(n);let i=e;for(let e=n.length-1;e>=0;e--){const o=n[e],s=Math.round(o.getActualWidth()*t);if(s<o.getMinWidth()){const e=o.getMinWidth();u.push({key:o,newWidth:e}),l(o),a=!1}else o.isGreaterThanMax(s)?(u.push({key:o,newWidth:o.getMaxWidth()}),l(o),a=!1):0===e?u.push({key:o,newWidth:i}):u.push({key:o,newWidth:s});i-=s}}}setTimeout((()=>{t.setColumnWidths(u,!0,"sizeColumnsToFit"),t.refreshCells()}))}getWidthOfColsInList(e){return e.reduce(((e,t)=>e+t.getActualWidth()),0)}onColumnsManualResized=(e,t)=>{this.isAllMeasureOrAnyColumnTotalResizeOperation(e,t)?function(e,t,i){const o=i.getActualWidth(),n=e.getAllGridColumns(),s=n?.filter(xe).map((e=>({key:e,newWidth:o})));s?.length&&e.setColumnWidths(s),t.addAllMeasureColumn(o,n??[])}(this.columnApi,this.resizedColumnsStore,t[0]):this.isWeakMeasureResizeOperation(e,t)?function(e,t,i,o){const n=t.getAllGridColumns();i.addWeekMeasureColumn(o);const s=[];n?.forEach((t=>{const o=e.getCol(t),n=i.getMatchedWeakMeasuresColumnWidth(o);Te(t)&&n&&(s.push({key:t.getColId(),newWidth:n.measureColumnWidthItem.width.value}),t.getColDef().suppressSizeToFit=!0)})),t.setColumnWidths(s)}(this.tableDescriptor,this.columnApi,this.resizedColumnsStore,t[0]):t.forEach((e=>{this.resizedColumnsStore.addToManuallyResizedColumn(e)})),this.afterOnResizeColumns(e)};onManualColumnResize=async(e,t)=>{this.numberOfColumnResizedCalls++,await Fe(300),this.numberOfColumnResizedCalls===M.DOUBLE_CLICK?(this.numberOfColumnResizedCalls=0,await this.onColumnsManualReset(e,t)):this.numberOfColumnResizedCalls===M.CLICK&&(this.numberOfColumnResizedCalls=0,this.onColumnsManualResized(e,t))};afterOnResizeColumns=e=>{e.growToFit&&this.growToFit(e);const t=this.resizedColumnsStore.getColumnWidthsFromMap();e.onColumnResized?.(t)};getGroupingProvider=()=>((0,s.kG)(this.agGridDataSource),this.agGridDataSource.getGroupingProvider());createSortItems=e=>this.tableDescriptor.createSortItems(e,this.currentResult.definition.sortBy);getSortItems=()=>this.currentResult.definition.sortBy;isMatchingExecution(e){if(this.originalExecution.fingerprint()===e.fingerprint())return!0;if(console.debug("Original execution fingerprint does not match."),this.transformedExecution){const t=this.transformedExecution.fingerprint()===e.fingerprint();return t||console.debug("transformed execution does not match",this.transformedExecution.definition,e.definition),t}const t=this.currentFingerprint===e.fingerprint();return t||console.debug("current result does not match",this.currentResult.definition,e.definition),t}getTotalBodyHeight=()=>{const e=this.gridApiGuard();if(!e)return 0;const t=this.visibleData,i=t.rawData().firstDimSize();let o=0;"left"===this.config?.columnHeadersPosition&&this.tableDescriptor.isTransposed()&&(o=t.meta().attributeHeadersForDim(1).length);const n=t.rawData().rowTotals()?.length??0;return Mi.getHeaderHeight(e)+(28*(i+o)+2)+28*n};updateStickyRowContent=e=>{const t=this.gridApiGuard();t&&function(e,t,i,o,n,s){if(!o||!function(e,t,i){const o=0===e.top,n=we(e.top,i)!==we(t.top,i),s=i,r=we(e.left,s),a=we(t.left,s);return o||n||r!==a}(e,t,i))return;const r=we(e.top,i),a=o.getDisplayedRowAtIndex(r),l=a?.data??null;if(null===l)return void s.removePinnedTopRowClass(o,"gd-visible-sticky-row");s.addPinnedTopRowClass(o,"gd-visible-sticky-row");const u=we(t.top,i),d=Object.keys(l).filter((e=>{const t=o.getColumnDef(e);return t?.type===$})),c={},h={};d.forEach((t=>{if(s.removeCellClass(o,t,u,"gd-cell-show-hidden"),n.isRepeatedValue(t,r+1))c[t]=l[t],h[t]=l.headerItemMap[t];else if(n.isColumnWithGrouping(t)){const n=we(e.top,i);s.addCellClass(o,t,n,"gd-cell-show-hidden")}}));const m=o.getPinnedTopRow(0)?.data,{headerItemMap:g,type:p,subtotalStyle:f,...C}=m;if(function(e,t){return Object.keys(e).length!==Object.keys(t).length||Object.keys(e).some((i=>e[i]!==t[i]))}(C,c)){const e=(0,v.Z)(h)?{}:{headerItemMap:h};o.updateGridOptions({pinnedTopRowData:[{...c,...e}]})}}(e.scrollPosition,e.lastScrollPosition,28,t,this.getGroupingProvider(),Mi)};updateStickyRowPosition=()=>{const e=this.gridApiGuard();e&&function(e,t=Mi){if(!e)return;const i=t.getHeaderHeight(e);t.setPinnedTopRowStyles(e,{top:`${i}px`,"padding-right":`${We()}px`})}(e)};initializeStickyRow=()=>{const e=this.gridApiGuard();e&&function(e){e.updateGridOptions({pinnedTopRowData:[]})}(e)};clearStickyRow=()=>{this.initializeStickyRow()};stickyRowExists=()=>{const e=this.gridApiGuard();return!!e&&function(e,t=Mi){return!!t.getPinnedTopRowElement(e)}(e)};getRowCount=()=>"left"===this.config?.columnHeadersPosition&&this.tableDescriptor.isTransposed()?this.visibleData.rawData().firstDimSize()+this.visibleData.meta().attributeHeadersForDim(1).length:this.visibleData.rawData().firstDimSize();isEmpty=()=>this.visibleData.rawData().isEmpty();getDrillDataContext=()=>this.visibleData;isResizing=()=>this.resizing;setTooltipFields=()=>{(0,s.kG)(this.columnApi);const e=this.columnApi.getAllGridColumns();(0,s.kG)(e),e.forEach((e=>{const t=e.getColDef();t.tooltipField=t.field}))}}class ao{execution;tableMethods;props;getCurrentAbortController;abandoned=!1;constructor(e,t,i,o){this.execution=e,this.tableMethods=t,this.props=i,this.getCurrentAbortController=o}abandon=()=>{(0,s.kG)(!this.abandoned),this.abandoned=!0};isSameExecution(e){return this.execution.fingerprint()===e.fingerprint()}initialize=()=>{const{execution:e,tableMethods:t}=this;t.onLoadingChanged({isLoading:!0});let i=e;const o=this.getCurrentAbortController();return o&&(i=e.withSignal(o.signal)),i.execute().then((e=>e.readWindow([0,0],[this.props.pageSize,se]).then((i=>{if(this.abandoned)return;const o=this.createTableFacade(e,i);t.onLoadingChanged({isLoading:!1}),t.onExportReady(o.createExportFunction(this.props.exportTitle));const n=o.getAvailableDrillTargets();return t.pushData({dataView:i,availableDrillTargets:n}),{initializer:this,table:o}})).catch((i=>{if(!this.abandoned){if((0,xi.isUnexpectedResponseError)(i)){const i=Ii(a.DataViewFacade.forResult(e),t.getMeasureGroupDimension(),t.getColumnHeadersPosition());this.props.pushData({availableDrillTargets:i})}if((0,xi.isNoDataError)(i)&&i.dataView){const e=Ii(a.DataViewFacade.for(i.dataView),t.getMeasureGroupDimension(),t.getColumnHeadersPosition());t.pushData({availableDrillTargets:e}),t.onLoadingChanged({isLoading:!1})}t.onLoadingChanged({isLoading:!1}),t.onError((0,a.convertError)(i),this.execution)}})))).catch((e=>{this.abandoned||(t.onLoadingChanged({isLoading:!1}),t.onError((0,a.convertError)(e),this.execution))}))};createTableFacade=(e,t)=>new ro(e,t,this.tableMethods,this.props,this.getCurrentAbortController)}class lo{context;constructor(e){this.context=e}shouldSkipUpdate(){return!this.context.state.readyToRender&&this.context.state.isLoading&&!this.context.executionAbortManager.isEnabled()}isReinitNeeded(e){const t=(0,m.Z)(e.drillableItems,this.context.props.drillableItems),i=(0,m.Z)(e.config?.columnHeadersPosition,this.context.props.config?.columnHeadersPosition);if(!t)return console.debug("drilling is different",e.drillableItems,this.context.props.drillableItems),!0;if(!i)return!0;if(!this.context.internal.table){if(this.context.internal.initializer){const t=this.context.internal.initializer.isSameExecution(this.context.props.execution);return t||console.debug("initializer for different execution",this.context.props.execution,e.execution),!t}{const t=this.context.props.execution.fingerprint()===e.execution.fingerprint();return t||console.debug("have to reinit table",this.context.props.execution,e.execution),!t}}return this.context.executionAbortManager.isEnabled()?e.execution.fingerprint()!==this.context.props.execution.fingerprint():!this.context.internal.table.isMatchingExecution(this.context.props.execution)}shouldRefreshHeader(e){return[e=>e?.config?.menu].some((t=>!(0,m.Z)(t(this.context.props),t(e))))}hasExecutionCancellingChanged(e){return e.config?.enableExecutionCancelling!==this.context.props.config?.enableExecutionCancelling}hasGrowToFitEnabledChanged(e,t){return t()&&!t(e)}hasColumnWidthsChanged(e,t){const i=t(e),o=t(this.context.props);return!(0,m.Z)(i,o)}hasMaxHeightChanged(e){return!!this.context.props.config?.maxHeight&&!(0,m.Z)(this.context.props.config?.maxHeight,e.config?.maxHeight)}logReinitDebug(e){console.debug("triggering reinit",this.context.props.execution.definition,e.definition)}}class uo{initializer;table;gridOptions;firstDataRendered=!1;lastScrollPosition={top:0,left:0};isMetaOrCtrlKeyPressed=!1;isAltKeyPressed=!1;lastResizedWidth=0;lastResizedHeight=0;lastSortedColId=null;watchingIntervalId;destroy=()=>{this.abandonInitialization(),this.stopWatching(),this.table?.destroy()};abandonInitialization=()=>{this.initializer&&this.initializer.abandon(),this.initializer=void 0};stopWatching=()=>{this.watchingIntervalId&&(clearInterval(this.watchingIntervalId),this.watchingIntervalId=void 0)};startWatching=(e,t)=>{this.watchingIntervalId||(this.watchingIntervalId=window.setInterval(e,t))};checkAndUpdateLastSize=(e,t)=>(this.lastResizedWidth!==e||this.lastResizedHeight!==t)&&(this.lastResizedWidth=e,this.lastResizedHeight=t,!0)}u.O3h.registerModules([u.ea9]),(0,u.hbW)({theme:"legacy"});class co extends l.Component{static defaultProps=D;errorMap;containerRef;pivotTableId;internal;boundAgGridCallbacks;gridEventHandlers;dataRenderHandlers;scrollEventHandlers;resizeEventHandlers;sortingEventHandlers;aggregationEventHandlers;dataLoadingEventHandlers;configAccessors;configDelegates;stickyRowManager;heightCalculationManager;executionAbortManager;componentUpdateAnalyzer;constructor(e){super(e);const{execution:t,config:i}=e;this.state={readyToRender:!1,columnTotals:(0,h.Z)(Le(t.definition)),rowTotals:Pe(t.definition),desiredHeight:i.maxHeight,resized:!1,tempExecution:t,isLoading:!1},this.errorMap=(0,a.newErrorMapping)(e.intl),this.internal=new uo,this.boundAgGridCallbacks=this.createBoundAgGridCallbacks(),this.pivotTableId=(0,p.Z)().replace(/-/g,""),this.onLoadingChanged=this.onLoadingChanged.bind(this),this.executionAbortManager=new yt({enableExecutionCancelling:e.config?.enableExecutionCancelling}),this.initializeEventHandlers(),this.initializeConfigAccessors()}initialize=e=>{this.internal.abandonInitialization(),this.executionAbortManager.refresh({isLoading:this.state.isLoading,readyToRender:this.state.readyToRender});const t=new ao(e,this.getTableMethods(),this.props,(()=>this.executionAbortManager.getCurrentController()));return t.initialize().then((e=>{e&&this.internal.initializer===e.initializer&&(this.internal.initializer=void 0,this.internal.table=e.table,this.setState({readyToRender:!0}))})),t};reinitialize=e=>{this.setState({readyToRender:!1,columnTotals:(0,h.Z)(Le(e.definition)),rowTotals:Pe(e.definition),error:void 0,desiredHeight:this.props.config.maxHeight,resized:!1},(()=>{this.internal.destroy(),this.internal=new uo,this.initializeEventHandlers(),this.initializeConfigAccessors(),this.boundAgGridCallbacks=this.createBoundAgGridCallbacks(),this.internal.initializer=this.initialize(e)}))};componentDidMount(){this.internal.initializer=this.initialize(this.props.execution)}componentWillUnmount(){this.executionAbortManager.destroy(),this.containerRef&&this.containerRef.removeEventListener("mousedown",this.onContainerMouseDown),this.internal.destroy()}componentDidUpdate(e){this.componentUpdateAnalyzer.hasExecutionCancellingChanged(e)&&this.executionAbortManager.updateConfig({enableExecutionCancelling:this.props.config?.enableExecutionCancelling}),this.componentUpdateAnalyzer=new lo({props:this.props,state:this.state,internal:this.internal,executionAbortManager:this.executionAbortManager}),this.componentUpdateAnalyzer.shouldSkipUpdate()||(this.componentUpdateAnalyzer.isReinitNeeded(e)?(this.componentUpdateAnalyzer.logReinitDebug(e.execution),this.reinitialize(this.props.execution)):(this.componentUpdateAnalyzer.shouldRefreshHeader(e)&&this.internal.table?.refreshHeader(),this.componentUpdateAnalyzer.hasGrowToFitEnabledChanged(e,this.isGrowToFitEnabled)&&this.growToFit(),this.componentUpdateAnalyzer.hasColumnWidthsChanged(e,this.getColumnWidths)&&this.internal.table?.applyColumnSizes(this.getResizingConfig()),this.componentUpdateAnalyzer.hasMaxHeightChanged(e)&&this.updateDesiredHeight()))}stopEventWhenResizeHeader(e){e.target?.className?.includes?.("ag-header-cell-resize")&&(e.preventDefault(),e.stopPropagation())}setContainerRef=e=>{this.containerRef=e,this.containerRef&&this.containerRef.addEventListener("mousedown",this.onContainerMouseDown)};renderLoading(){const{LoadingComponent:e,theme:t}=this.props;return(0,o.jsx)(b,{LoadingComponent:e,theme:t})}render(){const{ErrorComponent:e}=this.props,{desiredHeight:t,error:i}=this.state;if(i)return(0,o.jsx)(C,{error:i,errorMap:this.errorMap,ErrorComponent:e});const n={height:t||"100%",position:"relative",overflow:"hidden"};if(!this.state.readyToRender)return(0,o.jsx)("div",{className:"gd-table-component",style:n,id:this.pivotTableId,children:this.renderLoading()});(0,s.kG)(this.internal.table),this.internal.gridOptions||(this.internal.gridOptions=function(e,t,i){const{colDefs:o}=e.tableDescriptor,{pageSize:n}=i,s=e.getRowCount(),r=o.sliceColDefs.concat(o.rootDataColDefs),a=i.config?.menu?10:0,l=Math.min(n,s+a),u={onMenuAggregationClick:t.onMenuAggregationClick,getTableDescriptor:()=>e.tableDescriptor,getExecutionDefinition:t.getExecutionDefinition,getColumnTotals:t.getColumnTotals,getRowTotals:t.getRowTotals,intl:i.intl,setLastSortedColId:t.setLastSortedColId},d="left"===t.getColumnHeadersPosition()&&e.tableDescriptor.isTransposed();return{components:{tooltipComponent:wi},columnDefs:r,defaultColDef:{cellClass:Ft(e,i),headerComponent:Di,tooltipComponent:wi,headerComponentParams:{menu:t.getMenuConfig,enableSorting:!0,...u},minWidth:Ue,sortable:!0,resizable:!0},defaultColGroupDef:{headerClass:Ut(e),children:[],headerGroupComponent:bi,headerGroupComponentParams:{menu:t.getMenuConfig,...u}},onCellClicked:Ot(e,i),onCellKeyDown:Zt(e,i),onSortChanged:t.onSortChanged,onColumnResized:t.onGridColumnResized,onGridColumnsChanged:t.onGridColumnsChanged,onModelUpdated:t.onModelUpdated,onPinnedRowDataChanged:t.onPinnedRowDataChanged,focusGridInnerElement:i=>{const o="left"===t.getColumnHeadersPosition()&&e.tableDescriptor.isTransposed(),n=i.api.getAllDisplayedColumns()[0];return o?i.api.setFocusedCell(0,n.getId()):i.api.setFocusedHeader(n.getId()),!0},tabToNextHeader:()=>!1,tabToNextCell:()=>!1,suppressMovableColumns:!0,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressAutoSize:t.hasColumnWidths,rowModelType:"infinite",paginationPageSize:l,cacheOverflowSize:l,cacheBlockSize:l,maxConcurrentDatasourceRequests:1,infiniteInitialRowCount:l,maxBlocksInCache:10,onGridReady:t.onGridReady,onFirstDataRendered:t.onFirstDataRendered,onBodyScroll:t.onBodyScroll,onGridSizeChanged:t.onGridSizeChanged,columnTypes:{[$]:ui(e,i),[K]:hi(e,i),[q]:pi(e,i),[X]:di(e,i),[Q]:Ci(e,i),[J]:mi(e,i),[te]:fi(e,i),[ie]:fi(e,i)},rowClass:"gd-table-row",rowHeight:28,autoSizePadding:12,headerHeight:d?0:void 0}}(this.internal.table,this.getTableMethods(),this.props));const r=(this.isColumnAutoresizeEnabled()||this.isGrowToFitEnabled())&&!this.state.resized,a=c("gd-table-component",{"gd-table-header-hide":"left"===this.props.config?.columnHeadersPosition&&this.internal.table.tableDescriptor.isTransposed()});return(0,o.jsx)("div",{className:a,style:n,id:this.pivotTableId,onMouseDown:this.stopEventWhenResizeHeader,onDragStart:this.stopEventWhenResizeHeader,children:(0,o.jsxs)("div",{className:"gd-table ag-theme-balham s-pivot-table",style:n,ref:this.setContainerRef,children:[(0,o.jsx)(d.s,{...this.internal.gridOptions,modules:[u.ea9]}),r?this.renderLoading():null]})})}initializeEventHandlers=()=>{this.gridEventHandlers=new mt({internal:this.internal,props:this.props,updateDesiredHeight:this.updateDesiredHeight,onFirstDataRendered:this.onFirstDataRendered,updateStickyRow:this.updateStickyRow,getGroupRows:this.getGroupRows,getLastSortedColId:this.getLastSortedColId,setLastSortedColId:this.setLastSortedColId}),this.dataRenderHandlers=new gt({internal:this.internal,isColumnAutoresizeEnabled:this.isColumnAutoresizeEnabled,isGrowToFitEnabled:this.isGrowToFitEnabled,autoresizeColumns:this.autoresizeColumns,growToFit:this.growToFit,updateStickyRow:this.updateStickyRow,startWatchingTableRendered:this.startWatchingTableRendered}),this.scrollEventHandlers=new pt({internal:this.internal,updateStickyRowContent:this.updateStickyRowContent}),this.resizeEventHandlers=new ft({internal:this.internal,updateDesiredHeight:this.updateDesiredHeight,autoresizeColumns:this.autoresizeColumns,getResizingConfig:this.getResizingConfig}),this.sortingEventHandlers=new Ct({internal:this.internal,getExecutionDefinition:this.getExecutionDefinition,pushDataGuard:this.pushDataGuard,setState:this.setState.bind(this)}),this.aggregationEventHandlers=new It({internal:this.internal,getExecutionDefinition:this.getExecutionDefinition,getColumnTotals:this.getColumnTotals,getRowTotals:this.getRowTotals,pushDataGuard:this.pushDataGuard,setState:this.setState.bind(this)}),this.dataLoadingEventHandlers=new Rt({internal:this.internal,props:this.props,updateStickyRow:this.updateStickyRow,updateDesiredHeight:this.updateDesiredHeight,setState:this.setState.bind(this)})};onGridReady=e=>{this.gridEventHandlers.onGridReady(e)};onFirstDataRendered=async e=>{await this.dataRenderHandlers.onFirstDataRendered(e)};onModelUpdated=e=>{this.gridEventHandlers.onModelUpdated(e)};onGridColumnsChanged=()=>{this.gridEventHandlers.onGridColumnsChanged()};onGridSizeChanged=e=>{this.resizeEventHandlers.onGridSizeChanged(e)};onGridColumnResized=async e=>{await this.resizeEventHandlers.onGridColumnResized(e)};onSortChanged=e=>{this.sortingEventHandlers.onSortChanged(e)};onPinnedRowDataChanged=async e=>{await this.resizeEventHandlers.onPinnedRowDataChanged(e)};onBodyScroll=e=>{this.scrollEventHandlers.onBodyScroll(e)};onContainerMouseDown=e=>{this.scrollEventHandlers.onContainerMouseDown(e)};onPageLoaded=(e,t)=>{this.dataLoadingEventHandlers.onPageLoaded(e,t)};onExecutionTransformed=e=>{this.internal.table&&(this.internal.table.clearStickyRow(),(0,m.Z)(this.state.tempExecution.definition.buckets[2],e.definition.buckets[2])||(this.setState({tempExecution:e}),this.reinitialize(e)))};onMenuAggregationClick=e=>{this.aggregationEventHandlers.onMenuAggregationClick(e)};onLoadingChanged=e=>{this.dataLoadingEventHandlers.onLoadingChanged(e)};onError=(e,t=this.props.execution)=>{this.dataLoadingEventHandlers.onError(e,t)};growToFit=()=>{(0,s.kG)(this.internal.table),this.isGrowToFitEnabled()&&(this.internal.table.growToFit(this.getResizingConfig()),this.state.resized||this.internal.table.isResizing()||this.setState({resized:!0}))};autoresizeColumns=async(e=!1)=>{if(this.state.resized&&!e)return;const t=await(this.internal.table?.autoresizeColumns(this.getResizingConfig(),e));t&&this.updateDesiredHeight(),t&&!this.state.resized&&this.setState({resized:!0})};shouldAutoResizeColumns=()=>this.configDelegates.shouldAutoResizeColumns();startWatchingTableRendered=()=>{if(!this.internal.table)return;const e=!this.containerRef,t=this.shouldAutoResizeColumns()?this.state.resized:this.internal.table.isPivotTableReady(),i=this.internal.table.isPivotTableReady()&&!this.state.resized&&!this.internal.table.isResizing();this.shouldAutoResizeColumns()&&i&&this.autoresizeColumns(),(e||t)&&this.stopWatchingTableRendered()};stopWatchingTableRendered=()=>{this.internal.stopWatching(),this.props.afterRender()};updateStickyRow=()=>{this.stickyRowManager.updateStickyRow()};updateStickyRowContent=e=>{this.stickyRowManager.updateStickyRowContent(e)};updateDesiredHeight=()=>{this.heightCalculationManager.updateDesiredHeight()};initializeConfigAccessors=()=>{var e;this.configAccessors=new ht({props:this.props,state:this.state}),this.configDelegates=(e=this.configAccessors,{getColumnTotals:()=>e.getColumnTotals(),getRowTotals:()=>e.getRowTotals(),getExecutionDefinition:()=>e.getExecutionDefinition(),getGroupRows:()=>e.getGroupRows(),getMeasureGroupDimension:()=>e.getMeasureGroupDimension(),getColumnHeadersPosition:()=>e.getColumnHeadersPosition(),getMenuConfig:()=>e.getMenuConfig(),getDefaultWidth:()=>e.getDefaultWidth(),isColumnAutoresizeEnabled:()=>e.isColumnAutoresizeEnabled(),isGrowToFitEnabled:t=>e.isGrowToFitEnabled(t),getColumnWidths:t=>e.getColumnWidths(t),hasColumnWidths:()=>e.hasColumnWidths(),getDefaultWidthFromProps:t=>e.getDefaultWidthFromProps(t),shouldAutoResizeColumns:()=>e.shouldAutoResizeColumns()}),this.stickyRowManager=new Ti({internal:this.internal,props:this.props,state:this.state,getGroupRows:this.getGroupRows}),this.heightCalculationManager=new vi({internal:this.internal,props:this.props,state:this.state,setState:(e,t)=>{this.setState(e,t)},getContainerRef:()=>this.containerRef}),this.componentUpdateAnalyzer=new lo({props:this.props,state:this.state,internal:this.internal,executionAbortManager:this.executionAbortManager})};getLastSortedColId=()=>this.internal.lastSortedColId;setLastSortedColId=e=>{this.internal.lastSortedColId=e};getColumnTotals=()=>this.configDelegates.getColumnTotals();getRowTotals=()=>this.configDelegates.getRowTotals();getExecutionDefinition=()=>this.configDelegates.getExecutionDefinition();getGroupRows=()=>this.configDelegates.getGroupRows();getMeasureGroupDimension=()=>this.configDelegates.getMeasureGroupDimension();getColumnHeadersPosition=()=>this.configDelegates.getColumnHeadersPosition();getMenuConfig=()=>this.configDelegates.getMenuConfig();getDefaultWidth=()=>this.configDelegates.getDefaultWidth();isColumnAutoresizeEnabled=()=>this.configDelegates.isColumnAutoresizeEnabled();isGrowToFitEnabled=(e=this.props)=>this.configDelegates.isGrowToFitEnabled(e);getColumnWidths=e=>this.configDelegates.getColumnWidths(e);hasColumnWidths=()=>this.configDelegates.hasColumnWidths();getDefaultWidthFromProps=e=>this.configDelegates.getDefaultWidthFromProps(e);pushDataGuard=e=>{this.props.pushData?.(e)};stateBoundCallback=e=>function(e,t,i){return(...o)=>{if(i()===t)return e(...o)}}(e,this.internal,(()=>this.internal));createBoundAgGridCallbacks=()=>{const e=function(e,t){let i;return(...t)=>{i&&clearTimeout(i),i=window.setTimeout((()=>{e(...t),i=void 0}),300)}}(this.stateBoundCallback(this.onGridSizeChanged));return{onGridReady:this.stateBoundCallback(this.onGridReady),onFirstDataRendered:this.stateBoundCallback(this.onFirstDataRendered),onBodyScroll:this.stateBoundCallback(this.onBodyScroll),onModelUpdated:this.stateBoundCallback(this.onModelUpdated),onGridColumnsChanged:this.stateBoundCallback(this.onGridColumnsChanged),onGridColumnResized:this.stateBoundCallback(this.onGridColumnResized),onSortChanged:this.stateBoundCallback(this.onSortChanged),onGridSizeChanged:e,onPinnedRowDataChanged:this.stateBoundCallback(this.onPinnedRowDataChanged)}};getTableMethods=()=>({hasColumnWidths:this.hasColumnWidths(),getExecutionDefinition:this.getExecutionDefinition,getMenuConfig:this.getMenuConfig,getGroupRows:this.getGroupRows,getColumnTotals:this.getColumnTotals,getRowTotals:this.getRowTotals,getColumnHeadersPosition:this.getColumnHeadersPosition,getMeasureGroupDimension:this.getMeasureGroupDimension,getResizingConfig:this.getResizingConfig,onLoadingChanged:this.onLoadingChanged,onError:this.onError,onExportReady:this.props.onExportReady??(()=>{}),pushData:this.pushDataGuard,onPageLoaded:this.onPageLoaded,onExecutionTransformed:this.onExecutionTransformed,onMenuAggregationClick:this.onMenuAggregationClick,setLastSortedColId:this.setLastSortedColId,...this.boundAgGridCallbacks});getResizingConfig=()=>({defaultWidth:this.getDefaultWidth(),growToFit:this.isGrowToFitEnabled(),columnAutoresizeOption:this.getDefaultWidthFromProps(this.props),widths:this.getColumnWidths(this.props),isAltKeyPressed:this.internal.isAltKeyPressed,isMetaOrCtrlKeyPressed:this.internal.isMetaOrCtrlKeyPressed,clientWidth:this.containerRef?.getElementsByClassName("ag-body-viewport")[0]?.clientWidth??0,containerRef:this.containerRef,separators:this.props?.config?.separators,onColumnResized:this.props.onColumnResized})}const ho=(0,g.ZP)((0,f.Zz)(co));function mo(e){return(0,o.jsx)(f.ze,{theme:e.theme||{},themeIsLoading:!1,children:(0,o.jsx)(a.IntlWrapper,{locale:e.locale,children:(0,o.jsx)(ho,{...e})})})}function go(e){return"rows"===(e.measureGroupDimension??"columns")}const po=e=>{const{rows:t,columns:i,config:o={}}=e;if("left"===o.columnHeadersPosition){const e=i&&i.length>0;return!t&&e&&"rows"===o.measureGroupDimension?o:(console.warn("Invalid table configuration. `columnHeadersPosition: left` requires metrics in rows, no row attributes and at least one column attribute defined."),{...o,columnHeadersPosition:"top"})}return o},fo=(0,a.withContexts)((function(e){const{exportTitle:t,backend:i,workspace:l,config:u={}}=e;(0,s.kG)(i,"Backend was not provided for PivotTable. Either pass it as a prop or use BackendContext."),(0,s.kG)(l,"Workspace was not provided for PivotTable. Either pass it as a prop or use WorkspaceContext.");const d=(0,n.Z)(e,["measures","rows","columns","totals","filters","sortBy"]),c={...po(e),menu:bo(i.capabilities,u?.menu)},h=(0,n.Z)(d,["backend","workspace"]),m=function(e){const{backend:t,workspace:i,filters:o,sortBy:n=[],execConfig:s={},config:l={}}=e,u=function(e,t){return t?e.filter((e=>!(0,r.isMeasureSort)(e))):e}(n,go(l));return t.withTelemetry("PivotTable",e).workspace(i).execution().forBuckets(function(e){const{measures:t=[],rows:i=[],columns:o=[],totals:n=[]}=e,s=n.filter((e=>i.find((t=>t.attribute.localIdentifier===e.attributeIdentifier)))),l=n.filter((e=>o.find((t=>t.attribute.localIdentifier===e.attributeIdentifier))));return[(0,r.newBucket)(a.BucketNames.MEASURES,...t),(0,r.newBucket)(a.BucketNames.ATTRIBUTE,...i,...s),(0,r.newBucket)(a.BucketNames.COLUMNS,...o,...l)]}(e),o).withDimensions((e=>Do(e.buckets,go(l)))).withSorting(...u).withExecConfig(s)}(e);return(0,o.jsx)(a.IntlWrapper,{locale:e.locale,children:(0,o.jsx)(a.IntlTranslationsProvider,{children:e=>(0,o.jsx)(co,{...h,config:c,intl:e.intl,execution:m,exportTitle:t||"PivotTable"})})})}));function Co(e){const[t,i,n,s,r,l]=(0,a.useResolveValuesWithPlaceholders)([e.measures,e.columns,e.rows,e.totals,e.filters,e.sortBy],e.placeholdersResolutionContext);return(0,o.jsx)(fo,{...e,measures:t,columns:i,rows:n,totals:s,filters:r,sortBy:l})}function bo(e,t={}){const i={...t};return e.canCalculateGrandTotals?(e.canCalculateNativeTotals||(i.aggregationTypes=(i.aggregationTypes??ne).filter((e=>"nat"!==e))),0===i.aggregationTypes?.length?{aggregations:!1}:i):{aggregations:!1}}function Do(e,t){const i=(0,r.bucketsFind)(e,a.BucketNames.ATTRIBUTE),o=(0,r.bucketsFind)(e,a.BucketNames.COLUMNS),n=(0,r.bucketsFind)(e,a.BucketNames.MEASURES),s=i?(0,r.bucketAttributes)(i):[],l=o?(0,r.bucketAttributes)(o):[],u=n&&!(0,r.bucketIsEmpty)(n)?[r.MeasureGroupIdentifier]:[],d=i?(0,r.bucketTotals)(i):[],c=o?(0,r.bucketTotals)(o):[],h=t?u:[],m=t?[]:u;return(0,r.newTwoDimensional)([...s,...h,...d],[...l,...c,...m])}},36360:(e,t,i)=>{function o(e,t){return e||t}i.d(t,{U:()=>o})},58e3:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(72714);const n=function(e,t,i){for(var n=-1,s=e.length;++n<s;){var r=e[n],a=t(r);if(null!=a&&(void 0===l?a==a&&!(0,o.Z)(a):i(a,l)))var l=a,u=r}return u}},14406:(e,t,i)=>{i.d(t,{Z:()=>o});const o=function(e,t){return e>t}},59350:(e,t,i)=>{i.d(t,{Z:()=>d});var o=i(45084),n=i(39370),s=i(22783),r=i(74073),a=i(21162),l=i(59548),u=Math.min;const d=function(e,t,i){for(var d=i?s.Z:n.Z,c=e[0].length,h=e.length,m=h,g=Array(h),p=1/0,f=[];m--;){var C=e[m];m&&t&&(C=(0,r.Z)(C,(0,a.Z)(t))),p=u(C.length,p),g[m]=!i&&(t||c>=120&&C.length>=120)?new o.Z(m&&C):void 0}C=e[0];var b=-1,D=g[0];e:for(;++b<c&&f.length<p;){var w=C[b],v=t?t(w):w;if(w=i||0!==w?w:0,!(D?(0,l.Z)(D,v):d(f,v,i))){for(m=h;--m;){var T=g[m];if(!(T?(0,l.Z)(T,v):d(e[m],v,i)))continue e}D&&D.push(v),f.push(w)}}return f}},17633:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(836);const n=function(e){return(0,o.Z)(e)?e:[]}},8961:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(74073),n=i(59350),s=i(69581),r=i(17633);const a=(0,s.Z)((function(e){var t=(0,o.Z)(e,r.Z);return t.length&&t[0]===e[0]?(0,n.Z)(t):[]}))},69884:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(74752);const n=(0,i(99108).Z)((function(e,t,i){(0,o.Z)(e,i,t)}))},90783:(e,t,i)=>{i.d(t,{Z:()=>r});var o=i(58e3),n=i(14406),s=i(69203);const r=function(e){return e&&e.length?(0,o.Z)(e,s.Z,n.Z):void 0}},96446:(e,t,i)=>{i.d(t,{Z:()=>a});var o=Math.ceil,n=Math.max;var s=i(50439),r=i(29640);const a=function(e,t,i){return i&&"number"!=typeof i&&(0,s.Z)(e,t,i)&&(t=i=void 0),e=(0,r.Z)(e),void 0===t?(t=e,e=0):t=(0,r.Z)(t),function(e,t,i,s){for(var r=-1,a=n(o((t-e)/(i||1)),0),l=Array(a);a--;)l[s?a:++r]=e,e+=i;return l}(e,t,i=void 0===i?e<t?1:-1:(0,r.Z)(i),void 0)}},94207:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(90184);const n=function(e){return e&&e.length?(0,o.Z)(e):[]}},72644:(e,t,i)=>{i.d(t,{Z:()=>u});var o=i(68774),n=i(74073),s=i(54193),r=i(52889),a=i(836),l=Math.max;const u=function(e){if(!e||!e.length)return[];var t=0;return e=(0,o.Z)(e,(function(e){if((0,a.Z)(e))return t=l(e.length,t),!0})),(0,r.Z)(t,(function(t){return(0,n.Z)(e,(0,s.Z)(t))}))}},49578:(e,t,i)=>{i.d(t,{Z:()=>s});var o=i(69581),n=i(72644);const s=(0,o.Z)(n.Z)}}]);