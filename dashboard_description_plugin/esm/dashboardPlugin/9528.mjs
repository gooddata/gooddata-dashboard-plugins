(self.webpackChunkdashboard_description_plugin=self.webpackChunkdashboard_description_plugin||[]).push([[9528],{19528:(t,e,s)=>{s.r(e),s.d(e,{ClientColors:()=>i,ClientFormatterFacade:()=>H,DefaultFormat:()=>r,DefaultFormatterFacade:()=>O,FormatOptions:()=>a,ResultColors:()=>n,ResultMetadata:()=>l,colorNameMap:()=>o});const o={black:"#000000",red:"#ff0000",green:"#00aa00",blue:"#0000ff",white:"#ffffff",cyan:"#0092d2",magenta:"#cb006b",yellow:"#fff10d",none:void 0},r="#,##0.00";class a{constructor(t=!0,e=!0,s,o,r,a,i){this.includeColors=!0,this.legacyCompatibility=!0,this.includeColors=t,this.legacyCompatibility=e,this.thousandsSeparator=s,this.decimalSeparator=o,this.nanString=r,this.positiveInfinity=a,this.negativeInfinity=i}}a.DefaultOptions=new a;class i{constructor(t){if(t.customColor&&(this.color=t.customColor.startsWith("#")?t.customColor:"#"+t.customColor),t.color){const e=o[t.color]?o[t.color]:void 0;this.color=e}t.customBgColor&&(this.backgroundColor=t.customBgColor.startsWith("#")?t.customBgColor:"#"+t.customBgColor)}}class n{constructor(t,e,s){this.color=t,this.customColor=e,this.customBgColor=s}reset(){this.color=void 0,this.customColor=void 0,this.customBgColor=void 0}}class l{constructor(t,e,s=!1){this.colors=t||new n,this.effectiveFormat=e,this.nullConditionFormatter=s}reset(){this.colors.reset(),this.effectiveFormat=void 0,this.nullConditionFormatter=!1}}var c=s(23067);class h extends Error{constructor(t){super(t),this.name="InvalidArgumentError",Object.setPrototypeOf(this,new.target.prototype)}}class u{constructor(t,e,s,o=e){this.str=t,this.pos=o,this.begin=e,this.end=s}hasNext(){return this.pos<this.end}hasPrevious(){return this.pos>this.begin}next(){if(this.hasNext()){const t=this.str.charAt(this.pos);return this.pos++,t}return""}previous(){return this.hasPrevious()?(this.pos--,this.str.charAt(this.pos)):""}getIndex(){return this.pos}}function m(t,e,s,o){const r=new n,a=o.match(t);a&&(r.color=a[1].toLowerCase());const i=o.match(e);i&&(r.customColor=i[1].toLowerCase());const l=o.match(s);return l&&(r.customBgColor=l[1].toLowerCase()),r}class d{constructor(t){this.thousandsSeparator=t.thousandsSeparator||d.DefaultThousandSeparator,this.decimalSeparator=t.decimalSeparator||d.DefaultDecimalSeparator,this.nanString=t.nanString||d.DefaultNaNString,this.positiveInfinity=t.positiveInfinity||d.DefaultPositiveInfinity,this.negativeInfinity=t.negativeInfinity||d.DefaultNegativeInfinity}}d.DefaultThousandSeparator=",",d.DefaultDecimalSeparator=".",d.DefaultNaNString="NaN",d.DefaultPositiveInfinity="Infinity",d.DefaultNegativeInfinity="-Infinity";class g{constructor(t,e,s=!1){this.options=t,this.constants=e,this.formatAbsoluteValue=s}toNestedFormatCtx(){return new g(this.options,this.constants,!0)}}class f{constructor(t,e=!1){this.options=t,this.nestedFormatter=e}toNestedFormatCtx(){return new f(this.options,!0)}}class p{format(t,e,s){s&&s.reset();const o=new d(e),r=new g(e,o);return this.doFormat(r,t,s)}resolve(t,e){const s=new f(e);return this.doResolve(s,t)}}class C extends p{constructor(t,e,s){super(),this.literal=t,this.literalNoColors=e,this.colors=s}doFormat(t,e,s){return s&&(s.colors=this.colors,s.effectiveFormat=""),t.options.includeColors?(s&&(s.effectiveFormat=this.literal),this.literal):(s&&(s.effectiveFormat=this.literalNoColors),this.literalNoColors)}doResolve(t,e){return t.options.includeColors?this.literal:this.literalNoColors}static compile(t,e){let s="",o=!1;const r=t.getColorMatcher(),a=t.getCustomColorMatcher(),i=t.getCustomBgColorMatcher();for(const t of e)"\\"===t?o=!0:(o=!1,s+=t);o&&(s+="\\");const n=function(t,e){const s=t.getColorMatcher(),o=t.getAnyCustomColorMatcher();return e.replace(new RegExp(s,"gi"),"").replace(new RegExp(o,"gi"),"")}(t,s),l=m(r,a,i,s);return new C(s,n,l)}}class v{constructor(){this.nullConditionPattern=v.createRegexPattern(v.NullConditionRegex,"i"),this.conditionPattern=v.createRegexPattern(v.ConditionRegex,"i"),this.arithmeticPattern=v.createRegexPattern(v.ArithmeticRegex,"i"),this.colorPattern=v.createRegexPattern(v.ColorRegex,"i"),this.customColorPattern=v.createRegexPattern(v.CustomColorRegex,"i"),this.customBgColorPattern=v.createRegexPattern(v.CustomBackgroundColorRegex,"i"),this.anyCustomColorPattern=v.createRegexPattern(v.AnyCustomColorRegex,"i"),this.excelFormatSuffixPattern=v.createRegexPattern(v.ExcelFormatSuffixRegex)}static createRegexPattern(t,e){return e?new RegExp(t.source,e):t}getNullConditionMatcher(){return this.nullConditionPattern}getConditionMatcher(){return this.conditionPattern}getArithmeticMatcher(){return new RegExp(this.arithmeticPattern,"g")}getColorMatcher(){return this.colorPattern}getCustomColorMatcher(){return this.customColorPattern}getCustomBgColorMatcher(){return this.customBgColorPattern}getAnyCustomColorMatcher(){return this.anyCustomColorPattern}getExcelFormatSuffixMatcher(){return this.excelFormatSuffixPattern}static group(t,e){if(t&&e>=0&&e<t.length){const s=t[e];if(void 0===s)return{value:s,startIndex:-1,endIndex:-1};const o=t.index+t[0].indexOf(s);return{value:s,startIndex:o,endIndex:o+s.length}}throw new Error(`Group ${e} not found in the regex match.`)}}v.NullConditionRegex=/\[=null\]/i,v.ConditionRegex=/\[(>=|<=|[=><])(-?[0-9.]+|null)\]/i,v.ArithmeticRegex=/\{\{\{([0-9]*(?:\.[0-9]*)?)\|([0-9]*)(\.)?\|(.*?)\}\}\}/,v.ColorRegex=/\[(black|blue|cyan|green|magenta|red|white|yellow|none)\]/i,v.CustomColorRegex=/\[color=#*([A-F0-9]+)\]/i,v.CustomBackgroundColorRegex=/\[backgroundColor=#*([A-F0-9]+)\]/i,v.AnyCustomColorRegex=/(\[(?:backgroundColor|color)=#*[A-Fa-f0-9]+\])+/,v.ExcelFormatSuffixRegex=/\[excel\]([\s\S])*$/i;class P extends p{constructor(t,e,s,o){super(),this.divisor=s,this.modulo=o,this.trimFraction=e,this.formatter=t}doFormat(t,e,s){let o=e||0;return void 0!==this.divisor&&(o/=this.divisor),void 0!==this.modulo&&(o%=this.modulo),this.trimFraction&&(Number.isNaN(o)||!Number.isFinite(o)?o=0:o<0?(o=-1*Math.floor(-1*o),Object.is(o,-0)&&(o=0)):o=Math.floor(o)),this.formatter.doFormat(t,o,s)}doResolve(t,e){return null}}class x extends p{static doubleTostring(t){return Number.parseFloat(t)}constructor(t,e){super(),this.baseFormat=t,this.expressions=e}doFormat(t,e,s){const o=t.toNestedFormatCtx(),r=this.baseFormat.doFormat(o,e,s||void 0);let a="";const i=new u(r,0,r.length);for(;i.hasNext();){const t=i.next(),r=t.charCodeAt(0);if(r>=x.ExpressionPlaceholderStart&&r<=x.ExpressionPlaceholderEnd){const i=r-x.ExpressionPlaceholderStart;if(i>=this.expressions.length)a+=t;else{const t=new l;a+=this.expressions[i].doFormat(o,e,void 0!==s?t:void 0),void 0!==s&&(s.colors.color||(s.colors.color=t.colors.color),s.colors.customColor||(s.colors.customColor=t.colors.customColor),s.colors.customBgColor||(s.colors.customBgColor=t.colors.customBgColor))}}else a+=t}return void 0!==s&&(s.effectiveFormat=void 0),a}static compile(t,e,s){const o=t.getArithmeticMatcher();let r="";const a=[];let i,n=0;for(;null!==(i=o.exec(s));){const t=i.index,c=o.lastIndex;r+=s.substring(n,t),n=c;const u=x.ExpressionPlaceholderStart+a.length;if(u>x.ExpressionPlaceholderEnd)throw new h("Too many arithmetic expressions. You can specify at most 256 expressions.");const m=F(v.group(i,1).value,x.doubleTostring),d=F(v.group(i,2).value,x.doubleTostring),g=!(l=v.group(i,3).value)||0===l.length,f=v.group(i,4).value;r+=String.fromCodePoint(u),a.push(new P(e.compileFormatter(f),g,m,d))}var l;return r+=s.substring(n),(0,c.kG)(0!==a.length,"No arithmetic expressions found in the format string."),new x(e.compileFormatter(r),a)}doResolve(t,e){return null}}function F(t,e){if(!t.length)return;const s=e(t);return Number.isNaN(s)?void 0:s}x.ExpressionPlaceholderStart=57344,x.ExpressionPlaceholderEnd=57599;class b{constructor(t,e,s){this.op=t,this.rhs=e,this.formatter=s,(0,c.kG)(null!==e||"Equal"===t)}isNullAlternative(){return null===this.rhs}evaluate(t,e){if(null===t){if(null===this.rhs)return!0;if(!e)return!1;switch(this.op){case"Equal":default:return!1;case"WeakEqual":return 0===this.rhs;case"LessThan":return this.rhs>0;case"LessThanOrEqual":return this.rhs>=0;case"GreaterThan":return this.rhs<0;case"GreaterThanOrEqual":return this.rhs<=0}}switch(this.op){case"Equal":case"WeakEqual":return null!==this.rhs&&t===this.rhs;case"GreaterThan":return null!==this.rhs&&t>this.rhs;case"GreaterThanOrEqual":return null!==this.rhs&&t>=this.rhs;case"LessThan":return null!==this.rhs&&t<this.rhs;case"LessThanOrEqual":return null!==this.rhs&&t<=this.rhs;default:return!1}}doFormat(t,e,s){return this.formatter.doFormat(t,e,s)}doResolve(t,e){return this.formatter.doResolve(t,e)}}class w extends p{constructor(t,e){super(),this.alternatives=t,this.catchall=e}static doubleToString(t){return parseFloat(t)}static compile(t,e,s){const o=t.getConditionMatcher();let a=r;const i=[],n=[];let l=0;for(const r of s){let s;if(o.lastIndex=0,null!==(s=o.exec(r))){const o=v.group(s,0),a=o.startIndex,l=o.endIndex,c=y(v.group(s,1).value),h=N(v.group(s,2).value,w.doubleToString);if(null===h.maybeValue&&"Equal"!==c)continue;let u;0===a?u=r.substring(l):(u=r.substring(0,a),u+=r.substring(l)),"Equal"===c?null!==h.maybeValue?0===h.maybeValue&&h.inputHadDecimals?i.push(new b("WeakEqual",h.maybeValue,e.compileFormatter(u))):i.push(new b(c,h.maybeValue,e.compileFormatter(u))):i.push(new b(c,h.maybeValue,C.compile(t,u))):n.push(new b(c,h.maybeValue,e.compileFormatter(u)))}else{switch(l){case 0:a=r,n.push(new b("GreaterThanOrEqual",0,e.compileFormatter(r)));break;case 1:n.push(new b("LessThan",0,e.compileFormatter(r)));break;case 2:i.push(new b("Equal",0,e.compileFormatter(r)));break;default:throw new h("Too many semicolons in the format string.")}l++}}return new w(i.concat(n),e.compileFormatter(a))}doFormat(t,e,s){const o=t.toNestedFormatCtx();for(const t of this.alternatives)if(t.evaluate(e,o.options.legacyCompatibility))return void 0!==s&&t.isNullAlternative()&&(s.nullConditionFormatter=!0),t.doFormat(o,e,s);return this.catchall.doFormat(o,e,s)}doResolve(t,e){let s=null;const o=t.toNestedFormatCtx();let r=!1,a=!1;for(const i of this.alternatives)if(i.evaluate(e,t.options.legacyCompatibility)){r=!0,a=i.isNullAlternative(),s=i.doResolve(o,e);break}return r||(s=this.catchall.doResolve(o,e)),null===s?"":a||t.nestedFormatter?s:`${s};${s}`}}function y(t){if("="===t)return"Equal";if(">"===t)return"GreaterThan";if(">="===t)return"GreaterThanOrEqual";if("<"===t)return"LessThan";if("<="===t)return"LessThanOrEqual";throw new h("Unsupported operator.")}function N(t,e){const s=e(t),o={maybeValue:null,inputHadDecimals:t.indexOf(".")>-1};return Number.isNaN(s)||(o.maybeValue=s),o}class S{constructor(t,e=!1){this.c=t,this.escaped=e}toString(){return this.c}isEscaped(){return this.escaped}isPlacement(){return!this.escaped&&("0"===this.c||"#"===this.c||"?"===this.c)}isZeroPlacement(){return!this.escaped&&"0"===this.c}isHashPlacement(){return!this.escaped&&"#"===this.c}isQPlacement(){return!this.escaped&&"?"===this.c}isDigit(){return this.c>="1"&&this.c<="9"}isComma(){return!this.escaped&&","===this.c}isDecimal(){return!this.escaped&&"."===this.c}isPercent(){return!this.escaped&&"%"===this.c}getColorPlaceholderIndex(){const t=this.c.codePointAt(0),e=S.ColorPlaceholderStart.codePointAt(0),s=S.ColorPlaceholderEnd.codePointAt(0);return void 0!==t&&void 0!==e&&void 0!==s&&t>=e&&t<=s?t-e:-1}}S.ColorPlaceholderStart="",S.ColorPlaceholderEnd="";class E{constructor(){this.vec=[]}append(t){this.vec.push(t)}insert(t,e){this.vec.splice(t,0,e)}getVec(){return this.vec.slice()}length(){return this.vec.length}}class D{constructor(t,e,s){this.formatString=t,this.digits=e,this.placements=s}getDigits(){return this.digits}getPlacements(){return this.placements}}class R extends D{format(t,e,s){const o="-"===t.charAt(0),r=new u(t,o?1:0,t.length,t.length),a=this.formatString.getVec().reverse();let i="",n=this.getPlacements(),l=this.getDigits(),c=0;const h=e.length>0,m="-"!==e.charAt(0)?e:"0";for(;a.length>0&&(r.hasPrevious()||l)&&n;){const t=a.shift();if(void 0===t)break;const e=t.getColorPlaceholderIndex();if(e>=0){if(null==s||s.length<e)continue;i+=s[e]}else if(t.isPlacement()){if(h&&3===c)i+=m,c=0;else{let t;t=r.hasPrevious()?r.previous():"0",i+=t,c++,l&&l--}n--}else i+=t}for(;r.hasPrevious()||l;)h&&3===c?(i+=m,c=0):r.hasPrevious()?(i+=r.previous(),c++,l&&l--):(i+="0",c++,l--);for(o&&(i+="-");a.length>0;){const t=a.shift();if(void 0===t)break;const e=t.getColorPlaceholderIndex();if(e>=0){if(null==s||s.length<e)continue;i+=s[e]}else t.isHashPlacement()||(t.isQPlacement()?i+=" ":i+=t)}return i.split("").reverse().join("")}}R.NoThousandsSeparators="";class I{constructor(){this.placedDigits=0,this.placedLiteralDigits=0,this.placedEscapedCharacters=0}}class V extends D{format(t,e,s=null){if(!this.digits)return"";const o=this.formatString.getVec().slice(),r=new u(t,0,t.length);let a=this.digits,i=0,n=0,l=0,h="",m="";for(;a;){const t=o.shift();(0,c.kG)(t.isPlacement());const e=r.hasNext()?r.next():"0";(0,c.kG)(!isNaN(Number(e)),"Fraction part should only include digits"),t.isHashPlacement()&&"0"===e?m+=e:(h+=m,i+=m.length,m="",h+=e,i++),a--}for(this.placements>this.digits&&(h+=m,i+=m.length,m="");o.length>0;){const t=o.shift(),e=t.getColorPlaceholderIndex();if(e>=0){if(null===s||s.length<=e)continue;h+=s[e]}else t.isHashPlacement()||(t.isQPlacement()?h+=" ":(l+=t.isEscaped()?1:0,n+=t.isDigit()?1:0,h+=t.toString()))}return e.placedDigits=i,e.placedLiteralDigits=n,e.placedEscapedCharacters=l,h}}class M{constructor(){this.state="Null"}onCharacter(t){switch(this.state){case"Matched":break;case"Null":t.isPlacement()&&(this.state="HasPlacementChar");break;case"HasPlacementChar":t.isPlacement()?this.state="HasPlacementChar":t.isComma()?this.state="HasComma":this.state="Null";break;case"HasComma":t.isPlacement()?this.state="Matched":this.state="Null"}}isMatched(){return"Matched"===this.state}}class A{constructor(t=!1){this.counter=0,this.state=t?"ExpectingAnyPlacement":"WaitingForZero"}onCharacter(t){switch(this.state){case"Done":break;case"ExpectingAnyPlacement":t.isPlacement()?(this.state="CountingDigits",this.counter++):this.state="Done";break;case"WaitingForZero":t.isZeroPlacement()&&(this.state="CountingDigits",this.counter++);break;case"CountingDigits":t.isPlacement()?this.counter++:this.state="Done"}}count(){return this.counter}}class T{constructor(t=!1){this.scalingValue=0;const e=t?"Null":"CommasExpected";this.initialState=e,this.state=e}onCharacter(t){switch(this.state){case"Null":t.isPlacement()&&(this.state="CommasExpected");break;case"CommasExpected":t.isComma()?(this.state="CollectScaling",this.scalingValue++):t.isPlacement()||(this.state=this.initialState,this.scalingValue=0);break;case"CollectScaling":t.isComma()?this.scalingValue++:t.isPlacement()?(this.scalingValue--,this.state=this.scalingValue?"Done":"CommasExpected"):this.state="Done"}}scaling(){return this.scalingValue}}class k{constructor(){this.visualPart="",this.bareFormatWithPlaceholders="",this.colorPlaceholderValues=[],this.colors=new n}}class B{constructor(t){this.thousandsSeparator=t.thousandsSeparator||B.DefaultThousandSeparator,this.decimalSeparator=t.decimalSeparator||B.DefaultDecimalSeparator,this.nanString=t.nanString||B.DefaultNaNString,this.positiveInfinity=t.positiveInfinity||B.DefaultPositiveInfinity,this.negativeInfinity=t.negativeInfinity||B.DefaultNegativeInfinity}}B.DefaultThousandSeparator=",",B.DefaultDecimalSeparator=".",B.DefaultNaNString="NaN",B.DefaultPositiveInfinity="Infinity",B.DefaultNegativeInfinity="-Infinity";class q extends p{constructor(t,e,s,o,r,a,i,n,l,c,h,u){super(),this.effectivelyEmpty=t,this.escapedFormat=e,this.visualPart=s,this.escapedFormatNoVisuals=o,this.wholePart=r,this.fractionPart=a,this.colorPlaceholderValues=i,this.colors=n,this.percent=l,this.scaling=c,this.thousandsSeparators=h,this.hasDecimal=u}static doubleToString(t,e){const s=Object.is(t,-0),o=t.toFixed(e);return s?"-"+o:o}static leftPad(t,e,s){return String(t).padStart(e,s)}static roundInternal(t,e){if(e>0){const s=Math.min(e+10,20),o=new RegExp("(-?\\d*)\\.(\\d{"+e+"})(\\d)\\d*$"),r=t.toFixed(s).match(o);if(null==r?void 0:r.length){const t="-"===r[1].charAt(0)?-1:1,s=q.leftPad(Math.round(r[2]+"."+r[3]),e,"0");return s.length>e?Number(r[1])+t:Number(r[1]+"."+s)}}return t}static round(t,e){if(0===e){const e=t<0?-1:1;return Math.round(t*e)*e}return q.roundInternal(t,e)}static numberHasValue(t){return null!=t}prepareValueToFormat(t){let e=t;this.percent&&(e*=100);for(let t=0;t<this.scaling;t++)e/=1e3;const s=Math.min(20,this.fractionPart.getDigits());e=q.round(e,s);const o=q.doubleToString(e,s);let r="",a="";if(""===o)return{valueToFormat:e,wholePart:r,fractionPart:a};if(this.fractionPart.getDigits()){const t=o.indexOf(".");(0,c.kG)(-1!==t,"Decimal separator not found in the numberString."),r=o.substring(0,t),a=o.substring(t+1)}else r=o,a="";return 0===this.wholePart.getDigits()?"0"===r?r="":"-0"===r&&(r=this.hasDecimal?"-":""):this.hasDecimal||"-0"!==r||(r="0"),{valueToFormat:e,wholePart:r,fractionPart:a}}isLiteral(){return this.wholePart.getPlacements()+this.fractionPart.getPlacements()===0}doFormat(t,e,s){let o="";if(null===e);else if(!this.effectivelyEmpty&&this.isLiteral())o=t.options.includeColors?this.escapedFormat:this.escapedFormatNoVisuals;else{let s=e;t.formatAbsoluteValue&&q.numberHasValue(e)&&(s=Math.abs(e));const r=this.prepareValueToFormat(s),a=this.thousandsSeparators?t.constants.thousandsSeparator:R.NoThousandsSeparators,i=t.options.includeColors?this.colorPlaceholderValues:void 0,n=this.wholePart.format(r.wholePart,a,i),l=new I,c=this.fractionPart.format(r.fractionPart,l,i);t.options.includeColors&&(o+=this.visualPart),o+=n,c.length&&((l.placedDigits>0||t.options.legacyCompatibility&&l.placedEscapedCharacters||t.options.legacyCompatibility&&l.placedLiteralDigits)&&(o+=t.constants.decimalSeparator),o+=c)}if(void 0!==s){s.colors.color=this.colors.color,s.colors.customColor=this.colors.customColor,s.colors.customBgColor=this.colors.customBgColor;const o=this.doResolve(new f(t.options,t.formatAbsoluteValue),e);s.effectiveFormat=null!==o?o:void 0}return o}doResolve(t,e){return null!==e||t.nestedFormatter?t.options.includeColors?this.escapedFormat:this.escapedFormatNoVisuals:""}static compile(t,e){const s=function(t,e){const s=t.getColorMatcher(),o=t.getCustomColorMatcher(),r=t.getCustomBgColorMatcher(),a=t.getAnyCustomColorMatcher(),i=new k;let n=e;if(i.colors=m(s,o,r,e),a.lastIndex=0,a.test(n)){const t=n.match(a);if(t){const e=n.search(a),s=e+t[0].length;i.visualPart=t[0],i.visualPart=i.visualPart.replace(/#/g,""),n=n.substring(0,e)+n.substring(s)}}i.bareFormatWithPlaceholders=n;const l=[s,o,r];for(const t of l)for(;t.lastIndex=0,t.test(i.bareFormatWithPlaceholders);){const e=S.ColorPlaceholderStart.codePointAt(0),s=S.ColorPlaceholderEnd.codePointAt(0);if(void 0===e||void 0===s)throw new Error("Unexpected format characters.");const o=e+i.colorPlaceholderValues.length;if(o>s)throw new Error("Too many visual tags. You can specify at most 256 tags.");const r=i.bareFormatWithPlaceholders.match(t);if(r){const e=i.bareFormatWithPlaceholders.search(t),s=e+r[0].length;let a=r[0];a=a.replace(/#/g,""),i.colorPlaceholderValues.push(a),i.bareFormatWithPlaceholders=i.bareFormatWithPlaceholders.substring(0,e)+String.fromCodePoint(o)+i.bareFormatWithPlaceholders.substring(s)}}return i}(t,e);let o="",r="",a=!1,i=!1,n=0;const l=[new E,new E],c=[0,0],h=[new A,new A(!0)],u=[0,0],d=[new M,new M],g=[new T,new T(!0)],f=[[],[]];let p=!1;for(let t=0;t<s.bareFormatWithPlaceholders.length;t++){const e=s.bareFormatWithPlaceholders[t];if(!p&&"\\"===e){p=!0;continue}if("\r"===e||"\n"===e)continue;const m=new S(e,p),C=m.getColorPlaceholderIndex();p=!1,C>=0?(o+=s.colorPlaceholderValues[C],0===n&&(s.colorPlaceholderValues[C]=s.colorPlaceholderValues[C].split("").reverse().join(""))):(o+=e,r+=e),m.isDecimal()?(0===n&&n++,i=!0):(m.isPercent()&&(a=!0),m.isComma()?f[n].push(l[n].length()):(l[n].append(m),c[n]++),d[n].onCharacter(m),g[n].onCharacter(m),m.isPlacement()&&u[n]++,m.isComma()&&(1!==n||c[1])||h[n].onCharacter(m))}p&&(l[n].append(new S("\\")),o+="\\",r+="\\");const C=s.visualPart+o,v=d[0].isMatched()||d[1].isMatched(),P=g[0].scaling()+g[1].scaling();for(let t=0;t<2;t++)if(!v&&0===g[t].scaling())for(let e=f[t].length-1;e>=0;--e)l[t].insert(f[t][e],new S(","));const x=new R(l[0],h[0].count(),u[0]),F=new V(l[1],h[1].count(),u[1]);return new q(0===o.length,C,s.visualPart,r,x,F,s.colorPlaceholderValues,s.colors,a,P,v,i)}}class L{constructor(t){this.matchers=t}splitAlternatives(t){let e="",s=!1;const o=[],r=new u(t,0,t.length);for(;r.hasNext();){const t=r.next();"\\"!==t?";"!==t||s?(e+=t,s=!1):(o.push(e),e=""):(s=!0,e+=t)}return o.push(e),o}truncatedStringLiteral(t){const e=t.search("\0");return e>=0?t.substring(0,e):t}compileFormatter(t){let e,s=this.truncatedStringLiteral(t);s=s.replace(new RegExp(this.matchers.getExcelFormatSuffixMatcher(),"gi"),"");try{if(this.matchers.getArithmeticMatcher().test(s))e=x.compile(this.matchers,this,s);else{const t=this.splitAlternatives(s);e=1!==t.length||this.matchers.getConditionMatcher().test(s)?w.compile(this.matchers,this,t):q.compile(this.matchers,s)}}catch(t){if(!(t=>t instanceof h)(t))throw console.error(t),t;e=q.compile(this.matchers,r)}return new W(e)}}class W extends p{constructor(t){super(),this.decorated=t}doFormat(t,e,s){return null===e?this.decorated.doFormat(t,e,s):Number.isNaN(e)?t.constants.nanString:Number.isFinite(e)?this.decorated.doFormat(t,e,s):e<0?t.constants.negativeInfinity:t.constants.positiveInfinity}doResolve(t,e){return Number.isNaN(e)?"":this.decorated.doResolve(t,e)}}class O{constructor(){this.matchers=new v,this.factory=new L(this.matchers)}compileFormatter(t){return this.factory.compileFormatter(t)}}var G=s(73609);class H{static convertValue(t){return null===t?null:void 0===t?NaN:"number"==typeof t?t:parseFloat(t)}static formatValue(t,e=r,s){const o=new O,n=new a;n.decimalSeparator=null==s?void 0:s.decimal,n.thousandsSeparator=null==s?void 0:s.thousand,n.includeColors=!1;const c=new l;try{let s=H.cache.get(e);s||(s=o.compileFormatter(e),H.cache.set(e,s));const r=s.format(t,n,c);return{colors:new i(c.colors),formattedValue:r,nullConditionFormatter:c.nullConditionFormatter,effectiveFormat:c.effectiveFormat,resolvedFormat:s.resolve(t,n)}}catch(s){c.reset();let a=H.cache.get(r);a||(a=o.compileFormatter(e),H.cache.set(r,a));const l=a.format(t,n,c);return{colors:new i(c.colors),formattedValue:l,nullConditionFormatter:c.nullConditionFormatter,effectiveFormat:c.effectiveFormat,resolvedFormat:a.resolve(t,n)}}}}H.cache=new G.z({max:200})}}]);