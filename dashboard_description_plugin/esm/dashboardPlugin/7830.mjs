(self.webpackChunkdashboard_description_plugin=self.webpackChunkdashboard_description_plugin||[]).push([[7830],{87830:(t,e,o)=>{o.r(e),o.d(e,{ClientColors:()=>i,ClientFormatterFacade:()=>z,DefaultFormat:()=>s,DefaultFormatterFacade:()=>U,FormatOptions:()=>a,ResultColors:()=>n,ResultMetadata:()=>l,colorNameMap:()=>r});const r={black:"#000000",red:"#ff0000",green:"#00aa00",blue:"#0000ff",white:"#ffffff",cyan:"#0092d2",magenta:"#cb006b",yellow:"#fff10d",none:void 0},s="#,##0.00";class a{constructor(t=!0,e=!0,o,r,s,a,i){this.includeColors=!0,this.legacyCompatibility=!0,this.includeColors=t,this.legacyCompatibility=e,this.thousandsSeparator=o,this.decimalSeparator=r,this.nanString=s,this.positiveInfinity=a,this.negativeInfinity=i}}a.DefaultOptions=new a;class i{constructor(t){if(t.customColor&&(this.color=t.customColor.startsWith("#")?t.customColor:"#"+t.customColor),t.color){const e=r[t.color]?r[t.color]:void 0;this.color=e}t.customBgColor&&(this.backgroundColor=t.customBgColor.startsWith("#")?t.customBgColor:"#"+t.customBgColor)}}class n{constructor(t,e,o){this.color=t,this.customColor=e,this.customBgColor=o}reset(){this.color=void 0,this.customColor=void 0,this.customBgColor=void 0}}class l{constructor(t,e,o=!1){this.colors=t||new n,this.effectiveFormat=e,this.nullConditionFormatter=o}reset(){this.colors.reset(),this.effectiveFormat=void 0,this.nullConditionFormatter=!1}}var c=o(97582),h="Invariant Violation",u=Object.setPrototypeOf,m=void 0===u?function(t,e){return t.__proto__=e,t}:u,d=function(t){function e(o){void 0===o&&(o=h);var r=t.call(this,"number"==typeof o?h+": "+o+" (see https://github.com/apollographql/invariant-packages)":o)||this;return r.framesToPop=1,r.name=h,m(r,e.prototype),r}return(0,c.__extends)(e,t),e}(Error);function g(t,e){if(!t)throw new d(e)}var f=["log","warn","error","silent"],p=f.indexOf("log");function C(t){return function(){if(f.indexOf(t)>=p)return console[t].apply(console,arguments)}}!function(t){t.log=C("log"),t.warn=C("warn"),t.error=C("error")}(g||(g={})),"object"==typeof process&&"object"==typeof process.env&&process;class v extends Error{constructor(t){super(t),this.name="InvalidArgumentError",Object.setPrototypeOf(this,new.target.prototype)}}class P{constructor(t,e,o,r=e){this.str=t,this.pos=r,this.begin=e,this.end=o}hasNext(){return this.pos<this.end}hasPrevious(){return this.pos>this.begin}next(){if(this.hasNext()){const t=this.str.charAt(this.pos);return this.pos++,t}return""}previous(){return this.hasPrevious()?(this.pos--,this.str.charAt(this.pos)):""}getIndex(){return this.pos}}function x(t,e,o,r){const s=new n,a=r.match(t);a&&(s.color=a[1].toLowerCase());const i=r.match(e);i&&(s.customColor=i[1].toLowerCase());const l=r.match(o);return l&&(s.customBgColor=l[1].toLowerCase()),s}class F{constructor(t){this.thousandsSeparator=t.thousandsSeparator||F.DefaultThousandSeparator,this.decimalSeparator=t.decimalSeparator||F.DefaultDecimalSeparator,this.nanString=t.nanString||F.DefaultNaNString,this.positiveInfinity=t.positiveInfinity||F.DefaultPositiveInfinity,this.negativeInfinity=t.negativeInfinity||F.DefaultNegativeInfinity}}F.DefaultThousandSeparator=",",F.DefaultDecimalSeparator=".",F.DefaultNaNString="NaN",F.DefaultPositiveInfinity="Infinity",F.DefaultNegativeInfinity="-Infinity";class b{constructor(t,e,o=!1){this.options=t,this.constants=e,this.formatAbsoluteValue=o}toNestedFormatCtx(){return new b(this.options,this.constants,!0)}}class w{constructor(t,e=!1){this.options=t,this.nestedFormatter=e}toNestedFormatCtx(){return new w(this.options,!0)}}class y{format(t,e,o){o&&o.reset();const r=new F(e),s=new b(e,r);return this.doFormat(s,t,o)}resolve(t,e){const o=new w(e);return this.doResolve(o,t)}}class N extends y{constructor(t,e,o){super(),this.literal=t,this.literalNoColors=e,this.colors=o}doFormat(t,e,o){return o&&(o.colors=this.colors,o.effectiveFormat=""),t.options.includeColors?(o&&(o.effectiveFormat=this.literal),this.literal):(o&&(o.effectiveFormat=this.literalNoColors),this.literalNoColors)}doResolve(t,e){return t.options.includeColors?this.literal:this.literalNoColors}static compile(t,e){let o="",r=!1;const s=t.getColorMatcher(),a=t.getCustomColorMatcher(),i=t.getCustomBgColorMatcher();for(const t of e)"\\"===t?r=!0:(r=!1,o+=t);r&&(o+="\\");const n=function(t,e){const o=t.getColorMatcher(),r=t.getAnyCustomColorMatcher();return e.replace(new RegExp(o,"gi"),"").replace(new RegExp(r,"gi"),"")}(t,o),l=x(s,a,i,o);return new N(o,n,l)}}class S{constructor(){this.nullConditionPattern=S.createRegexPattern(S.NullConditionRegex,"i"),this.conditionPattern=S.createRegexPattern(S.ConditionRegex,"i"),this.arithmeticPattern=S.createRegexPattern(S.ArithmeticRegex,"i"),this.colorPattern=S.createRegexPattern(S.ColorRegex,"i"),this.customColorPattern=S.createRegexPattern(S.CustomColorRegex,"i"),this.customBgColorPattern=S.createRegexPattern(S.CustomBackgroundColorRegex,"i"),this.anyCustomColorPattern=S.createRegexPattern(S.AnyCustomColorRegex,"i"),this.excelFormatSuffixPattern=S.createRegexPattern(S.ExcelFormatSuffixRegex)}static createRegexPattern(t,e){return e?new RegExp(t.source,e):t}getNullConditionMatcher(){return this.nullConditionPattern}getConditionMatcher(){return this.conditionPattern}getArithmeticMatcher(){return new RegExp(this.arithmeticPattern,"g")}getColorMatcher(){return this.colorPattern}getCustomColorMatcher(){return this.customColorPattern}getCustomBgColorMatcher(){return this.customBgColorPattern}getAnyCustomColorMatcher(){return this.anyCustomColorPattern}getExcelFormatSuffixMatcher(){return this.excelFormatSuffixPattern}static group(t,e){if(t&&e>=0&&e<t.length){const o=t[e];if(void 0===o)return{value:o,startIndex:-1,endIndex:-1};const r=t.index+t[0].indexOf(o);return{value:o,startIndex:r,endIndex:r+o.length}}throw new Error(`Group ${e} not found in the regex match.`)}}S.NullConditionRegex=/\[=null\]/i,S.ConditionRegex=/\[(>=|<=|[=><])(-?[0-9.]+|null)\]/i,S.ArithmeticRegex=/\{\{\{([0-9]*(?:\.[0-9]*)?)\|([0-9]*)(\.)?\|(.*?)\}\}\}/,S.ColorRegex=/\[(black|blue|cyan|green|magenta|red|white|yellow|none)\]/i,S.CustomColorRegex=/\[color=#*([A-F0-9]+)\]/i,S.CustomBackgroundColorRegex=/\[backgroundColor=#*([A-F0-9]+)\]/i,S.AnyCustomColorRegex=/(\[(?:backgroundColor|color)=#*[A-Fa-f0-9]+\])+/,S.ExcelFormatSuffixRegex=/\[excel\]([\s\S])*$/i;class E extends y{constructor(t,e,o,r){super(),this.divisor=o,this.modulo=r,this.trimFraction=e,this.formatter=t}doFormat(t,e,o){let r=e||0;return void 0!==this.divisor&&(r/=this.divisor),void 0!==this.modulo&&(r%=this.modulo),this.trimFraction&&(Number.isNaN(r)||!Number.isFinite(r)?r=0:r<0?(r=-1*Math.floor(-1*r),Object.is(r,-0)&&(r=0)):r=Math.floor(r)),this.formatter.doFormat(t,r,o)}doResolve(t,e){return null}}class D extends y{static doubleTostring(t){return Number.parseFloat(t)}constructor(t,e){super(),this.baseFormat=t,this.expressions=e}doFormat(t,e,o){const r=t.toNestedFormatCtx(),s=this.baseFormat.doFormat(r,e,o||void 0);let a="";const i=new P(s,0,s.length);for(;i.hasNext();){const t=i.next(),s=t.charCodeAt(0);if(s>=D.ExpressionPlaceholderStart&&s<=D.ExpressionPlaceholderEnd){const i=s-D.ExpressionPlaceholderStart;if(i>=this.expressions.length)a+=t;else{const t=new l;a+=this.expressions[i].doFormat(r,e,void 0!==o?t:void 0),void 0!==o&&(o.colors.color||(o.colors.color=t.colors.color),o.colors.customColor||(o.colors.customColor=t.colors.customColor),o.colors.customBgColor||(o.colors.customBgColor=t.colors.customBgColor))}}else a+=t}return void 0!==o&&(o.effectiveFormat=void 0),a}static compile(t,e,o){const r=t.getArithmeticMatcher();let s="";const a=[];let i,n=0;for(;null!==(i=r.exec(o));){const t=i.index,c=r.lastIndex;s+=o.substring(n,t),n=c;const h=D.ExpressionPlaceholderStart+a.length;if(h>D.ExpressionPlaceholderEnd)throw new v("Too many arithmetic expressions. You can specify at most 256 expressions.");const u=R(S.group(i,1).value,D.doubleTostring),m=R(S.group(i,2).value,D.doubleTostring),d=!(l=S.group(i,3).value)||0===l.length,g=S.group(i,4).value;s+=String.fromCodePoint(h),a.push(new E(e.compileFormatter(g),d,u,m))}var l;return s+=o.substring(n),g(0!==a.length,"No arithmetic expressions found in the format string."),new D(e.compileFormatter(s),a)}doResolve(t,e){return null}}function R(t,e){if(!t.length)return;const o=e(t);return Number.isNaN(o)?void 0:o}D.ExpressionPlaceholderStart=57344,D.ExpressionPlaceholderEnd=57599;class I{constructor(t,e,o){this.op=t,this.rhs=e,this.formatter=o,g(null!==e||"Equal"===t)}isNullAlternative(){return null===this.rhs}evaluate(t,e){if(null===t){if(null===this.rhs)return!0;if(!e)return!1;switch(this.op){case"Equal":default:return!1;case"WeakEqual":return 0===this.rhs;case"LessThan":return this.rhs>0;case"LessThanOrEqual":return this.rhs>=0;case"GreaterThan":return this.rhs<0;case"GreaterThanOrEqual":return this.rhs<=0}}switch(this.op){case"Equal":case"WeakEqual":return null!==this.rhs&&t===this.rhs;case"GreaterThan":return null!==this.rhs&&t>this.rhs;case"GreaterThanOrEqual":return null!==this.rhs&&t>=this.rhs;case"LessThan":return null!==this.rhs&&t<this.rhs;case"LessThanOrEqual":return null!==this.rhs&&t<=this.rhs;default:return!1}}doFormat(t,e,o){return this.formatter.doFormat(t,e,o)}doResolve(t,e){return this.formatter.doResolve(t,e)}}class V extends y{constructor(t,e){super(),this.alternatives=t,this.catchall=e}static doubleToString(t){return parseFloat(t)}static compile(t,e,o){const r=t.getConditionMatcher();let a=s;const i=[],n=[];let l=0;for(const s of o){let o;if(r.lastIndex=0,null!==(o=r.exec(s))){const r=S.group(o,0),a=r.startIndex,l=r.endIndex,c=M(S.group(o,1).value),h=A(S.group(o,2).value,V.doubleToString);if(null===h.maybeValue&&"Equal"!==c)continue;let u;0===a?u=s.substring(l):(u=s.substring(0,a),u+=s.substring(l)),"Equal"===c?null!==h.maybeValue?0===h.maybeValue&&h.inputHadDecimals?i.push(new I("WeakEqual",h.maybeValue,e.compileFormatter(u))):i.push(new I(c,h.maybeValue,e.compileFormatter(u))):i.push(new I(c,h.maybeValue,N.compile(t,u))):n.push(new I(c,h.maybeValue,e.compileFormatter(u)))}else{switch(l){case 0:a=s,n.push(new I("GreaterThanOrEqual",0,e.compileFormatter(s)));break;case 1:n.push(new I("LessThan",0,e.compileFormatter(s)));break;case 2:i.push(new I("Equal",0,e.compileFormatter(s)));break;default:throw new v("Too many semicolons in the format string.")}l++}}return new V(i.concat(n),e.compileFormatter(a))}doFormat(t,e,o){const r=t.toNestedFormatCtx();for(const t of this.alternatives)if(t.evaluate(e,r.options.legacyCompatibility))return void 0!==o&&t.isNullAlternative()&&(o.nullConditionFormatter=!0),t.doFormat(r,e,o);return this.catchall.doFormat(r,e,o)}doResolve(t,e){let o=null;const r=t.toNestedFormatCtx();let s=!1,a=!1;for(const i of this.alternatives)if(i.evaluate(e,t.options.legacyCompatibility)){s=!0,a=i.isNullAlternative(),o=i.doResolve(r,e);break}return s||(o=this.catchall.doResolve(r,e)),null===o?"":a||t.nestedFormatter?o:`${o};${o}`}}function M(t){if("="===t)return"Equal";if(">"===t)return"GreaterThan";if(">="===t)return"GreaterThanOrEqual";if("<"===t)return"LessThan";if("<="===t)return"LessThanOrEqual";throw new v("Unsupported operator.")}function A(t,e){const o=e(t),r={maybeValue:null,inputHadDecimals:t.indexOf(".")>-1};return Number.isNaN(o)||(r.maybeValue=o),r}class T{constructor(t,e=!1){this.c=t,this.escaped=e}toString(){return this.c}isEscaped(){return this.escaped}isPlacement(){return!this.escaped&&("0"===this.c||"#"===this.c||"?"===this.c)}isZeroPlacement(){return!this.escaped&&"0"===this.c}isHashPlacement(){return!this.escaped&&"#"===this.c}isQPlacement(){return!this.escaped&&"?"===this.c}isDigit(){return this.c>="1"&&this.c<="9"}isComma(){return!this.escaped&&","===this.c}isDecimal(){return!this.escaped&&"."===this.c}isPercent(){return!this.escaped&&"%"===this.c}getColorPlaceholderIndex(){const t=this.c.codePointAt(0),e=T.ColorPlaceholderStart.codePointAt(0),o=T.ColorPlaceholderEnd.codePointAt(0);return void 0!==t&&void 0!==e&&void 0!==o&&t>=e&&t<=o?t-e:-1}}T.ColorPlaceholderStart="",T.ColorPlaceholderEnd="";class k{constructor(){this.vec=[]}append(t){this.vec.push(t)}insert(t,e){this.vec.splice(t,0,e)}getVec(){return this.vec.slice()}length(){return this.vec.length}}class O{constructor(t,e,o){this.formatString=t,this.digits=e,this.placements=o}getDigits(){return this.digits}getPlacements(){return this.placements}}class B extends O{format(t,e,o){const r="-"===t.charAt(0),s=new P(t,r?1:0,t.length,t.length),a=this.formatString.getVec().reverse();let i="",n=this.getPlacements(),l=this.getDigits(),c=0;const h=e.length>0,u="-"!==e.charAt(0)?e:"0";for(;a.length>0&&(s.hasPrevious()||l)&&n;){const t=a.shift();if(void 0===t)break;const e=t.getColorPlaceholderIndex();if(e>=0){if(null==o||o.length<e)continue;i+=o[e]}else if(t.isPlacement()){if(h&&3===c)i+=u,c=0;else{let t;t=s.hasPrevious()?s.previous():"0",i+=t,c++,l&&l--}n--}else i+=t}for(;s.hasPrevious()||l;)h&&3===c?(i+=u,c=0):s.hasPrevious()?(i+=s.previous(),c++,l&&l--):(i+="0",c++,l--);for(r&&(i+="-");a.length>0;){const t=a.shift();if(void 0===t)break;const e=t.getColorPlaceholderIndex();if(e>=0){if(null==o||o.length<e)continue;i+=o[e]}else t.isHashPlacement()||(t.isQPlacement()?i+=" ":i+=t)}return i.split("").reverse().join("")}}B.NoThousandsSeparators="";class q{constructor(){this.placedDigits=0,this.placedLiteralDigits=0,this.placedEscapedCharacters=0}}class L extends O{format(t,e,o=null){if(!this.digits)return"";const r=this.formatString.getVec().slice(),s=new P(t,0,t.length);let a=this.digits,i=0,n=0,l=0,c="",h="";for(;a;){const t=r.shift();g(t.isPlacement());const e=s.hasNext()?s.next():"0";g(!isNaN(Number(e)),"Fraction part should only include digits"),t.isHashPlacement()&&"0"===e?h+=e:(c+=h,i+=h.length,h="",c+=e,i++),a--}for(this.placements>this.digits&&(c+=h,i+=h.length,h="");r.length>0;){const t=r.shift(),e=t.getColorPlaceholderIndex();if(e>=0){if(null===o||o.length<=e)continue;c+=o[e]}else t.isHashPlacement()||(t.isQPlacement()?c+=" ":(l+=t.isEscaped()?1:0,n+=t.isDigit()?1:0,c+=t.toString()))}return e.placedDigits=i,e.placedLiteralDigits=n,e.placedEscapedCharacters=l,c}}class W{constructor(){this.state="Null"}onCharacter(t){switch(this.state){case"Matched":break;case"Null":t.isPlacement()&&(this.state="HasPlacementChar");break;case"HasPlacementChar":t.isPlacement()?this.state="HasPlacementChar":t.isComma()?this.state="HasComma":this.state="Null";break;case"HasComma":t.isPlacement()?this.state="Matched":this.state="Null"}}isMatched(){return"Matched"===this.state}}class H{constructor(t=!1){this.counter=0,this.state=t?"ExpectingAnyPlacement":"WaitingForZero"}onCharacter(t){switch(this.state){case"Done":break;case"ExpectingAnyPlacement":t.isPlacement()?(this.state="CountingDigits",this.counter++):this.state="Done";break;case"WaitingForZero":t.isZeroPlacement()&&(this.state="CountingDigits",this.counter++);break;case"CountingDigits":t.isPlacement()?this.counter++:this.state="Done"}}count(){return this.counter}}class _{constructor(t=!1){this.scalingValue=0;const e=t?"Null":"CommasExpected";this.initialState=e,this.state=e}onCharacter(t){switch(this.state){case"Null":t.isPlacement()&&(this.state="CommasExpected");break;case"CommasExpected":t.isComma()?(this.state="CollectScaling",this.scalingValue++):t.isPlacement()||(this.state=this.initialState,this.scalingValue=0);break;case"CollectScaling":t.isComma()?this.scalingValue++:t.isPlacement()?(this.scalingValue--,this.state=this.scalingValue?"Done":"CommasExpected"):this.state="Done"}}scaling(){return this.scalingValue}}class j{constructor(){this.visualPart="",this.bareFormatWithPlaceholders="",this.colorPlaceholderValues=[],this.colors=new n}}class G{constructor(t){this.thousandsSeparator=t.thousandsSeparator||G.DefaultThousandSeparator,this.decimalSeparator=t.decimalSeparator||G.DefaultDecimalSeparator,this.nanString=t.nanString||G.DefaultNaNString,this.positiveInfinity=t.positiveInfinity||G.DefaultPositiveInfinity,this.negativeInfinity=t.negativeInfinity||G.DefaultNegativeInfinity}}G.DefaultThousandSeparator=",",G.DefaultDecimalSeparator=".",G.DefaultNaNString="NaN",G.DefaultPositiveInfinity="Infinity",G.DefaultNegativeInfinity="-Infinity";class $ extends y{constructor(t,e,o,r,s,a,i,n,l,c,h,u){super(),this.effectivelyEmpty=t,this.escapedFormat=e,this.visualPart=o,this.escapedFormatNoVisuals=r,this.wholePart=s,this.fractionPart=a,this.colorPlaceholderValues=i,this.colors=n,this.percent=l,this.scaling=c,this.thousandsSeparators=h,this.hasDecimal=u}static doubleToString(t,e){const o=Object.is(t,-0),r=t.toFixed(e);return o?"-"+r:r}static leftPad(t,e,o){return String(t).padStart(e,o)}static roundInternal(t,e){if(e>0){const o=Math.min(e+10,20),r=new RegExp("(-?\\d*)\\.(\\d{"+e+"})(\\d)\\d*$"),s=t.toFixed(o).match(r);if(null==s?void 0:s.length){const t="-"===s[1].charAt(0)?-1:1,o=$.leftPad(Math.round(s[2]+"."+s[3]),e,"0");return o.length>e?Number(s[1])+t:Number(s[1]+"."+o)}}return t}static round(t,e){if(0===e){const e=t<0?-1:1;return Math.round(t*e)*e}return $.roundInternal(t,e)}static numberHasValue(t){return null!=t}prepareValueToFormat(t){let e=t;this.percent&&(e*=100);for(let t=0;t<this.scaling;t++)e/=1e3;const o=Math.min(20,this.fractionPart.getDigits());e=$.round(e,o);const r=$.doubleToString(e,o);let s="",a="";if(""===r)return{valueToFormat:e,wholePart:s,fractionPart:a};if(this.fractionPart.getDigits()){const t=r.indexOf(".");g(-1!==t,"Decimal separator not found in the numberString."),s=r.substring(0,t),a=r.substring(t+1)}else s=r,a="";return 0===this.wholePart.getDigits()?"0"===s?s="":"-0"===s&&(s=this.hasDecimal?"-":""):this.hasDecimal||"-0"!==s||(s="0"),{valueToFormat:e,wholePart:s,fractionPart:a}}isLiteral(){return this.wholePart.getPlacements()+this.fractionPart.getPlacements()===0}doFormat(t,e,o){let r="";if(null===e);else if(!this.effectivelyEmpty&&this.isLiteral())r=t.options.includeColors?this.escapedFormat:this.escapedFormatNoVisuals;else{let o=e;t.formatAbsoluteValue&&$.numberHasValue(e)&&(o=Math.abs(e));const s=this.prepareValueToFormat(o),a=this.thousandsSeparators?t.constants.thousandsSeparator:B.NoThousandsSeparators,i=t.options.includeColors?this.colorPlaceholderValues:void 0,n=this.wholePart.format(s.wholePart,a,i),l=new q,c=this.fractionPart.format(s.fractionPart,l,i);t.options.includeColors&&(r+=this.visualPart),r+=n,c.length&&((l.placedDigits>0||t.options.legacyCompatibility&&l.placedEscapedCharacters||t.options.legacyCompatibility&&l.placedLiteralDigits)&&(r+=t.constants.decimalSeparator),r+=c)}if(void 0!==o){o.colors.color=this.colors.color,o.colors.customColor=this.colors.customColor,o.colors.customBgColor=this.colors.customBgColor;const r=this.doResolve(new w(t.options,t.formatAbsoluteValue),e);o.effectiveFormat=null!==r?r:void 0}return r}doResolve(t,e){return null!==e||t.nestedFormatter?t.options.includeColors?this.escapedFormat:this.escapedFormatNoVisuals:""}static compile(t,e){const o=function(t,e){const o=t.getColorMatcher(),r=t.getCustomColorMatcher(),s=t.getCustomBgColorMatcher(),a=t.getAnyCustomColorMatcher(),i=new j;let n=e;if(i.colors=x(o,r,s,e),a.lastIndex=0,a.test(n)){const t=n.match(a);if(t){const e=n.search(a),o=e+t[0].length;i.visualPart=t[0],i.visualPart=i.visualPart.replace(/#/g,""),n=n.substring(0,e)+n.substring(o)}}i.bareFormatWithPlaceholders=n;const l=[o,r,s];for(const t of l)for(;t.lastIndex=0,t.test(i.bareFormatWithPlaceholders);){const e=T.ColorPlaceholderStart.codePointAt(0),o=T.ColorPlaceholderEnd.codePointAt(0);if(void 0===e||void 0===o)throw new Error("Unexpected format characters.");const r=e+i.colorPlaceholderValues.length;if(r>o)throw new Error("Too many visual tags. You can specify at most 256 tags.");const s=i.bareFormatWithPlaceholders.match(t);if(s){const e=i.bareFormatWithPlaceholders.search(t),o=e+s[0].length;let a=s[0];a=a.replace(/#/g,""),i.colorPlaceholderValues.push(a),i.bareFormatWithPlaceholders=i.bareFormatWithPlaceholders.substring(0,e)+String.fromCodePoint(r)+i.bareFormatWithPlaceholders.substring(o)}}return i}(t,e);let r="",s="",a=!1,i=!1,n=0;const l=[new k,new k],c=[0,0],h=[new H,new H(!0)],u=[0,0],m=[new W,new W],d=[new _,new _(!0)],g=[[],[]];let f=!1;for(let t=0;t<o.bareFormatWithPlaceholders.length;t++){const e=o.bareFormatWithPlaceholders[t];if(!f&&"\\"===e){f=!0;continue}if("\r"===e||"\n"===e)continue;const p=new T(e,f),C=p.getColorPlaceholderIndex();f=!1,C>=0?(r+=o.colorPlaceholderValues[C],0===n&&(o.colorPlaceholderValues[C]=o.colorPlaceholderValues[C].split("").reverse().join(""))):(r+=e,s+=e),p.isDecimal()?(0===n&&n++,i=!0):(p.isPercent()&&(a=!0),p.isComma()?g[n].push(l[n].length()):(l[n].append(p),c[n]++),m[n].onCharacter(p),d[n].onCharacter(p),p.isPlacement()&&u[n]++,p.isComma()&&(1!==n||c[1])||h[n].onCharacter(p))}f&&(l[n].append(new T("\\")),r+="\\",s+="\\");const p=o.visualPart+r,C=m[0].isMatched()||m[1].isMatched(),v=d[0].scaling()+d[1].scaling();for(let t=0;t<2;t++)if(!C&&0===d[t].scaling())for(let e=g[t].length-1;e>=0;--e)l[t].insert(g[t][e],new T(","));const P=new B(l[0],h[0].count(),u[0]),F=new L(l[1],h[1].count(),u[1]);return new $(0===r.length,p,o.visualPart,s,P,F,o.colorPlaceholderValues,o.colors,a,v,C,i)}}class Z{constructor(t){this.matchers=t}splitAlternatives(t){let e="",o=!1;const r=[],s=new P(t,0,t.length);for(;s.hasNext();){const t=s.next();"\\"!==t?";"!==t||o?(e+=t,o=!1):(r.push(e),e=""):(o=!0,e+=t)}return r.push(e),r}truncatedStringLiteral(t){const e=t.search("\0");return e>=0?t.substring(0,e):t}compileFormatter(t){let e,o=this.truncatedStringLiteral(t);o=o.replace(new RegExp(this.matchers.getExcelFormatSuffixMatcher(),"gi"),"");try{if(this.matchers.getArithmeticMatcher().test(o))e=D.compile(this.matchers,this,o);else{const t=this.splitAlternatives(o);e=1!==t.length||this.matchers.getConditionMatcher().test(o)?V.compile(this.matchers,this,t):$.compile(this.matchers,o)}}catch(t){if(!(t=>t instanceof v)(t))throw console.error(t),t;e=$.compile(this.matchers,s)}return new Q(e)}}class Q extends y{constructor(t){super(),this.decorated=t}doFormat(t,e,o){return null===e?this.decorated.doFormat(t,e,o):Number.isNaN(e)?t.constants.nanString:Number.isFinite(e)?this.decorated.doFormat(t,e,o):e<0?t.constants.negativeInfinity:t.constants.positiveInfinity}doResolve(t,e){return Number.isNaN(e)?"":this.decorated.doResolve(t,e)}}class U{constructor(){this.matchers=new S,this.factory=new Z(this.matchers)}compileFormatter(t){return this.factory.compileFormatter(t)}}var Y=o(73609);class z{static convertValue(t){return null===t?null:void 0===t?NaN:"number"==typeof t?t:parseFloat(t)}static formatValue(t,e=s,o){const r=new U,n=new a;n.decimalSeparator=null==o?void 0:o.decimal,n.thousandsSeparator=null==o?void 0:o.thousand,n.includeColors=!1;const c=new l;try{let o=z.cache.get(e);o||(o=r.compileFormatter(e),z.cache.set(e,o));const s=o.format(t,n,c);return{colors:new i(c.colors),formattedValue:s,nullConditionFormatter:c.nullConditionFormatter,effectiveFormat:c.effectiveFormat,resolvedFormat:o.resolve(t,n)}}catch(o){c.reset();let a=z.cache.get(s);a||(a=r.compileFormatter(e),z.cache.set(s,a));const l=a.format(t,n,c);return{colors:new i(c.colors),formattedValue:l,nullConditionFormatter:c.nullConditionFormatter,effectiveFormat:c.effectiveFormat,resolvedFormat:a.resolve(t,n)}}}}z.cache=new Y.z({max:200})}}]);