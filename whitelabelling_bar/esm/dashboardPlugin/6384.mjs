(self.webpackChunkwhitelabelling_bar=self.webpackChunkwhitelabelling_bar||[]).push([[6384],{30998:(t,e,r)=>{var o=r(41848),s=r(67206),i=r(40554),a=Math.max;t.exports=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var l=null==r?0:i(r);return l<0&&(l=a(n+l,0)),o(t,s(e,3),l)}},49016:(t,e,r)=>{r.d(e,{X:()=>z});var o=r(73609),s=r(97582),i="Invariant Violation",a=Object.setPrototypeOf,n=void 0===a?function(t,e){return t.__proto__=e,t}:a,l=function(t){function e(r){void 0===r&&(r=i);var o=t.call(this,"number"==typeof r?i+": "+r+" (see https://github.com/apollographql/invariant-packages)":r)||this;return o.framesToPop=1,o.name=i,n(o,e.prototype),o}return(0,s.__extends)(e,t),e}(Error);function c(t,e){if(!t)throw new l(e)}var h=["log","warn","error","silent"],u=h.indexOf("log");function m(t){return function(){if(h.indexOf(t)>=u)return console[t].apply(console,arguments)}}!function(t){t.log=m("log"),t.warn=m("warn"),t.error=m("error")}(c||(c={})),"object"==typeof process&&"object"==typeof process.env&&process;const d={black:"#000000",red:"#ff0000",green:"#00aa00",blue:"#0000ff",white:"#ffffff",cyan:"#0092d2",magenta:"#cb006b",yellow:"#fff10d",none:void 0},g="#,##0.00";class f{constructor(t=!0,e=!0,r,o,s,i,a){this.includeColors=!0,this.legacyCompatibility=!0,this.includeColors=t,this.legacyCompatibility=e,this.thousandsSeparator=r,this.decimalSeparator=o,this.nanString=s,this.positiveInfinity=i,this.negativeInfinity=a}}f.DefaultOptions=new f;class p{constructor(t){if(t.customColor&&(this.color=t.customColor.startsWith("#")?t.customColor:"#"+t.customColor),t.color){const e=d[t.color]?d[t.color]:void 0;this.color=e}t.customBgColor&&(this.backgroundColor=t.customBgColor.startsWith("#")?t.customBgColor:"#"+t.customBgColor)}}class C{constructor(t,e,r){this.color=t,this.customColor=e,this.customBgColor=r}reset(){this.color=void 0,this.customColor=void 0,this.customBgColor=void 0}}class v{constructor(t,e,r=!1){this.colors=t||new C,this.effectiveFormat=e,this.nullConditionFormatter=r}reset(){this.colors.reset(),this.effectiveFormat=void 0,this.nullConditionFormatter=!1}}class P extends Error{constructor(t){super(t),this.name="InvalidArgumentError",Object.setPrototypeOf(this,new.target.prototype)}}class x{constructor(t,e,r,o=e){this.str=t,this.pos=o,this.begin=e,this.end=r}hasNext(){return this.pos<this.end}hasPrevious(){return this.pos>this.begin}next(){if(this.hasNext()){const t=this.str.charAt(this.pos);return this.pos++,t}return""}previous(){return this.hasPrevious()?(this.pos--,this.str.charAt(this.pos)):""}getIndex(){return this.pos}}function b(t,e,r,o){const s=new C,i=o.match(t);i&&(s.color=i[1].toLowerCase());const a=o.match(e);a&&(s.customColor=a[1].toLowerCase());const n=o.match(r);return n&&(s.customBgColor=n[1].toLowerCase()),s}class F{constructor(t){this.thousandsSeparator=t.thousandsSeparator||F.DefaultThousandSeparator,this.decimalSeparator=t.decimalSeparator||F.DefaultDecimalSeparator,this.nanString=t.nanString||F.DefaultNaNString,this.positiveInfinity=t.positiveInfinity||F.DefaultPositiveInfinity,this.negativeInfinity=t.negativeInfinity||F.DefaultNegativeInfinity}}F.DefaultThousandSeparator=",",F.DefaultDecimalSeparator=".",F.DefaultNaNString="NaN",F.DefaultPositiveInfinity="Infinity",F.DefaultNegativeInfinity="-Infinity";class w{constructor(t,e,r=!1){this.options=t,this.constants=e,this.formatAbsoluteValue=r}toNestedFormatCtx(){return new w(this.options,this.constants,!0)}}class y{constructor(t,e=!1){this.options=t,this.nestedFormatter=e}toNestedFormatCtx(){return new y(this.options,!0)}}class N{format(t,e,r){r&&r.reset();const o=new F(e),s=new w(e,o);return this.doFormat(s,t,r)}resolve(t,e){const r=new y(e);return this.doResolve(r,t)}}class S extends N{constructor(t,e,r){super(),this.literal=t,this.literalNoColors=e,this.colors=r}doFormat(t,e,r){return r&&(r.colors=this.colors,r.effectiveFormat=""),t.options.includeColors?(r&&(r.effectiveFormat=this.literal),this.literal):(r&&(r.effectiveFormat=this.literalNoColors),this.literalNoColors)}doResolve(t,e){return t.options.includeColors?this.literal:this.literalNoColors}static compile(t,e){let r="",o=!1;const s=t.getColorMatcher(),i=t.getCustomColorMatcher(),a=t.getCustomBgColorMatcher();for(const t of e)"\\"===t?o=!0:(o=!1,r+=t);o&&(r+="\\");const n=function(t,e){const r=t.getColorMatcher(),o=t.getAnyCustomColorMatcher();return e.replace(new RegExp(r,"gi"),"").replace(new RegExp(o,"gi"),"")}(t,r),l=b(s,i,a,r);return new S(r,n,l)}}class E{constructor(){this.nullConditionPattern=E.createRegexPattern(E.NullConditionRegex,"i"),this.conditionPattern=E.createRegexPattern(E.ConditionRegex,"i"),this.arithmeticPattern=E.createRegexPattern(E.ArithmeticRegex,"i"),this.colorPattern=E.createRegexPattern(E.ColorRegex,"i"),this.customColorPattern=E.createRegexPattern(E.CustomColorRegex,"i"),this.customBgColorPattern=E.createRegexPattern(E.CustomBackgroundColorRegex,"i"),this.anyCustomColorPattern=E.createRegexPattern(E.AnyCustomColorRegex,"i"),this.excelFormatSuffixPattern=E.createRegexPattern(E.ExcelFormatSuffixRegex)}static createRegexPattern(t,e){return e?new RegExp(t.source,e):t}getNullConditionMatcher(){return this.nullConditionPattern}getConditionMatcher(){return this.conditionPattern}getArithmeticMatcher(){return new RegExp(this.arithmeticPattern,"g")}getColorMatcher(){return this.colorPattern}getCustomColorMatcher(){return this.customColorPattern}getCustomBgColorMatcher(){return this.customBgColorPattern}getAnyCustomColorMatcher(){return this.anyCustomColorPattern}getExcelFormatSuffixMatcher(){return this.excelFormatSuffixPattern}static group(t,e){if(t&&e>=0&&e<t.length){const r=t[e];if(void 0===r)return{value:r,startIndex:-1,endIndex:-1};const o=t.index+t[0].indexOf(r);return{value:r,startIndex:o,endIndex:o+r.length}}throw new Error(`Group ${e} not found in the regex match.`)}}E.NullConditionRegex=/\[=null\]/i,E.ConditionRegex=/\[(>=|<=|[=><])(-?[0-9.]+|null)\]/i,E.ArithmeticRegex=/\{\{\{([0-9]*(?:\.[0-9]*)?)\|([0-9]*)(\.)?\|(.*?)\}\}\}/,E.ColorRegex=/\[(black|blue|cyan|green|magenta|red|white|yellow|none)\]/i,E.CustomColorRegex=/\[color=#*([A-F0-9]+)\]/i,E.CustomBackgroundColorRegex=/\[backgroundColor=#*([A-F0-9]+)\]/i,E.AnyCustomColorRegex=/(\[(?:backgroundColor|color)=#*[A-Fa-f0-9]+\])+/,E.ExcelFormatSuffixRegex=/\[excel\]([\s\S])*$/i;class D extends N{constructor(t,e,r,o){super(),this.divisor=r,this.modulo=o,this.trimFraction=e,this.formatter=t}doFormat(t,e,r){let o=e||0;return void 0!==this.divisor&&(o/=this.divisor),void 0!==this.modulo&&(o%=this.modulo),this.trimFraction&&(Number.isNaN(o)||!Number.isFinite(o)?o=0:o<0?(o=-1*Math.floor(-1*o),Object.is(o,-0)&&(o=0)):o=Math.floor(o)),this.formatter.doFormat(t,o,r)}doResolve(t,e){return null}}class I extends N{static doubleTostring(t){return Number.parseFloat(t)}constructor(t,e){super(),this.baseFormat=t,this.expressions=e}doFormat(t,e,r){const o=t.toNestedFormatCtx(),s=this.baseFormat.doFormat(o,e,r||void 0);let i="";const a=new x(s,0,s.length);for(;a.hasNext();){const t=a.next(),s=t.charCodeAt(0);if(s>=I.ExpressionPlaceholderStart&&s<=I.ExpressionPlaceholderEnd){const a=s-I.ExpressionPlaceholderStart;if(a>=this.expressions.length)i+=t;else{const t=new v;i+=this.expressions[a].doFormat(o,e,void 0!==r?t:void 0),void 0!==r&&(r.colors.color||(r.colors.color=t.colors.color),r.colors.customColor||(r.colors.customColor=t.colors.customColor),r.colors.customBgColor||(r.colors.customBgColor=t.colors.customBgColor))}}else i+=t}return void 0!==r&&(r.effectiveFormat=void 0),i}static compile(t,e,r){const o=t.getArithmeticMatcher();let s="";const i=[];let a,n=0;for(;null!==(a=o.exec(r));){const t=a.index,c=o.lastIndex;s+=r.substring(n,t),n=c;const h=I.ExpressionPlaceholderStart+i.length;if(h>I.ExpressionPlaceholderEnd)throw new P("Too many arithmetic expressions. You can specify at most 256 expressions.");const u=R(E.group(a,1).value,I.doubleTostring),m=R(E.group(a,2).value,I.doubleTostring),d=!(l=E.group(a,3).value)||0===l.length,g=E.group(a,4).value;s+=String.fromCodePoint(h),i.push(new D(e.compileFormatter(g),d,u,m))}var l;return s+=r.substring(n),c(0!==i.length,"No arithmetic expressions found in the format string."),new I(e.compileFormatter(s),i)}doResolve(t,e){return null}}function R(t,e){if(!t.length)return;const r=e(t);return Number.isNaN(r)?void 0:r}I.ExpressionPlaceholderStart=57344,I.ExpressionPlaceholderEnd=57599;class V{constructor(t,e,r){this.op=t,this.rhs=e,this.formatter=r,c(null!==e||"Equal"===t)}isNullAlternative(){return null===this.rhs}evaluate(t,e){if(null===t){if(null===this.rhs)return!0;if(!e)return!1;switch(this.op){case"Equal":default:return!1;case"WeakEqual":return 0===this.rhs;case"LessThan":return this.rhs>0;case"LessThanOrEqual":return this.rhs>=0;case"GreaterThan":return this.rhs<0;case"GreaterThanOrEqual":return this.rhs<=0}}switch(this.op){case"Equal":case"WeakEqual":return null!==this.rhs&&t===this.rhs;case"GreaterThan":return null!==this.rhs&&t>this.rhs;case"GreaterThanOrEqual":return null!==this.rhs&&t>=this.rhs;case"LessThan":return null!==this.rhs&&t<this.rhs;case"LessThanOrEqual":return null!==this.rhs&&t<=this.rhs;default:return!1}}doFormat(t,e,r){return this.formatter.doFormat(t,e,r)}doResolve(t,e){return this.formatter.doResolve(t,e)}}class M extends N{constructor(t,e){super(),this.alternatives=t,this.catchall=e}static doubleToString(t){return parseFloat(t)}static compile(t,e,r){const o=t.getConditionMatcher();let s=g;const i=[],a=[];let n=0;for(const l of r){let r;if(o.lastIndex=0,null!==(r=o.exec(l))){const o=E.group(r,0),s=o.startIndex,n=o.endIndex,c=A(E.group(r,1).value),h=T(E.group(r,2).value,M.doubleToString);if(null===h.maybeValue&&"Equal"!==c)continue;let u;0===s?u=l.substring(n):(u=l.substring(0,s),u+=l.substring(n)),"Equal"===c?null!==h.maybeValue?0===h.maybeValue&&h.inputHadDecimals?i.push(new V("WeakEqual",h.maybeValue,e.compileFormatter(u))):i.push(new V(c,h.maybeValue,e.compileFormatter(u))):i.push(new V(c,h.maybeValue,S.compile(t,u))):a.push(new V(c,h.maybeValue,e.compileFormatter(u)))}else{switch(n){case 0:s=l,a.push(new V("GreaterThanOrEqual",0,e.compileFormatter(l)));break;case 1:a.push(new V("LessThan",0,e.compileFormatter(l)));break;case 2:i.push(new V("Equal",0,e.compileFormatter(l)));break;default:throw new P("Too many semicolons in the format string.")}n++}}return new M(i.concat(a),e.compileFormatter(s))}doFormat(t,e,r){const o=t.toNestedFormatCtx();for(const t of this.alternatives)if(t.evaluate(e,o.options.legacyCompatibility))return void 0!==r&&t.isNullAlternative()&&(r.nullConditionFormatter=!0),t.doFormat(o,e,r);return this.catchall.doFormat(o,e,r)}doResolve(t,e){let r=null;const o=t.toNestedFormatCtx();let s=!1,i=!1;for(const a of this.alternatives)if(a.evaluate(e,t.options.legacyCompatibility)){s=!0,i=a.isNullAlternative(),r=a.doResolve(o,e);break}return s||(r=this.catchall.doResolve(o,e)),null===r?"":i||t.nestedFormatter?r:`${r};${r}`}}function A(t){if("="===t)return"Equal";if(">"===t)return"GreaterThan";if(">="===t)return"GreaterThanOrEqual";if("<"===t)return"LessThan";if("<="===t)return"LessThanOrEqual";throw new P("Unsupported operator.")}function T(t,e){const r=e(t),o={maybeValue:null,inputHadDecimals:t.indexOf(".")>-1};return Number.isNaN(r)||(o.maybeValue=r),o}class k{constructor(t,e=!1){this.c=t,this.escaped=e}toString(){return this.c}isEscaped(){return this.escaped}isPlacement(){return!this.escaped&&("0"===this.c||"#"===this.c||"?"===this.c)}isZeroPlacement(){return!this.escaped&&"0"===this.c}isHashPlacement(){return!this.escaped&&"#"===this.c}isQPlacement(){return!this.escaped&&"?"===this.c}isDigit(){return this.c>="1"&&this.c<="9"}isComma(){return!this.escaped&&","===this.c}isDecimal(){return!this.escaped&&"."===this.c}isPercent(){return!this.escaped&&"%"===this.c}getColorPlaceholderIndex(){const t=this.c.codePointAt(0),e=k.ColorPlaceholderStart.codePointAt(0),r=k.ColorPlaceholderEnd.codePointAt(0);return void 0!==t&&void 0!==e&&void 0!==r&&t>=e&&t<=r?t-e:-1}}k.ColorPlaceholderStart="",k.ColorPlaceholderEnd="";class B{constructor(){this.vec=[]}append(t){this.vec.push(t)}insert(t,e){this.vec.splice(t,0,e)}getVec(){return this.vec.slice()}length(){return this.vec.length}}class O{constructor(t,e,r){this.formatString=t,this.digits=e,this.placements=r}getDigits(){return this.digits}getPlacements(){return this.placements}}class q extends O{format(t,e,r){const o="-"===t.charAt(0),s=new x(t,o?1:0,t.length,t.length),i=this.formatString.getVec().reverse();let a="",n=this.getPlacements(),l=this.getDigits(),c=0;const h=e.length>0,u="-"!==e.charAt(0)?e:"0";for(;i.length>0&&(s.hasPrevious()||l)&&n;){const t=i.shift();if(void 0===t)break;const e=t.getColorPlaceholderIndex();if(e>=0){if(null==r||r.length<e)continue;a+=r[e]}else if(t.isPlacement()){if(h&&3===c)a+=u,c=0;else{let t;t=s.hasPrevious()?s.previous():"0",a+=t,c++,l&&l--}n--}else a+=t}for(;s.hasPrevious()||l;)h&&3===c?(a+=u,c=0):s.hasPrevious()?(a+=s.previous(),c++,l&&l--):(a+="0",c++,l--);for(o&&(a+="-");i.length>0;){const t=i.shift();if(void 0===t)break;const e=t.getColorPlaceholderIndex();if(e>=0){if(null==r||r.length<e)continue;a+=r[e]}else t.isHashPlacement()||(t.isQPlacement()?a+=" ":a+=t)}return a.split("").reverse().join("")}}q.NoThousandsSeparators="";class L{constructor(){this.placedDigits=0,this.placedLiteralDigits=0,this.placedEscapedCharacters=0}}class W extends O{format(t,e,r=null){if(!this.digits)return"";const o=this.formatString.getVec().slice(),s=new x(t,0,t.length);let i=this.digits,a=0,n=0,l=0,h="",u="";for(;i;){const t=o.shift();c(t.isPlacement());const e=s.hasNext()?s.next():"0";c(!isNaN(Number(e)),"Fraction part should only include digits"),t.isHashPlacement()&&"0"===e?u+=e:(h+=u,a+=u.length,u="",h+=e,a++),i--}for(this.placements>this.digits&&(h+=u,a+=u.length,u="");o.length>0;){const t=o.shift(),e=t.getColorPlaceholderIndex();if(e>=0){if(null===r||r.length<=e)continue;h+=r[e]}else t.isHashPlacement()||(t.isQPlacement()?h+=" ":(l+=t.isEscaped()?1:0,n+=t.isDigit()?1:0,h+=t.toString()))}return e.placedDigits=a,e.placedLiteralDigits=n,e.placedEscapedCharacters=l,h}}class H{constructor(){this.state="Null"}onCharacter(t){switch(this.state){case"Matched":break;case"Null":t.isPlacement()&&(this.state="HasPlacementChar");break;case"HasPlacementChar":t.isPlacement()?this.state="HasPlacementChar":t.isComma()?this.state="HasComma":this.state="Null";break;case"HasComma":t.isPlacement()?this.state="Matched":this.state="Null"}}isMatched(){return"Matched"===this.state}}class j{constructor(t=!1){this.counter=0,this.state=t?"ExpectingAnyPlacement":"WaitingForZero"}onCharacter(t){switch(this.state){case"Done":break;case"ExpectingAnyPlacement":t.isPlacement()?(this.state="CountingDigits",this.counter++):this.state="Done";break;case"WaitingForZero":t.isZeroPlacement()&&(this.state="CountingDigits",this.counter++);break;case"CountingDigits":t.isPlacement()?this.counter++:this.state="Done"}}count(){return this.counter}}class G{constructor(t=!1){this.scalingValue=0;const e=t?"Null":"CommasExpected";this.initialState=e,this.state=e}onCharacter(t){switch(this.state){case"Null":t.isPlacement()&&(this.state="CommasExpected");break;case"CommasExpected":t.isComma()?(this.state="CollectScaling",this.scalingValue++):t.isPlacement()||(this.state=this.initialState,this.scalingValue=0);break;case"CollectScaling":t.isComma()?this.scalingValue++:t.isPlacement()?(this.scalingValue--,this.state=this.scalingValue?"Done":"CommasExpected"):this.state="Done"}}scaling(){return this.scalingValue}}class _{constructor(){this.visualPart="",this.bareFormatWithPlaceholders="",this.colorPlaceholderValues=[],this.colors=new C}}class ${constructor(t){this.thousandsSeparator=t.thousandsSeparator||$.DefaultThousandSeparator,this.decimalSeparator=t.decimalSeparator||$.DefaultDecimalSeparator,this.nanString=t.nanString||$.DefaultNaNString,this.positiveInfinity=t.positiveInfinity||$.DefaultPositiveInfinity,this.negativeInfinity=t.negativeInfinity||$.DefaultNegativeInfinity}}$.DefaultThousandSeparator=",",$.DefaultDecimalSeparator=".",$.DefaultNaNString="NaN",$.DefaultPositiveInfinity="Infinity",$.DefaultNegativeInfinity="-Infinity";class Z extends N{constructor(t,e,r,o,s,i,a,n,l,c,h,u){super(),this.effectivelyEmpty=t,this.escapedFormat=e,this.visualPart=r,this.escapedFormatNoVisuals=o,this.wholePart=s,this.fractionPart=i,this.colorPlaceholderValues=a,this.colors=n,this.percent=l,this.scaling=c,this.thousandsSeparators=h,this.hasDecimal=u}static doubleToString(t,e){const r=Object.is(t,-0),o=t.toFixed(e);return r?"-"+o:o}static leftPad(t,e,r){return String(t).padStart(e,r)}static roundInternal(t,e){if(e>0){const r=Math.min(e+10,20),o=new RegExp("(-?\\d*)\\.(\\d{"+e+"})(\\d)\\d*$"),s=t.toFixed(r).match(o);if(null==s?void 0:s.length){const t="-"===s[1].charAt(0)?-1:1,r=Z.leftPad(Math.round(s[2]+"."+s[3]),e,"0");return r.length>e?Number(s[1])+t:Number(s[1]+"."+r)}}return t}static round(t,e){if(0===e){const e=t<0?-1:1;return Math.round(t*e)*e}return Z.roundInternal(t,e)}static numberHasValue(t){return null!=t}prepareValueToFormat(t){let e=t;this.percent&&(e*=100);for(let t=0;t<this.scaling;t++)e/=1e3;const r=Math.min(20,this.fractionPart.getDigits());e=Z.round(e,r);const o=Z.doubleToString(e,r);let s="",i="";if(""===o)return{valueToFormat:e,wholePart:s,fractionPart:i};if(this.fractionPart.getDigits()){const t=o.indexOf(".");c(-1!==t,"Decimal separator not found in the numberString."),s=o.substring(0,t),i=o.substring(t+1)}else s=o,i="";return 0===this.wholePart.getDigits()?"0"===s?s="":"-0"===s&&(s=this.hasDecimal?"-":""):this.hasDecimal||"-0"!==s||(s="0"),{valueToFormat:e,wholePart:s,fractionPart:i}}isLiteral(){return this.wholePart.getPlacements()+this.fractionPart.getPlacements()===0}doFormat(t,e,r){let o="";if(null===e);else if(!this.effectivelyEmpty&&this.isLiteral())o=t.options.includeColors?this.escapedFormat:this.escapedFormatNoVisuals;else{let r=e;t.formatAbsoluteValue&&Z.numberHasValue(e)&&(r=Math.abs(e));const s=this.prepareValueToFormat(r),i=this.thousandsSeparators?t.constants.thousandsSeparator:q.NoThousandsSeparators,a=t.options.includeColors?this.colorPlaceholderValues:void 0,n=this.wholePart.format(s.wholePart,i,a),l=new L,c=this.fractionPart.format(s.fractionPart,l,a);t.options.includeColors&&(o+=this.visualPart),o+=n,c.length&&((l.placedDigits>0||t.options.legacyCompatibility&&l.placedEscapedCharacters||t.options.legacyCompatibility&&l.placedLiteralDigits)&&(o+=t.constants.decimalSeparator),o+=c)}if(void 0!==r){r.colors.color=this.colors.color,r.colors.customColor=this.colors.customColor,r.colors.customBgColor=this.colors.customBgColor;const o=this.doResolve(new y(t.options,t.formatAbsoluteValue),e);r.effectiveFormat=null!==o?o:void 0}return o}doResolve(t,e){return null!==e||t.nestedFormatter?t.options.includeColors?this.escapedFormat:this.escapedFormatNoVisuals:""}static compile(t,e){const r=function(t,e){const r=t.getColorMatcher(),o=t.getCustomColorMatcher(),s=t.getCustomBgColorMatcher(),i=t.getAnyCustomColorMatcher(),a=new _;let n=e;if(a.colors=b(r,o,s,e),i.lastIndex=0,i.test(n)){const t=n.match(i);if(t){const e=n.search(i),r=e+t[0].length;a.visualPart=t[0],a.visualPart=a.visualPart.replace(/#/g,""),n=n.substring(0,e)+n.substring(r)}}a.bareFormatWithPlaceholders=n;const l=[r,o,s];for(const t of l)for(;t.lastIndex=0,t.test(a.bareFormatWithPlaceholders);){const e=k.ColorPlaceholderStart.codePointAt(0),r=k.ColorPlaceholderEnd.codePointAt(0);if(void 0===e||void 0===r)throw new Error("Unexpected format characters.");const o=e+a.colorPlaceholderValues.length;if(o>r)throw new Error("Too many visual tags. You can specify at most 256 tags.");const s=a.bareFormatWithPlaceholders.match(t);if(s){const e=a.bareFormatWithPlaceholders.search(t),r=e+s[0].length;let i=s[0];i=i.replace(/#/g,""),a.colorPlaceholderValues.push(i),a.bareFormatWithPlaceholders=a.bareFormatWithPlaceholders.substring(0,e)+String.fromCodePoint(o)+a.bareFormatWithPlaceholders.substring(r)}}return a}(t,e);let o="",s="",i=!1,a=!1,n=0;const l=[new B,new B],c=[0,0],h=[new j,new j(!0)],u=[0,0],m=[new H,new H],d=[new G,new G(!0)],g=[[],[]];let f=!1;for(let t=0;t<r.bareFormatWithPlaceholders.length;t++){const e=r.bareFormatWithPlaceholders[t];if(!f&&"\\"===e){f=!0;continue}if("\r"===e||"\n"===e)continue;const p=new k(e,f),C=p.getColorPlaceholderIndex();f=!1,C>=0?(o+=r.colorPlaceholderValues[C],0===n&&(r.colorPlaceholderValues[C]=r.colorPlaceholderValues[C].split("").reverse().join(""))):(o+=e,s+=e),p.isDecimal()?(0===n&&n++,a=!0):(p.isPercent()&&(i=!0),p.isComma()?g[n].push(l[n].length()):(l[n].append(p),c[n]++),m[n].onCharacter(p),d[n].onCharacter(p),p.isPlacement()&&u[n]++,p.isComma()&&(1!==n||c[1])||h[n].onCharacter(p))}f&&(l[n].append(new k("\\")),o+="\\",s+="\\");const p=r.visualPart+o,C=m[0].isMatched()||m[1].isMatched(),v=d[0].scaling()+d[1].scaling();for(let t=0;t<2;t++)if(!C&&0===d[t].scaling())for(let e=g[t].length-1;e>=0;--e)l[t].insert(g[t][e],new k(","));const P=new q(l[0],h[0].count(),u[0]),x=new W(l[1],h[1].count(),u[1]);return new Z(0===o.length,p,r.visualPart,s,P,x,r.colorPlaceholderValues,r.colors,i,v,C,a)}}class Q{constructor(t){this.matchers=t}splitAlternatives(t){let e="",r=!1;const o=[],s=new x(t,0,t.length);for(;s.hasNext();){const t=s.next();"\\"!==t?";"!==t||r?(e+=t,r=!1):(o.push(e),e=""):(r=!0,e+=t)}return o.push(e),o}truncatedStringLiteral(t){const e=t.search("\0");return e>=0?t.substring(0,e):t}compileFormatter(t){let e,r=this.truncatedStringLiteral(t);r=r.replace(new RegExp(this.matchers.getExcelFormatSuffixMatcher(),"gi"),"");try{if(this.matchers.getArithmeticMatcher().test(r))e=I.compile(this.matchers,this,r);else{const t=this.splitAlternatives(r);e=1!==t.length||this.matchers.getConditionMatcher().test(r)?M.compile(this.matchers,this,t):Z.compile(this.matchers,r)}}catch(t){if(!(t=>t instanceof P)(t))throw console.error(t),t;e=Z.compile(this.matchers,g)}return new U(e)}}class U extends N{constructor(t){super(),this.decorated=t}doFormat(t,e,r){return null===e?this.decorated.doFormat(t,e,r):Number.isNaN(e)?t.constants.nanString:Number.isFinite(e)?this.decorated.doFormat(t,e,r):e<0?t.constants.negativeInfinity:t.constants.positiveInfinity}doResolve(t,e){return Number.isNaN(e)?"":this.decorated.doResolve(t,e)}}class Y{constructor(){this.matchers=new E,this.factory=new Q(this.matchers)}compileFormatter(t){return this.factory.compileFormatter(t)}}class z{static convertValue(t){return null===t?null:void 0===t?NaN:"number"==typeof t?t:parseFloat(t)}static formatValue(t,e=g,r){const o=new Y,s=new f;s.decimalSeparator=null==r?void 0:r.decimal,s.thousandsSeparator=null==r?void 0:r.thousand,s.includeColors=!1;const i=new v;try{let r=z.cache.get(e);r||(r=o.compileFormatter(e),z.cache.set(e,r));const a=r.format(t,s,i);return{colors:new p(i.colors),formattedValue:a,nullConditionFormatter:i.nullConditionFormatter,effectiveFormat:i.effectiveFormat,resolvedFormat:r.resolve(t,s)}}catch(r){i.reset();let a=z.cache.get(g);a||(a=o.compileFormatter(e),z.cache.set(g,a));const n=a.format(t,s,i);return{colors:new p(i.colors),formattedValue:n,nullConditionFormatter:i.nullConditionFormatter,effectiveFormat:i.effectiveFormat,resolvedFormat:a.resolve(t,s)}}}}z.cache=new o.z({max:200})}}]);